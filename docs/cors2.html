<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.13">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Knowledge &amp; Motivation Correlations-2 â€“ CCL Survey Study</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./org.html" rel="next">
<link href="./cors1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-66ab7fd5e73b7f0a764e0d49b3e29ab1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8ebe664a20a329468a5069a44ff81306.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<!-- academic icons --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
<!-- fontawesome icons --><script src="https://kit.fontawesome.com/1392a7030f.js" crossorigin="anonymous"></script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">CCL Survey Study</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="./org.html" aria-current="page"> 
<span class="menu-text">Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./cors.html"> 
<span class="menu-text">Correlations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./inspect.html"> 
<span class="menu-text">items</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/tegorman13/Survey_Study"> <i class="bi bi-github" role="img" aria-label="github">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./inst.html"><strong>Analyses</strong></a></li><li class="breadcrumb-item"><a href="./cors2.html">Knowledge &amp; Motivation Correlations-2</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Analyses</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inst.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">Survey Items</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cors.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cors1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instrument Correlations_1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cors2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Knowledge &amp; Motivation Correlations-2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./org.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">Organization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inspect.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">Inspect</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Background</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/1_JP_summaries_know_mot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Knowledge and motivation - searched by JP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/barber_annotated_bib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Energy Conservation Behavior</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/EnergySurveyInstruments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EnergySurveyInstruments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/nca_draft.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/nsf_instrument_codebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nsf Instrument Codebook</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/overview_files_instruments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instrument study</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/survey_codebook_outline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Survey Codebook Outline</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="cor_hugo2.md"><i class="bi bi-file-code"></i>CommonMark (hugo)</a></li></ul></div></div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./inst.html"><strong>Analyses</strong></a></li><li class="breadcrumb-item"><a href="./cors2.html">Knowledge &amp; Motivation Correlations-2</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Knowledge &amp; Motivation Correlations-2</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header><p>This study set out to assess how prior survey instruments on sustainable behaviors, knowledge, and attitudes correlate.Many studies on environmental behavior measure peopleâ€™s motivation to show sustainable behavior and classify them as being highly or lowly motivated, and their knowledge about what the right behavior would look like. An example would be recycling.</p>
<section id="read-data" class="level1"><h1>Read data</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">dplyr</span>,<span class="va">purrr</span>,<span class="va">tidyr</span>,<span class="va">here</span>, <span class="va">haven</span>,<span class="va">tibble</span>,<span class="va">ggplot2</span>,<span class="va">ggh4x</span>,<span class="va">lme4</span>,<span class="va">knitr</span>,<span class="va">kableExtra</span>,<span class="va">gt</span>,<span class="va">pander</span>,<span class="va">flextable</span>,<span class="va">ggh4x</span>,<span class="va">psych</span>,<span class="va">corrplot</span>,<span class="va">factoextra</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">2</span>, scipen<span class="op">=</span><span class="fl">999</span>, dplyr.summarise.inform<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CCA</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">qgraph</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bethatkinson/rpart">rpart</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.milbo.org/rpart-plot/index.html">rpart.plot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mclust-org.github.io/mclust/">mclust</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://data-edu.github.io/tidyLPA/">tidyLPA</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">select</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"scripts"</span>,<span class="st">"survey_functions.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">draw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"draw.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#dinst &lt;- readRDS(here("data","dinst.rds"))</span></span>
<span></span>
<span><span class="co"># Attari Energy Survey (Part 1)</span></span>
<span><span class="va">aes1</span> <span class="op">&lt;-</span> <span class="va">draw</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">ATT01</span><span class="op">:</span><span class="va">ATT18</span><span class="op">)</span></span>
<span><span class="co">#aes2 &lt;- dinst |&gt; select(id,ATT01:ATT18)</span></span>
<span><span class="va">aes_combined</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">aes1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">att_useSave</span> <span class="op">&lt;-</span> <span class="va">draw</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">ATT19</span><span class="op">:</span><span class="va">ATT33</span><span class="op">)</span></span>
<span><span class="co">#att_useSave2 &lt;- dinst |&gt; select(id,ATT19:ATT33)</span></span>
<span><span class="va">att2_combined</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">att_useSave</span><span class="op">)</span></span>
<span></span>
<span><span class="va">els1</span> <span class="op">&lt;-</span> <span class="va">draw</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">ELS01</span><span class="op">:</span><span class="va">ELS08</span><span class="op">)</span></span>
<span><span class="co">#els2 &lt;- dinst |&gt; select(id,ELS01:ELS08)</span></span>
<span><span class="va">els</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">els1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rs1</span> <span class="op">&lt;-</span> <span class="va">draw</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">RS01</span><span class="op">:</span><span class="va">RS06</span><span class="op">)</span></span>
<span><span class="co">#rs2 &lt;- dinst |&gt; select(id,RS01:RS06)</span></span>
<span><span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">rs1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">attari1</span> <span class="op">&lt;-</span> <span class="fu">analyze_attari_survey_part1</span><span class="op">(</span><span class="va">aes_combined</span><span class="op">)</span></span>
<span><span class="va">attari2_scores</span> <span class="op">&lt;-</span> <span class="fu">analyze_attari_survey</span><span class="op">(</span><span class="va">att2_combined</span><span class="op">)</span></span>
<span><span class="va">els_scores</span> <span class="op">&lt;-</span> <span class="fu">analyze_els_survey</span><span class="op">(</span><span class="va">els</span><span class="op">)</span></span>
<span><span class="va">rs_scores</span> <span class="op">&lt;-</span> <span class="fu">analyze_recycling_survey</span><span class="op">(</span><span class="va">rs</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine all scores into one dataframe</span></span>
<span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">attari1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">attari2_scores</span>, by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">els_scores</span>, by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">rs_scores</span>, by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rename columns for clarity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"perceived_difficulty"</span>, <span class="st">"numeracy"</span>, </span>
<span>                          <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, </span>
<span>                          <span class="st">"els_accuracy"</span>, <span class="st">"els_score"</span>,</span>
<span>                          <span class="st">"env_attitude"</span>, <span class="st">"env_attitude_z"</span>,</span>
<span>                          <span class="st">"pol_conservatism"</span>, <span class="st">"pol_conservatism_z"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="preview-data" class="level1"><h1>preview data</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">combined_scores</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable_styling</span><span class="op">(</span><span class="st">"striped"</span>, full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">perceived_difficulty</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">numeracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">energy_use</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">energy_save</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">els_accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">els_score</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">env_attitude</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">env_attitude_z</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pol_conservatism</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pol_conservatism_z</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.7601</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">-0.45</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">-0.42</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">-0.48</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.0015</td>
<td style="text-align: right;">-0.43</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">-1.12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">-1.87</td>
<td style="text-align: right;">-1.2393</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-0.25</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">-0.77</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">0.27</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">-0.70</td>
<td style="text-align: right;">-1.26</td>
<td style="text-align: right;">0.9531</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1.29</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">-1.12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">-0.0468</td>
<td style="text-align: right;">-0.48</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-0.77</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">0.62</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="a" class="level1"><h1>1a</h1>
<p>::: {.cell}</p>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1. Cluster Analysis</span></span>
<span></span>
<span><span class="co"># Prepare data for clustering (select relevant variables and scale)</span></span>
<span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="fu">select</span><span class="op">(</span><span class="va">perceived_difficulty</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>, <span class="va">env_attitude_z</span>, <span class="va">pol_conservatism_z</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Determine optimal number of clusters using the elbow method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_data</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"wss"</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Elbow Method for Optimal k"</span>, x <span class="op">=</span> <span class="st">"Number of Clusters k"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><p>::: {.cell-output-display} <img src="cors2_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"> ::: :::</p>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform k-means clustering (e.g., with 3 clusters)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">km_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_result</span>, data <span class="op">=</span> <span class="va">cluster_data</span>,</span>
<span>             geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>             ellipse.type <span class="op">=</span> <span class="st">"convex"</span>,</span>
<span>             ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means Clustering of Subjects"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Add cluster assignments to the main dataframe</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">km_result</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Enhanced Factor Analysis</span></span>
<span></span>
<span><span class="co"># Scree plot to determine the number of factors</span></span>
<span><span class="va">fa_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">perceived_difficulty</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>, <span class="va">env_attitude_z</span>, <span class="va">pol_conservatism_z</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">scree</span><span class="op">(</span><span class="va">fa_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform factor analysis with, e.g., 3 factors</span></span>
<span><span class="va">fa_result</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="va">fa_data</span>, nfactors <span class="op">=</span> <span class="fl">2</span>, rotate <span class="op">=</span> <span class="st">"varimax"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fa_result</span>, cut <span class="op">=</span> <span class="fl">0.3</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = fa_data, nfactors = 2, rotate = "varimax")
Standardized loadings (pattern matrix) based upon correlation matrix
                     item   MR1   MR2   h2    u2 com
energy_use              3  0.84       0.76 0.244 1.1
energy_save             4  0.73       0.59 0.414 1.2
els_score               5  0.56       0.37 0.634 1.3
numeracy                2  0.55       0.33 0.671 1.2
env_attitude_z          6        0.99 1.00 0.004 1.0
perceived_difficulty    1 -0.31 -0.41 0.27 0.733 1.9
pol_conservatism_z      7 -0.33 -0.37 0.25 0.752 2.0

                       MR1  MR2
SS loadings           2.08 1.47
Proportion Var        0.30 0.21
Cumulative Var        0.30 0.51
Proportion Explained  0.59 0.41
Cumulative Proportion 0.59 1.00

Mean item complexity =  1.4
Test of the hypothesis that 2 factors are sufficient.

df null model =  21  with the objective function =  2 with Chi Square =  581
df of  the model are 8  and the objective function was  0.06 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.05 

The harmonic n.obs is  287 with the empirical chi square  11  with prob &lt;  0.21 
The total n.obs was  287  with Likelihood Chi Square =  16  with prob &lt;  0.039 

Tucker Lewis Index of factoring reliability =  0.96
RMSEA index =  0.06  and the 90 % confidence intervals are  0.013 0.1
BIC =  -29
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   MR1  MR2
Correlation of (regression) scores with factors   0.91 1.00
Multiple R square of scores with factors          0.83 0.99
Minimum correlation of possible factor scores     0.66 0.99</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Enhanced Regression Models</span></span>
<span><span class="co"># Model predicting ELS from motivation, controlling for other knowledge scores</span></span>
<span><span class="va">model_els_enhanced</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els_score</span> <span class="op">~</span> <span class="va">perceived_difficulty</span> <span class="op">+</span> <span class="va">env_attitude_z</span> <span class="op">+</span> <span class="va">pol_conservatism_z</span> <span class="op">+</span></span>
<span>                           <span class="va">numeracy</span> <span class="op">+</span> <span class="va">energy_use</span> <span class="op">+</span> <span class="va">energy_save</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_els_enhanced</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els_score ~ perceived_difficulty + env_attitude_z + 
    pol_conservatism_z + numeracy + energy_use + energy_save, 
    data = combined_scores)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.6980 -0.5503  0.0032  0.5721  1.8213 

Coefficients:
                                   Estimate             Std. Error t value
(Intercept)          -0.0000000000000000688  0.0489269055507626435    0.00
perceived_difficulty -0.0337244503822692054  0.0570460415578972341   -0.59
env_attitude_z        0.1261028743723029699  0.0590615887219709187    2.14
pol_conservatism_z    0.0051715350800468698  0.0562734579223263670    0.09
numeracy              0.2159823248735648904  0.0566852070307704362    3.81
energy_use            0.3194051454769996634  0.0731342822426433031    4.37
energy_save           0.0588285984463395514  0.0703556985523190459    0.84
                     Pr(&gt;|t|)    
(Intercept)           1.00000    
perceived_difficulty  0.55488    
env_attitude_z        0.03362 *  
pol_conservatism_z    0.92684    
numeracy              0.00017 ***
energy_use           0.000018 ***
energy_save           0.40378    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.83 on 280 degrees of freedom
Multiple R-squared:  0.327, Adjusted R-squared:  0.313 
F-statistic: 22.7 on 6 and 280 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 4. Interaction Effects in Regression</span></span>
<span><span class="co"># Example: Interaction between environmental attitude and perceived difficulty on ELS</span></span>
<span><span class="va">model_interaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els_score</span> <span class="op">~</span> <span class="va">perceived_difficulty</span> <span class="op">*</span> <span class="va">env_attitude_z</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_interaction</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els_score ~ perceived_difficulty * env_attitude_z, 
    data = combined_scores)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.4443 -0.6460  0.0125  0.6944  2.1713 

Coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                          -0.0457     0.0613   -0.75  0.45624    
perceived_difficulty                 -0.1680     0.0624   -2.69  0.00749 ** 
env_attitude_z                        0.2286     0.0626    3.65  0.00031 ***
perceived_difficulty:env_attitude_z  -0.1017     0.0581   -1.75  0.08091 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.94 on 283 degrees of freedom
Multiple R-squared:  0.128, Adjusted R-squared:  0.119 
F-statistic: 13.8 on 3 and 283 DF,  p-value: 0.0000000196</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize the interaction (example)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">combined_scores</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perceived_difficulty</span>, y <span class="op">=</span> <span class="va">els_score</span>, color <span class="op">=</span> <span class="va">env_attitude_z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_color_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Interaction of Perceived Difficulty and Environmental Attitude on ELS"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Perceived Difficulty"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Energy Literacy Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="a-1" class="level1"><h1>2a</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">combined_df</span> <span class="op">&lt;-</span> <span class="va">attari1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">attari2_scores</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">els_scores</span>,       by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">rs_scores</span>,        by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># 1. Create knowledge profiles using cluster analysis</span></span>
<span><span class="va">knowledge_vars</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>, </span>
<span>         <span class="va">relative_energy_save_score</span>, <span class="va">els</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">knowledge_vars</span><span class="op">)</span>, centers<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add cluster membership to data</span></span>
<span><span class="va">combined_df</span><span class="op">$</span><span class="va">knowledge_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare motivation scores across clusters</span></span>
<span><span class="va">cluster_comparison</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">knowledge_cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean_env_attitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">env_attitude</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_difficulty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Test for non-linear relationships</span></span>
<span><span class="va">gam_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span><span class="va">els</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">env_attitude</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">perceived_difficulty_score</span><span class="op">)</span>, </span>
<span>                 data<span class="op">=</span><span class="va">combined_df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Create interaction model between knowledge and motivation</span></span>
<span><span class="va">interaction_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els</span> <span class="op">~</span> <span class="va">env_attitude</span> <span class="op">*</span> <span class="va">perceived_difficulty_score</span> <span class="op">+</span> </span>
<span>                         <span class="va">numeracy_score</span>, data<span class="op">=</span><span class="va">combined_df</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># 1. Enhanced Correlation Plot</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>, </span>
<span>         <span class="va">relative_energy_save_score</span>, <span class="va">els</span>, </span>
<span>         <span class="va">perceived_difficulty_score</span>, <span class="va">env_attitude</span>, </span>
<span>         <span class="va">pol_conservatism_z</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">corrplot</span><span class="op">(</span><span class="va">cor_matrix</span>, </span>
<span>         method <span class="op">=</span> <span class="st">"color"</span>,</span>
<span>         type <span class="op">=</span> <span class="st">"upper"</span>,</span>
<span>         addCoef.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>         tl.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>         tl.srt <span class="op">=</span> <span class="fl">45</span>,</span>
<span>         diag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>         col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Knowledge Profile Clustering</span></span>
<span><span class="co"># Standardize knowledge variables</span></span>
<span><span class="va">knowledge_vars</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>, </span>
<span>         <span class="va">relative_energy_save_score</span>, <span class="va">els</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Determine optimal number of clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">wss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">knowledge_vars</span>, centers<span class="op">=</span><span class="va">k</span><span class="op">)</span><span class="op">$</span><span class="va">tot.withinss</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform k-means clustering</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">3</span>  <span class="co"># Based on elbow plot inspection</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">knowledge_vars</span>, centers<span class="op">=</span><span class="va">k</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add cluster membership to data</span></span>
<span><span class="va">combined_df</span><span class="op">$</span><span class="va">knowledge_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize clusters</span></span>
<span><span class="va">pca_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">knowledge_vars</span><span class="op">)</span></span>
<span><span class="va">cluster_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  PC1 <span class="op">=</span> <span class="va">pca_result</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>  PC2 <span class="op">=</span> <span class="va">pca_result</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>  Cluster <span class="op">=</span> <span class="va">combined_df</span><span class="op">$</span><span class="va">knowledge_cluster</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create cluster visualization</span></span>
<span><span class="va">p_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">cluster_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PC1</span>, y<span class="op">=</span><span class="va">PC2</span>, color<span class="op">=</span><span class="va">Cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Knowledge Profiles Clustering"</span>,</span>
<span>       x<span class="op">=</span><span class="st">"First Principal Component"</span>,</span>
<span>       y<span class="op">=</span><span class="st">"Second Principal Component"</span><span class="op">)</span></span>
<span><span class="va">p_clusters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Non-linear GAM Analysis</span></span>
<span><span class="va">gam_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span><span class="va">els</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">env_attitude</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">perceived_difficulty_score</span><span class="op">)</span>, </span>
<span>                 data<span class="op">=</span><span class="va">combined_df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create prediction grid for GAM visualization</span></span>
<span><span class="va">env_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">env_attitude</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">env_attitude</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">diff_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict ELS scores</span></span>
<span><span class="va">pred_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">gam_model</span>, </span>
<span>                   newdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>env_attitude<span class="op">=</span><span class="va">env_grid</span>,</span>
<span>                                    perceived_difficulty_score<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pred_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">gam_model</span>,</span>
<span>                    newdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>perceived_difficulty_score<span class="op">=</span><span class="va">diff_grid</span>,</span>
<span>                                     env_attitude<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">env_attitude</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create GAM plots</span></span>
<span><span class="va">p_gam_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">env_grid</span>, y<span class="op">=</span><span class="va">pred_env</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">combined_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">env_attitude</span>, y<span class="op">=</span><span class="va">els</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Non-linear Relationship: Environmental Attitude and Energy Literacy"</span>,</span>
<span>       x<span class="op">=</span><span class="st">"Environmental Attitude"</span>,</span>
<span>       y<span class="op">=</span><span class="st">"Energy Literacy Score"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_gam_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">diff_grid</span>, y<span class="op">=</span><span class="va">pred_diff</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">combined_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">perceived_difficulty_score</span>, y<span class="op">=</span><span class="va">els</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Non-linear Relationship: Perceived Difficulty and Energy Literacy"</span>,</span>
<span>       x<span class="op">=</span><span class="st">"Perceived Difficulty Score"</span>,</span>
<span>       y<span class="op">=</span><span class="st">"Energy Literacy Score"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#p_gam_diff</span></span>
<span></span>
<span></span>
<span><span class="co"># 4. Knowledge-Motivation Interaction Analysis</span></span>
<span><span class="va">interaction_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els</span> <span class="op">~</span> <span class="va">env_attitude</span> <span class="op">*</span> <span class="va">perceived_difficulty_score</span> <span class="op">+</span> </span>
<span>                         <span class="va">numeracy_score</span>, data<span class="op">=</span><span class="va">combined_df</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">interaction_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els ~ env_attitude * perceived_difficulty_score + 
    numeracy_score, data = combined_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.5406 -0.5246  0.0126  0.6594  2.0447 

Coefficients:
                                        Estimate Std. Error t value
(Intercept)                              -0.8353     0.2813   -2.97
env_attitude                              0.2227     0.0774    2.88
perceived_difficulty_score                0.2508     0.2572    0.98
numeracy_score                            0.3541     0.0535    6.62
env_attitude:perceived_difficulty_score  -0.1047     0.0711   -1.47
                                             Pr(&gt;|t|)    
(Intercept)                                    0.0032 ** 
env_attitude                                   0.0043 ** 
perceived_difficulty_score                     0.3303    
numeracy_score                          0.00000000019 ***
env_attitude:perceived_difficulty_score        0.1421    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.88 on 282 degrees of freedom
Multiple R-squared:  0.245, Adjusted R-squared:  0.234 
F-statistic: 22.9 on 4 and 282 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create interaction plot data</span></span>
<span><span class="va">env_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">env_attitude</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">diff_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Arrange all plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p_clusters</span>, <span class="va">p_gam_env</span>, <span class="va">p_gam_diff</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Print statistical summaries</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">gam_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
els ~ s(env_attitude) + s(perceived_difficulty_score)

Parametric coefficients:
                         Estimate            Std. Error t value Pr(&gt;|t|)
(Intercept) -0.000000000000000183  0.054877905715381682       0        1

Approximate significance of smooth terms:
                               edf Ref.df    F p-value    
s(env_attitude)               2.87   3.61 5.74 0.00034 ***
s(perceived_difficulty_score) 1.92   2.43 3.62 0.02485 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.136   Deviance explained =   15%
GCV = 0.8821  Scale est. = 0.86432   n = 287</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">interaction_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els ~ env_attitude * perceived_difficulty_score + 
    numeracy_score, data = combined_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.5406 -0.5246  0.0126  0.6594  2.0447 

Coefficients:
                                        Estimate Std. Error t value
(Intercept)                              -0.8353     0.2813   -2.97
env_attitude                              0.2227     0.0774    2.88
perceived_difficulty_score                0.2508     0.2572    0.98
numeracy_score                            0.3541     0.0535    6.62
env_attitude:perceived_difficulty_score  -0.1047     0.0711   -1.47
                                             Pr(&gt;|t|)    
(Intercept)                                    0.0032 ** 
env_attitude                                   0.0043 ** 
perceived_difficulty_score                     0.3303    
numeracy_score                          0.00000000019 ***
env_attitude:perceived_difficulty_score        0.1421    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.88 on 282 degrees of freedom
Multiple R-squared:  0.245, Adjusted R-squared:  0.234 
F-statistic: 22.9 on 4 and 282 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Cluster profile analysis</span></span>
<span><span class="va">cluster_profiles</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">knowledge_cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean_numeracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">numeracy_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_energy_use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">relative_energy_use_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_energy_save <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">relative_energy_save_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_els <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">els</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_env_attitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">env_attitude</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_difficulty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cluster_profiles</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 8
  knowledge_cluster mean_numeracy mean_energy_use mean_energy_save mean_els
  &lt;fct&gt;                     &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;    &lt;dbl&gt;
1 1                        -1.41           -1.18            -1.14    -1.03 
2 2                         0.609           0.840            0.782    0.801
3 3                         0.106          -0.240           -0.199   -0.276
# â„¹ 3 more variables: mean_env_attitude &lt;dbl&gt;, mean_difficulty &lt;dbl&gt;, n &lt;int&gt;</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</section><section id="a-2" class="level1"><h1>3a</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example: K-means clustering on knowledge + motivation</span></span>
<span><span class="co"># Subset your knowledge &amp; motivation columns</span></span>
<span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>, <span class="va">relative_energy_save_score</span>,</span>
<span>         <span class="va">els</span>, <span class="va">perceived_difficulty_score</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Scale them</span></span>
<span><span class="va">cluster_data_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">cluster_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Decide on number of clusters (e.g. 2â€“5) â€“ use e.g. Elbow method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"wss"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Suppose we choose 3 clusters as a demonstration</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">km_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add cluster membership back into the original data</span></span>
<span><span class="va">cluster_data</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">km_result</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize clusters in 2D (using PCA behind the scenes)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_result</span>, data <span class="op">=</span> <span class="va">cluster_data_scaled</span>,</span>
<span>             geom <span class="op">=</span> <span class="st">"point"</span>, ellipse.type <span class="op">=</span> <span class="st">"convex"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means Clusters of Knowledge &amp; Motivation Variables"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1. Grab relevant variables</span></span>
<span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>, <span class="va">relative_energy_save_score</span>,</span>
<span>         <span class="va">els</span>, <span class="va">perceived_difficulty_score</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Standardize/scale them</span></span>
<span><span class="va">cluster_data_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">cluster_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Determine the optimal number of clusters (Elbow or Silhouette methods)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"wss"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 4. Run k-means with your chosen number of clusters (say k = 3)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">km_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5. Visualize</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_res</span>, data <span class="op">=</span> <span class="va">cluster_data_scaled</span>,</span>
<span>             geom <span class="op">=</span> <span class="st">"point"</span>, ellipse.type <span class="op">=</span> <span class="st">"convex"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means Clusters of Knowledge &amp; Motivation Variables"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 6. Inspect cluster means</span></span>
<span><span class="va">cluster_centers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">km_res</span><span class="op">$</span><span class="va">centers</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cluster_centers</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cluster_data</span><span class="op">)</span></span>
<span><span class="va">cluster_centers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  numeracy_score relative_energy_use_score relative_energy_save_score   els
1           0.28                     0.056                      0.074  0.19
2          -1.14                    -1.026                     -1.085 -0.98
3           0.46                     0.559                      0.581  0.44
  perceived_difficulty_score env_attitude pol_conservatism
1                     -0.074        -0.39             0.74
2                      0.825        -0.68             0.60
3                     -0.430         0.68            -0.88</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example of hierarchical clustering if that is preferred</span></span>
<span><span class="va">dist_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span>
<span><span class="va">hc_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">dist_mat</span>, method <span class="op">=</span> <span class="st">"ward.D2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">hc_res</span>, main <span class="op">=</span> <span class="st">"Dendrogram of Hierarchical Clustering"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Cut tree at chosen k</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">hc_res</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>clusters
  1   2   3 
109 120  58 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example mediation: knowledge -&gt; perceived_difficulty -&gt; env_attitude</span></span>
<span><span class="va">model_mediation</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  # direct effect</span></span>
<span><span class="st">  env_attitude ~ c*els</span></span>
<span><span class="st">  # mediator</span></span>
<span><span class="st">  perceived_difficulty_score ~ a*els</span></span>
<span><span class="st">  env_attitude ~ b*perceived_difficulty_score</span></span>
<span><span class="st">  # indirect effect</span></span>
<span><span class="st">  ab := a*b</span></span>
<span><span class="st">  # total effect</span></span>
<span><span class="st">  total := c + (a*b)</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="va">fit_mediation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model_mediation</span>, data <span class="op">=</span> <span class="va">combined_df</span>, missing<span class="op">=</span><span class="st">"fiml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_mediation</span>, fit.measures<span class="op">=</span><span class="cn">TRUE</span>, standardized<span class="op">=</span><span class="cn">TRUE</span>, rsquare<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         7

  Number of observations                           287
  Number of missing patterns                         1

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Model Test Baseline Model:

  Test statistic                               101.384
  Degrees of freedom                                 3
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000
  Tucker-Lewis Index (TLI)                       1.000
                                                      
  Robust Comparative Fit Index (CFI)             1.000
  Robust Tucker-Lewis Index (TLI)                1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -684.945
  Loglikelihood unrestricted model (H1)       -684.945
                                                      
  Akaike (AIC)                                1383.891
  Bayesian (BIC)                              1409.507
  Sample-size adjusted Bayesian (SABIC)       1387.309

Root Mean Square Error of Approximation:

  RMSEA                                          0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.000
  P-value H_0: RMSEA &lt;= 0.050                       NA
  P-value H_0: RMSEA &gt;= 0.080                       NA
                                                      
  Robust RMSEA                                   0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.000
  P-value H_0: Robust RMSEA &lt;= 0.050                NA
  P-value H_0: Robust RMSEA &gt;= 0.080                NA

Standardized Root Mean Square Residual:

  SRMR                                           0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Regressions:
                               Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
  env_attitude ~                                                           
    els        (c)                0.158    0.041    3.880    0.000    0.158
  perceived_difficulty_score ~                                             
    els        (a)               -0.268    0.057   -4.721    0.000   -0.268
  env_attitude ~                                                           
    prcvd_dff_ (b)               -0.302    0.041   -7.417    0.000   -0.302
  Std.all
         
    0.207
         
   -0.268
         
   -0.395

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .env_attitude      3.591    0.039   91.857    0.000    3.591    4.717
   .prcvd_dffclty_    0.000    0.057    0.000    1.000    0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .env_attitude      0.439    0.037   11.979    0.000    0.439    0.757
   .prcvd_dffclty_    0.925    0.077   11.979    0.000    0.925    0.928

R-Square:
                   Estimate
    env_attitude      0.243
    prcvd_dffclty_    0.072

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    ab                0.081    0.020    3.982    0.000    0.081    0.106
    total             0.239    0.043    5.583    0.000    0.239    0.313</code></pre>
</div>
</div>
<hr>
<div style="page-break-after: always;"></div>
</section><section id="a-3" class="level1"><h1>4a</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="co"># Example composite for knowledge: average of (z-scored) numeracy, </span></span>
<span>    <span class="co"># energy_use, energy_save, ELS. </span></span>
<span>    <span class="co"># (You can also sum them, but average is convenient.)</span></span>
<span>    composite_knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>, </span>
<span>            <span class="va">relative_energy_save_score</span>, <span class="va">els</span><span class="op">)</span>,</span>
<span>      na.rm <span class="op">=</span> <span class="cn">FALSE</span>  <span class="co"># If a row has missing for any item, result = NA</span></span>
<span>    <span class="op">)</span>,</span>
<span>    </span>
<span>    <span class="co"># Example composite for motivation: </span></span>
<span>    <span class="co"># env_attitude might be already in a favorable direction, but if </span></span>
<span>    <span class="co"># perceived_difficulty is "difficulty," consider reversing so that </span></span>
<span>    <span class="co"># higher = "less difficulty" = "higher motivation."</span></span>
<span>    <span class="co"># For example: reverse_diff = (-1)*perceived_difficulty_score</span></span>
<span>    <span class="co"># Then average with env_attitude (if you want them combined).</span></span>
<span>    <span class="co"># If you are including pol_conservatism as well, you must decide </span></span>
<span>    <span class="co"># how to handle that in the composite. Possibly reverse-coded </span></span>
<span>    <span class="co"># so that higher # = more liberal or more "pro-environment" stance. </span></span>
<span>    <span class="co"># (It's your theoretical call.)</span></span>
<span>    </span>
<span>    <span class="co"># For now, let's do a small composite with environmental attitude </span></span>
<span>    <span class="co"># and reversed difficulty:</span></span>
<span>    reverse_diff <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">perceived_difficulty_score</span>,</span>
<span>    </span>
<span>    composite_motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">env_attitude</span>, <span class="va">reverse_diff</span><span class="op">)</span>, </span>
<span>      na.rm <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># We'll create a small data frame with just the two composites, </span></span>
<span><span class="co"># removing any incomplete cases</span></span>
<span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">composite_knowledge</span>, <span class="va">composite_motivation</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Decide on number of clusters "k". Letâ€™s try k = 3:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> </span>
<span><span class="va">km3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect results</span></span>
<span><span class="va">km3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 3 clusters of sizes 87, 124, 76

Cluster means:
  composite_knowledge composite_motivation
1                0.35                  1.4
2                0.39                  2.5
3               -1.03                  1.1

Clustering vector:
  [1] 1 2 3 2 1 2 2 3 2 2 2 2 3 2 3 1 3 3 3 2 2 1 3 2 2 2 1 2 3 3 2 1 1 2 1 1 1
 [38] 3 2 1 3 2 1 3 1 2 2 3 3 1 1 1 2 1 2 1 2 2 3 2 1 2 3 1 2 1 3 2 3 2 2 3 2 1
 [75] 1 2 3 2 3 2 2 2 2 1 1 2 3 1 2 3 1 2 2 2 1 2 3 2 2 2 2 2 2 1 1 1 2 2 2 2 1
[112] 2 1 2 2 3 2 1 1 2 1 3 2 2 1 1 2 2 2 1 2 2 2 2 3 3 2 2 2 1 2 3 2 1 2 2 1 1
[149] 1 2 2 1 1 3 2 2 3 1 1 1 1 2 2 1 2 3 2 2 1 1 2 1 1 3 1 2 3 2 1 1 2 2 2 1 1
[186] 3 1 2 2 2 2 1 3 1 1 1 2 1 2 2 2 1 2 3 3 3 2 2 2 1 1 1 2 3 2 3 2 1 2 2 1 1
[223] 2 3 2 3 1 1 2 2 3 3 1 1 2 1 3 2 3 3 3 1 1 3 1 3 2 3 2 3 2 3 3 1 1 1 3 3 3
[260] 2 3 2 3 2 2 3 3 3 2 3 1 1 3 3 2 2 3 1 3 3 3 3 3 3 3 2 3

Within cluster sum of squares by cluster:
[1] 32 55 36
 (between_SS / total_SS =  63.7 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km3</span>, data <span class="op">=</span> <span class="va">cluster_data</span>,</span>
<span>             geom <span class="op">=</span> <span class="st">"point"</span>, ellipse.type <span class="op">=</span> <span class="st">"convex"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means (k=3) Clustering on Knowledge vs. Motivation"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">combined_scores</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">km3</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare mean knowledge &amp; motivation by cluster</span></span>
<span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    mean_knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">composite_knowledge</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">composite_motivation</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 4
  cluster     n mean_knowledge mean_motivation
  &lt;fct&gt;   &lt;int&gt;          &lt;dbl&gt;           &lt;dbl&gt;
1 1          87          0.348            1.40
2 2         124          0.389            2.48
3 3          76         -1.03             1.13</code></pre>
</div>
</div>
<hr>
<div style="page-break-after: always;"></div>
</section><section id="a-4" class="level1"><h1>5a</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">attari1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">attari2_scores</span>, by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">els_scores</span>, by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">rs_scores</span>, by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rename columns for clarity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"perceived_difficulty"</span>, <span class="st">"numeracy"</span>, </span>
<span>                          <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, </span>
<span>                          <span class="st">"els_accuracy"</span>, <span class="st">"els_score"</span>,</span>
<span>                          <span class="st">"env_attitude"</span>, <span class="st">"env_attitude_z"</span>,</span>
<span>                          <span class="st">"pol_conservatism"</span>, <span class="st">"pol_conservatism_z"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">km_result</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create composite knowledge score</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">composite_knowledge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"numeracy"</span>, <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, <span class="st">"els_score"</span><span class="op">)</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create standardized scores for profile analysis</span></span>
<span><span class="va">profile_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">cluster</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, </span>
<span>         <span class="va">els_score</span>, <span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">gather</span><span class="op">(</span><span class="va">measure</span>, <span class="va">value</span>, <span class="op">-</span><span class="va">id</span>, <span class="op">-</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">measure</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>z_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create profile plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">profile_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">measure</span>, y <span class="op">=</span> <span class="va">z_score</span>, color <span class="op">=</span> <span class="va">cluster</span>, group <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"line"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Knowledge-Motivation Profiles by Cluster"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Measure"</span>, y <span class="op">=</span> <span class="st">"Standardized Score"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Canonical Correlation Analysis between Knowledge and Motivation Sets</span></span>
<span><span class="co"># Prepare matrices</span></span>
<span><span class="va">knowledge_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">motivation_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform CCA</span></span>
<span><span class="va">cc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cancor.html">cancor</a></span><span class="op">(</span><span class="va">knowledge_vars</span>, <span class="va">motivation_vars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Network Analysis to Visualize Variable Relationships</span></span>
<span></span>
<span><span class="co"># Create correlation matrix</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>                   <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>                         <span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span>, <span class="va">pol_conservatism</span><span class="op">)</span>,</span>
<span>                 use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create network plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qgraph/man/qgraph.html">qgraph</a></span><span class="op">(</span><span class="va">cor_matrix</span>, </span>
<span>       layout <span class="op">=</span> <span class="st">"spring"</span>,</span>
<span>       groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Knowledge <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, Motivation <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>,</span>
<span>       color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"lightgreen"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 4. Mixed Effects Model to Account for Potential Group-Level Effects</span></span>
<span><span class="va">mixed_model</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">els_score</span> <span class="op">~</span> <span class="va">env_attitude</span> <span class="op">+</span> <span class="va">perceived_difficulty</span> <span class="op">+</span> </span>
<span>                     <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">cluster</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mixed_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: els_score ~ env_attitude + perceived_difficulty + (1 | cluster)
   Data: combined_scores

REML criterion at convergence: 715

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.1569 -0.6181  0.0618  0.7882  1.9642 

Random effects:
 Groups   Name        Variance Std.Dev.
 cluster  (Intercept) 0.551    0.742   
 Residual             0.665    0.816   
Number of obs: 287, groups:  cluster, 3

Fixed effects:
                     Estimate Std. Error t value
(Intercept)           -0.4586     0.5199   -0.88
env_attitude           0.0966     0.0826    1.17
perceived_difficulty   0.0466     0.0581    0.80

Correlation of Fixed Effects:
            (Intr) env_tt
env_attitud -0.558       
prcvd_dffcl -0.166  0.278</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 5. Structural Equation Model for Path Analysis</span></span>
<span></span>
<span><span class="co"># Define model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  # Measurement model</span></span>
<span><span class="st">  knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span><span class="st">  motivation =~ env_attitude + perceived_difficulty + pol_conservatism</span></span>
<span><span class="st"></span></span>
<span><span class="st">  # Structural model</span></span>
<span><span class="st">  knowledge ~ motivation</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="co"># Fit model</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 34 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        15

  Number of observations                           287

Model Test User Model:
                                                      
  Test statistic                                28.421
  Degrees of freedom                                13
  P-value (Chi-square)                           0.008

Model Test Baseline Model:

  Test statistic                               589.268
  Degrees of freedom                                21
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.973
  Tucker-Lewis Index (TLI)                       0.956

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -2593.839
  Loglikelihood unrestricted model (H1)      -2579.629
                                                      
  Akaike (AIC)                                5217.679
  Bayesian (BIC)                              5272.571
  Sample-size adjusted Bayesian (SABIC)       5225.004

Root Mean Square Error of Approximation:

  RMSEA                                          0.064
  90 Percent confidence interval - lower         0.032
  90 Percent confidence interval - upper         0.097
  P-value H_0: RMSEA &lt;= 0.050                    0.208
  P-value H_0: RMSEA &gt;= 0.080                    0.231

Standardized Root Mean Square Residual:

  SRMR                                           0.041

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  knowledge =~                                                          
    numeracy          1.000                               0.549    0.550
    energy_use        1.593    0.173    9.204    0.000    0.874    0.875
    energy_save       1.429    0.159    8.965    0.000    0.784    0.785
    els_score         1.080    0.142    7.624    0.000    0.592    0.593
  motivation =~                                                         
    env_attitude      1.000                               0.537    0.705
    percvd_dffclty   -1.123    0.155   -7.233    0.000   -0.603   -0.604
    pol_conservtsm   -1.487    0.216   -6.892    0.000   -0.798   -0.555

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  knowledge ~                                                           
    motivation        0.654    0.111    5.910    0.000    0.640    0.640

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .numeracy          0.696    0.063   11.110    0.000    0.696    0.698
   .energy_use        0.233    0.045    5.191    0.000    0.233    0.234
   .energy_save       0.382    0.047    8.211    0.000    0.382    0.384
   .els_score         0.646    0.059   10.874    0.000    0.646    0.648
   .env_attitude      0.291    0.041    7.054    0.000    0.291    0.502
   .percvd_dffclty    0.633    0.070    9.104    0.000    0.633    0.635
   .pol_conservtsm    1.434    0.146    9.788    0.000    1.434    0.692
   .knowledge         0.178    0.042    4.275    0.000    0.590    0.590
    motivation        0.288    0.053    5.390    0.000    1.000    1.000</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 6. Classification Tree for Predicting Knowledge Levels - rpart functions</span></span>
<span><span class="co"># Create binary knowledge indicator (high/low) based on median split</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">knowledge_level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">$</span><span class="va">composite_knowledge</span> <span class="op">&gt;</span> </span>
<span>                                               <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">$</span><span class="va">composite_knowledge</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                                               <span class="st">"High"</span>, <span class="st">"Low"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit tree</span></span>
<span><span class="va">tree_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">knowledge_level</span> <span class="op">~</span> <span class="va">env_attitude</span> <span class="op">+</span> <span class="va">perceived_difficulty</span> <span class="op">+</span> </span>
<span>                     <span class="va">pol_conservatism</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot tree</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/rpart.plot/man/rpart.plot.html">rpart.plot</a></span><span class="op">(</span><span class="va">tree_model</span>, extra <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<hr>
<div style="page-break-after: always;"></div>
</section><section id="b" class="level1"><h1>1b</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lpa_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lpa_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>---------------------------------------------------- 
Gaussian finite mixture model fitted by EM algorithm 
---------------------------------------------------- 

Mclust VEE (ellipsoidal, equal shape and orientation) model with 3 components: 

 log-likelihood   n df   BIC   ICL
          -2450 287 53 -5201 -5231

Clustering table:
  1   2   3 
129  66  92 </code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lpa_model</span>, <span class="st">"BIC"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">can_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cancor.html">cancor</a></span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">combined_scores</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span><span class="op">)</span>,</span>
<span>                  <span class="fu">select</span><span class="op">(</span><span class="va">combined_scores</span>, <span class="va">env_attitude_z</span>, <span class="va">perceived_difficulty</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">can_cor</span><span class="op">$</span><span class="va">cor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.434 0.055</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, <span class="fu">cluster</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/cluster/man/pam.html">pam</a></span>, method <span class="op">=</span> <span class="st">"silhouette"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Silhouette Method for Optimal k"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sem_model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  knowledge =~ numeracy + energy_use + energy_save + els_accuracy</span></span>
<span><span class="st">  motivation =~ env_attitude_z + perceived_difficulty</span></span>
<span><span class="st">  knowledge ~ motivation</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">sem_model</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 32 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        13

  Number of observations                           287

Model Test User Model:
                                                      
  Test statistic                                13.787
  Degrees of freedom                                 8
  P-value (Chi-square)                           0.087

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  knowledge =~                                                          
    numeracy          1.000                               0.542    0.543
    energy_use        1.623    0.179    9.079    0.000    0.880    0.882
    energy_save       1.441    0.163    8.857    0.000    0.782    0.783
    els_accuracy      2.099    0.278    7.546    0.000    1.139    0.591
  motivation =~                                                         
    env_attitude_z    1.000                               0.654    0.655
    percvd_dffclty   -1.050    0.172   -6.120    0.000   -0.687   -0.688

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  knowledge ~                                                           
    motivation        0.505    0.095    5.345    0.000    0.609    0.609

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .numeracy          0.702    0.063   11.143    0.000    0.702    0.705
   .energy_use        0.222    0.046    4.848    0.000    0.222    0.223
   .energy_save       0.386    0.047    8.188    0.000    0.386    0.387
   .els_accuracy      2.416    0.222   10.891    0.000    2.416    0.651
   .env_attitude_z    0.569    0.081    7.037    0.000    0.569    0.571
   .percvd_dffclty    0.525    0.084    6.218    0.000    0.525    0.526
   .knowledge         0.185    0.044    4.227    0.000    0.629    0.629
    motivation        0.428    0.095    4.525    0.000    1.000    1.000</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">env_attitude_z</span><span class="op">)</span>, </span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 5
  cluster numeracy_mean numeracy_sd env_attitude_z_mean env_attitude_z_sd
  &lt;fct&gt;           &lt;dbl&gt;       &lt;dbl&gt;               &lt;dbl&gt;             &lt;dbl&gt;
1 1               0.282       0.757              -0.391             0.842
2 2              -1.14        0.854              -0.685             0.796
3 3               0.463       0.666               0.679             0.765</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lpa_model</span>, <span class="st">"BIC"</span><span class="op">)</span> <span class="co"># Visualize model selection</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lpa_3class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, G<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co"># Force 3-class solution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lpa_3class</span>, parameters<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>---------------------------------------------------- 
Gaussian finite mixture model fitted by EM algorithm 
---------------------------------------------------- 

Mclust VEE (ellipsoidal, equal shape and orientation) model with 3 components: 

 log-likelihood   n df   BIC   ICL
          -2450 287 53 -5201 -5231

Clustering table:
  1   2   3 
129  66  92 

Mixing probabilities:
   1    2    3 
0.45 0.22 0.32 

Means:
                            [,1]  [,2]   [,3]
numeracy_score              0.40 -1.34  0.366
relative_energy_use_score   0.38 -0.95  0.118
relative_energy_save_score  0.44 -1.00  0.072
els                         0.32 -0.96  0.207
perceived_difficulty_score -0.32  0.81 -0.109
env_attitude                0.52 -0.68 -0.261
pol_conservatism           -0.97  0.68  0.883

Variances:
[,,1]
                           numeracy_score relative_energy_use_score
numeracy_score                      0.423                     0.087
relative_energy_use_score           0.087                     0.627
relative_energy_save_score          0.024                     0.349
els                                 0.049                     0.213
perceived_difficulty_score          0.100                    -0.111
env_attitude                       -0.031                     0.093
pol_conservatism                   -0.026                    -0.041
                           relative_energy_save_score    els
numeracy_score                                 0.0243  0.049
relative_energy_use_score                      0.3495  0.213
relative_energy_save_score                     0.5890  0.117
els                                            0.1172  0.641
perceived_difficulty_score                    -0.0684 -0.038
env_attitude                                   0.0550  0.099
pol_conservatism                              -0.0015 -0.015
                           perceived_difficulty_score env_attitude
numeracy_score                                  0.100      -0.0306
relative_energy_use_score                      -0.111       0.0932
relative_energy_save_score                     -0.068       0.0550
els                                            -0.038       0.0990
perceived_difficulty_score                      0.692      -0.2266
env_attitude                                   -0.227       0.6598
pol_conservatism                                0.019      -0.0093
                           pol_conservatism
numeracy_score                      -0.0258
relative_energy_use_score           -0.0413
relative_energy_save_score          -0.0015
els                                 -0.0151
perceived_difficulty_score           0.0195
env_attitude                        -0.0093
pol_conservatism                     0.1793
[,,2]
                           numeracy_score relative_energy_use_score
numeracy_score                      0.509                      0.11
relative_energy_use_score           0.105                      0.75
relative_energy_save_score          0.029                      0.42
els                                 0.058                      0.26
perceived_difficulty_score          0.120                     -0.13
env_attitude                       -0.037                      0.11
pol_conservatism                   -0.031                     -0.05
                           relative_energy_save_score    els
numeracy_score                                 0.0292  0.058
relative_energy_use_score                      0.4206  0.256
relative_energy_save_score                     0.7090  0.141
els                                            0.1410  0.771
perceived_difficulty_score                    -0.0823 -0.046
env_attitude                                   0.0663  0.119
pol_conservatism                              -0.0018 -0.018
                           perceived_difficulty_score env_attitude
numeracy_score                                  0.120       -0.037
relative_energy_use_score                      -0.133        0.112
relative_energy_save_score                     -0.082        0.066
els                                            -0.046        0.119
perceived_difficulty_score                      0.833       -0.273
env_attitude                                   -0.273        0.794
pol_conservatism                                0.023       -0.011
                           pol_conservatism
numeracy_score                      -0.0310
relative_energy_use_score           -0.0498
relative_energy_save_score          -0.0018
els                                 -0.0182
perceived_difficulty_score           0.0235
env_attitude                        -0.0112
pol_conservatism                     0.2159
[,,3]
                           numeracy_score relative_energy_use_score
numeracy_score                      0.566                     0.117
relative_energy_use_score           0.117                     0.840
relative_energy_save_score          0.033                     0.468
els                                 0.065                     0.285
perceived_difficulty_score          0.134                    -0.149
env_attitude                       -0.041                     0.125
pol_conservatism                   -0.035                    -0.055
                           relative_energy_save_score    els
numeracy_score                                  0.033  0.065
relative_energy_use_score                       0.468  0.285
relative_energy_save_score                      0.789  0.157
els                                             0.157  0.859
perceived_difficulty_score                     -0.092 -0.051
env_attitude                                    0.074  0.133
pol_conservatism                               -0.002 -0.020
                           perceived_difficulty_score env_attitude
numeracy_score                                  0.134       -0.041
relative_energy_use_score                      -0.149        0.125
relative_energy_save_score                     -0.092        0.074
els                                            -0.051        0.133
perceived_difficulty_score                      0.927       -0.304
env_attitude                                   -0.304        0.884
pol_conservatism                                0.026       -0.012
                           pol_conservatism
numeracy_score                       -0.035
relative_energy_use_score            -0.055
relative_energy_save_score           -0.002
els                                  -0.020
perceived_difficulty_score            0.026
env_attitude                         -0.012
pol_conservatism                      0.240</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lpa_3class</span>, what<span class="op">=</span><span class="st">"classification"</span><span class="op">)</span> <span class="co"># Visualize classification</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Interpret canonical variables</span></span>
<span><span class="va">cancor_loadings</span> <span class="op">&lt;-</span> <span class="va">can_cor</span><span class="op">$</span><span class="va">xcoef</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">rownames_to_column</span><span class="op">(</span><span class="st">"variable"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>Dimension1<span class="op">=</span><span class="va">V1</span>, Dimension2<span class="op">=</span><span class="va">V2</span>, Dimension3<span class="op">=</span><span class="va">V3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cancor_loadings</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     variable Dimension1 Dimension2 Dimension3
1    numeracy     0.0067     0.0669     0.0049
2  energy_use     0.0370    -0.0325     0.0708
3 energy_save     0.0230    -0.0078    -0.0802</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Improve SEM specification</span></span>
<span><span class="va">sem_improved</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  knowledge =~ numeracy + energy_use + energy_save + els_accuracy</span></span>
<span><span class="st">  motivation =~ env_attitude_z + perceived_difficulty</span></span>
<span><span class="st">  knowledge ~ motivation</span></span>
<span><span class="st">  els_accuracy ~~ energy_use # Add residual covariance</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_improved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">sem_improved</span>, data<span class="op">=</span><span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_improved</span>, fit.measures<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 34 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

  Number of observations                           287

Model Test User Model:
                                                      
  Test statistic                                13.301
  Degrees of freedom                                 7
  P-value (Chi-square)                           0.065

Model Test Baseline Model:

  Test statistic                               509.961
  Degrees of freedom                                15
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.987
  Tucker-Lewis Index (TLI)                       0.973

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -2380.829
  Loglikelihood unrestricted model (H1)      -2374.178
                                                      
  Akaike (AIC)                                4789.657
  Bayesian (BIC)                              4840.890
  Sample-size adjusted Bayesian (SABIC)       4796.495

Root Mean Square Error of Approximation:

  RMSEA                                          0.056
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.101
  P-value H_0: RMSEA &lt;= 0.050                    0.360
  P-value H_0: RMSEA &gt;= 0.080                    0.219

Standardized Root Mean Square Residual:

  SRMR                                           0.029

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  knowledge =~                                        
    numeracy          1.000                           
    energy_use        1.652    0.191    8.666    0.000
    energy_save       1.420    0.160    8.863    0.000
    els_accuracy      2.186    0.313    6.987    0.000
  motivation =~                                       
    env_attitude_z    1.000                           
    percvd_dffclty   -1.047    0.171   -6.134    0.000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  knowledge ~                                         
    motivation        0.500    0.095    5.285    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
 .energy_use ~~                                       
   .els_accuracy     -0.068    0.092   -0.738    0.460

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .numeracy          0.704    0.063   11.128    0.000
   .energy_use        0.198    0.058    3.397    0.001
   .energy_save       0.406    0.053    7.684    0.000
   .els_accuracy      2.315    0.254    9.107    0.000
   .env_attitude_z    0.567    0.081    7.022    0.000
   .percvd_dffclty    0.526    0.084    6.259    0.000
   .knowledge         0.185    0.043    4.262    0.000
    motivation        0.429    0.095    4.536    0.000</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 4. Validate clusters with outcomes</span></span>
<span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>recycling_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">env_attitude_z</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            energy_behavior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">energy_save</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">cluster</span>, names_to<span class="op">=</span><span class="st">"outcome"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cluster</span>, y<span class="op">=</span><span class="va">value</span>, fill<span class="op">=</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Cluster Validation Through Behavioral Outcomes"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-12-5.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section><section id="b-1" class="level1"><h1>2b</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combine all items into a single dataframe</span></span>
<span><span class="va">all_items</span> <span class="op">&lt;-</span> <span class="fu">full_join</span><span class="op">(</span><span class="va">aes_combined</span>, <span class="va">att2_combined</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">els</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">rs</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select only item columns for factor analysis</span></span>
<span><span class="va">item_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">all_items</span><span class="op">)</span>, <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="va">item_data</span> <span class="op">&lt;-</span> <span class="va">all_items</span><span class="op">[</span>, <span class="va">item_columns</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Perform factor analysis</span></span>
<span><span class="va">fa_items</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="va">item_data</span>, nfactors <span class="op">=</span> <span class="fl">5</span>, rotate <span class="op">=</span> <span class="st">"varimax"</span><span class="op">)</span>  <span class="co"># Adjust nfactors as needed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fa_items</span>, cut <span class="op">=</span> <span class="fl">0.3</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = item_data, nfactors = 5, rotate = "varimax")
Standardized loadings (pattern matrix) based upon correlation matrix
      item   MR1   MR2   MR3   MR5   MR4    h2    u2 com
ATT25   25  0.94                         0.903 0.097 1.0
ATT23   23  0.89                         0.854 0.146 1.1
ATT26   26  0.89                         0.811 0.189 1.1
ATT27   27  0.89                         0.802 0.198 1.0
ATT24   24  0.81                         0.758 0.242 1.3
ATT33   33  0.70                         0.624 0.376 1.6
ATT32   32  0.61                         0.423 0.577 1.3
ATT30   30  0.54              0.36       0.561 0.439 2.9
ATT31   31  0.40                         0.238 0.762 2.0
ATT10   10        0.68                   0.537 0.463 1.4
ATT15   15        0.66 -0.37             0.593 0.407 1.7
ATT14   14        0.65 -0.39             0.611 0.389 1.8
ATT09    9        0.64                   0.507 0.493 1.5
ATT06    6        0.64                   0.460 0.540 1.3
ATT13   13        0.60                   0.365 0.635 1.0
ATT07    7        0.58                   0.377 0.623 1.3
ATT03    3        0.57                   0.420 0.580 1.6
ATT04    4        0.52                   0.320 0.680 1.4
ATT08    8        0.52                   0.284 0.716 1.1
ATT12   12        0.50                   0.290 0.710 1.4
ATT05    5        0.49                   0.313 0.687 1.6
ATT01    1        0.45                   0.265 0.735 1.6
RS01    42       -0.42  0.32             0.321 0.679 2.4
ATT02    2        0.35                   0.190 0.810 2.1
RS02    43                               0.092 0.908 1.2
ATT11   11                               0.098 0.902 1.7
RS03    44       -0.40  0.61             0.596 0.404 2.2
ATT17   17             -0.47             0.290 0.710 1.6
RS06    47              0.45             0.229 0.771 1.3
RS04    45              0.43             0.309 0.691 2.3
RS05    46              0.41             0.249 0.751 1.9
ATT18   18             -0.40             0.279 0.721 2.5
ELS02   35              0.40             0.178 0.822 1.2
ELS03   36              0.39             0.176 0.824 1.3
ELS07   40              0.34             0.133 0.867 1.3
ELS04   37              0.32             0.107 0.893 1.0
ELS05   38                               0.084 0.916 1.3
ELS01   34                               0.116 0.884 2.7
ATT19   19                               0.040 0.960 1.2
ELS08   41                               0.070 0.930 3.6
ATT20   20                    0.93       0.917 0.083 1.1
ATT21   21  0.33              0.80       0.757 0.243 1.3
ATT22   22                    0.75       0.618 0.382 1.2
ATT28   28                          0.88 0.787 0.213 1.0
ATT29   29                          0.86 0.751 0.249 1.0
ATT16   16                               0.068 0.932 1.2
ELS06   39                               0.035 0.965 3.2

                       MR1  MR2  MR3  MR5  MR4
SS loadings           5.73 5.41 2.97 2.71 1.99
Proportion Var        0.12 0.12 0.06 0.06 0.04
Cumulative Var        0.12 0.24 0.30 0.36 0.40
Proportion Explained  0.30 0.29 0.16 0.14 0.11
Cumulative Proportion 0.30 0.59 0.75 0.89 1.00

Mean item complexity =  1.6
Test of the hypothesis that 5 factors are sufficient.

df null model =  1081  with the objective function =  31 with Chi Square =  8297
df of  the model are 856  and the objective function was  11 

The root mean square of the residuals (RMSR) is  0.06 
The df corrected root mean square of the residuals is  0.07 

The harmonic n.obs is  287 with the empirical chi square  2111  with prob &lt;  0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024 
The total n.obs was  287  with Likelihood Chi Square =  3032  with prob &lt;  0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000026 

Tucker Lewis Index of factoring reliability =  0.61
RMSEA index =  0.094  and the 90 % confidence intervals are  0.091 0.098
BIC =  -1812
Fit based upon off diagonal values = 0.92
Measures of factor score adequacy             
                                                   MR1  MR2  MR3  MR5  MR4
Correlation of (regression) scores with factors   0.98 0.94 0.89 0.97 0.94
Multiple R square of scores with factors          0.97 0.89 0.79 0.95 0.88
Minimum correlation of possible factor scores     0.93 0.78 0.58 0.89 0.76</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  # Measurement model</span></span>
<span><span class="st">  Knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span><span class="st">  Motivation =~ env_attitude_z + perceived_difficulty</span></span>
<span><span class="st"></span></span>
<span><span class="st">  # Structural model</span></span>
<span><span class="st">  Knowledge ~ Motivation</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 31 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        13

  Number of observations                           287

Model Test User Model:
                                                      
  Test statistic                                13.787
  Degrees of freedom                                 8
  P-value (Chi-square)                           0.087

Model Test Baseline Model:

  Test statistic                               509.961
  Degrees of freedom                                15
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.988
  Tucker-Lewis Index (TLI)                       0.978

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -2192.320
  Loglikelihood unrestricted model (H1)      -2185.427
                                                      
  Akaike (AIC)                                4410.640
  Bayesian (BIC)                              4458.213
  Sample-size adjusted Bayesian (SABIC)       4416.989

Root Mean Square Error of Approximation:

  RMSEA                                          0.050
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.094
  P-value H_0: RMSEA &lt;= 0.050                    0.441
  P-value H_0: RMSEA &gt;= 0.080                    0.145

Standardized Root Mean Square Residual:

  SRMR                                           0.031

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Knowledge =~                                                          
    numeracy          1.000                               0.542    0.543
    energy_use        1.623    0.179    9.079    0.000    0.880    0.882
    energy_save       1.441    0.163    8.857    0.000    0.782    0.783
    els_score         1.088    0.144    7.546    0.000    0.590    0.591
  Motivation =~                                                         
    env_attitude_z    1.000                               0.654    0.655
    percvd_dffclty   -1.050    0.172   -6.120    0.000   -0.687   -0.688

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Knowledge ~                                                           
    Motivation        0.505    0.095    5.345    0.000    0.609    0.609

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .numeracy          0.702    0.063   11.143    0.000    0.702    0.705
   .energy_use        0.222    0.046    4.848    0.000    0.222    0.223
   .energy_save       0.386    0.047    8.188    0.000    0.386    0.387
   .els_score         0.649    0.060   10.891    0.000    0.649    0.651
   .env_attitude_z    0.569    0.081    7.037    0.000    0.569    0.571
   .percvd_dffclty    0.525    0.084    6.218    0.000    0.525    0.526
   .Knowledge         0.185    0.044    4.227    0.000    0.629    0.629
    Motivation        0.428    0.095    4.525    0.000    1.000    1.000</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example LPA (using tidyLPA)</span></span>
<span><span class="va">lpa_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>, <span class="va">env_attitude_z</span>, <span class="va">perceived_difficulty</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># convert all to numeric</span></span>
<span>    <span class="fu">mutate_all</span><span class="op">(</span><span class="va">as.numeric</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lpa_results</span> <span class="op">&lt;-</span> <span class="va">lpa_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://data-edu.github.io/tidyLPA/reference/estimate_profiles.html">estimate_profiles</a></span><span class="op">(</span>n_profiles <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># Estimate models with 1-5 profiles</span></span>
<span>  <span class="fu"><a href="https://data-edu.github.io/tidyLPA/reference/compare_solutions.html">compare_solutions</a></span><span class="op">(</span>statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lpa_results</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Determine optimal k using silhouette method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"silhouette"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Silhouette Method for Optimal k"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<hr></section><section id="b-2" class="level1"><h1>3b</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1) Create a correlation matrix of the key knowledge &amp; motivation subscales</span></span>
<span><span class="co">#    ensuring no duplicates (e.g., pick either 'env_attitude' or 'env_attitude_z').</span></span>
<span></span>
<span><span class="va">cor_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>         <span class="va">perceived_difficulty</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2) Compute correlations</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">cor_vars</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3) Visualize</span></span>
<span><span class="fu">corrplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">cor_matrix</span>, method <span class="op">=</span> <span class="st">"color"</span>, type<span class="op">=</span><span class="st">"upper"</span>, </span>
<span>                   tl.col<span class="op">=</span><span class="st">"black"</span>, addCoef.col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fa_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>         <span class="va">perceived_difficulty</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fa_result</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="va">fa_data</span>, nfactors <span class="op">=</span> <span class="fl">2</span>, rotate <span class="op">=</span> <span class="st">"varimax"</span>, fm <span class="op">=</span> <span class="st">"ml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fa_result</span>, cut<span class="op">=</span><span class="fl">0.3</span>, sort<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  ml
Call: fa(r = fa_data, nfactors = 2, rotate = "varimax", fm = "ml")
Standardized loadings (pattern matrix) based upon correlation matrix
                     item   ML2   ML1   h2    u2 com
energy_use              2  0.85       0.78 0.220 1.1
energy_save             3  0.75       0.62 0.384 1.2
els_score               4  0.53       0.35 0.652 1.4
numeracy                1  0.52       0.30 0.702 1.2
env_attitude            6        0.98 0.98 0.018 1.0
perceived_difficulty    5 -0.31 -0.42 0.27 0.727 1.9
pol_conservatism        7 -0.31 -0.38 0.24 0.759 1.9

                       ML2  ML1
SS loadings           2.06 1.48
Proportion Var        0.29 0.21
Cumulative Var        0.29 0.51
Proportion Explained  0.58 0.42
Cumulative Proportion 0.58 1.00

Mean item complexity =  1.4
Test of the hypothesis that 2 factors are sufficient.

df null model =  21  with the objective function =  2 with Chi Square =  581
df of  the model are 8  and the objective function was  0.05 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.05 

The harmonic n.obs is  287 with the empirical chi square  12  with prob &lt;  0.13 
The total n.obs was  287  with Likelihood Chi Square =  15  with prob &lt;  0.066 

Tucker Lewis Index of factoring reliability =  0.97
RMSEA index =  0.054  and the 90 % confidence intervals are  0 0.097
BIC =  -31
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   ML2  ML1
Correlation of (regression) scores with factors   0.92 0.99
Multiple R square of scores with factors          0.84 0.98
Minimum correlation of possible factor scores     0.68 0.96</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_motivation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">env_attitude</span> <span class="op">~</span> <span class="va">els_score</span> <span class="op">+</span> <span class="va">numeracy</span> <span class="op">+</span> <span class="va">pol_conservatism</span>,</span>
<span>                       data<span class="op">=</span><span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_motivation</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = env_attitude ~ els_score + numeracy + pol_conservatism, 
    data = combined_scores)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.4317 -0.4376  0.0398  0.4590  1.9839 

Coefficients:
                 Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)        4.0791     0.0866   47.11 &lt; 0.0000000000000002 ***
els_score          0.1633     0.0446    3.66               0.0003 ***
numeracy           0.0210     0.0454    0.46               0.6433    
pol_conservatism  -0.1872     0.0294   -6.36        0.00000000081 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.68 on 283 degrees of freedom
Multiple R-squared:  0.22,  Adjusted R-squared:  0.212 
F-statistic: 26.6 on 3 and 283 DF,  p-value: 0.00000000000000336</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_knowledge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els_score</span> <span class="op">~</span> <span class="va">perceived_difficulty</span> <span class="op">+</span> <span class="va">env_attitude</span> <span class="op">+</span> <span class="va">pol_conservatism</span>,</span>
<span>                      data<span class="op">=</span><span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_knowledge</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els_score ~ perceived_difficulty + env_attitude + 
    pol_conservatism, data = combined_scores)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.3489 -0.7106  0.0245  0.7152  2.2516 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)           -0.6746     0.3692   -1.83   0.0688 . 
perceived_difficulty  -0.1487     0.0623   -2.39   0.0176 * 
env_attitude           0.2526     0.0868    2.91   0.0039 **
pol_conservatism      -0.0891     0.0424   -2.10   0.0364 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.94 on 283 degrees of freedom
Multiple R-squared:  0.132, Adjusted R-squared:  0.123 
F-statistic: 14.3 on 3 and 283 DF,  p-value: 0.0000000102</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">knowledge_only</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="co"># Decide k with elbow or silhouette</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">knowledge_only</span>, <span class="va">kmeans</span>, method<span class="op">=</span><span class="st">"wss"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">km_knowl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">knowledge_only</span>, centers<span class="op">=</span><span class="fl">3</span>, nstart<span class="op">=</span><span class="fl">25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_knowl</span>, data <span class="op">=</span> <span class="va">knowledge_only</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-14-3.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>         <span class="va">perceived_difficulty</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">all_vars</span>, <span class="va">kmeans</span>, method<span class="op">=</span><span class="st">"wss"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-14-4.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">km_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">all_vars</span>, centers<span class="op">=</span><span class="fl">3</span>, nstart<span class="op">=</span><span class="fl">25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_all</span>, data<span class="op">=</span><span class="va">all_vars</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-14-5.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section><section id="b-3" class="level1"><h1>4b</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1. Summarize clusters on an extra measure</span></span>
<span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean_recycling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">env_attitude_z</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_recycling   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">env_attitude_z</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 4
  cluster mean_recycling sd_recycling     n
  &lt;fct&gt;            &lt;dbl&gt;        &lt;dbl&gt; &lt;int&gt;
1 1               -0.391        0.842    89
2 2               -0.685        0.796    73
3 3                0.679        0.765   125</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. ANOVA to test whether clusters differ significantly </span></span>
<span><span class="va">anova_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">env_attitude_z</span> <span class="op">~</span> <span class="va">cluster</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value              Pr(&gt;F)    
cluster       2    105    52.7    82.9 &lt;0.0000000000000002 ***
Residuals   284    181     0.6                                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Pairwise comparisons if ANOVA is significant</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = env_attitude_z ~ cluster, data = combined_scores)

$cluster
     diff   lwr    upr p adj
2-1 -0.29 -0.59 0.0033  0.05
3-1  1.07  0.81 1.3306  0.00
3-2  1.36  1.09 1.6401  0.00</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Subset data to knowledge &amp; motivation variables</span></span>
<span><span class="va">lpa_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>, </span>
<span>         <span class="va">perceived_difficulty</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model-based clustering</span></span>
<span><span class="va">lpa_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">lpa_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lpa_model</span><span class="op">)</span>  <span class="co"># Tells you how many clusters &amp; the type of covariance structure</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>---------------------------------------------------- 
Gaussian finite mixture model fitted by EM algorithm 
---------------------------------------------------- 

Mclust VEE (ellipsoidal, equal shape and orientation) model with 3 components: 

 log-likelihood   n df   BIC   ICL
          -2450 287 53 -5201 -5231

Clustering table:
  1   2   3 
129  66  92 </code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract membership</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">LPA_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">lpa_model</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">$</span><span class="va">LPA_cluster</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3 
129  66  92 </code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compare means across the new LPA-based clusters</span></span>
<span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">LPA_cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    <span class="fu">across</span><span class="op">(</span><span class="va">numeracy</span><span class="op">:</span><span class="va">pol_conservatism</span>, <span class="va">mean</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 9
  LPA_cluster numeracy energy_use energy_save els_accuracy els_score
  &lt;fct&gt;          &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;
1 1              0.391      0.383       0.433         5.12     0.329
2 2             -1.34      -0.954      -1.01          2.58    -0.987
3 3              0.412      0.146       0.116         4.96     0.246
# â„¹ 3 more variables: env_attitude &lt;dbl&gt;, env_attitude_z &lt;dbl&gt;,
#   pol_conservatism &lt;dbl&gt;</code></pre>
</div>
</div>
<hr>
<div style="page-break-after: always;"></div>
</section><section id="c" class="level1"><h1>1c</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combine all individual survey items from each instrument</span></span>
<span><span class="va">all_items</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">aes_combined</span>, <span class="va">att2_combined</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">els</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">rs</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select only item columns for analysis</span></span>
<span><span class="va">item_data</span> <span class="op">&lt;-</span> <span class="va">all_items</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">subscale_cors</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">perceived_difficulty</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>,</span>
<span>         <span class="va">els_score</span>, <span class="va">env_attitude_z</span>, <span class="va">pol_conservatism_z</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># 3. Knowledge-Motivation Relationship Analyses</span></span>
<span><span class="co"># Create composite scores with explicit content alignment</span></span>
<span><span class="va">knowledge_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"numeracy"</span>, <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, <span class="st">"els_score"</span><span class="op">)</span></span>
<span><span class="va">motivation_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"env_attitude_z"</span>, <span class="st">"perceived_difficulty"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">.</span>, <span class="fu">all_of</span><span class="op">(</span><span class="va">knowledge_vars</span><span class="op">)</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">.</span>, <span class="fu">all_of</span><span class="op">(</span><span class="va">motivation_vars</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># 3a. Bivariate Correlation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">combined_scores</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">knowledge</span>, <span class="va">motivation</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  knowledge and motivation
t = -0.5, df = 285, p-value = 0.6
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.148  0.084
sample estimates:
   cor 
-0.032 </code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3b. Hierarchical Regression</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">knowledge</span> <span class="op">~</span> <span class="va">motivation</span> <span class="op">+</span> <span class="va">pol_conservatism_z</span> <span class="op">+</span> <span class="va">cluster</span>, </span>
<span>            data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = knowledge ~ motivation + pol_conservatism_z + cluster, 
    data = combined_scores)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.3728 -0.4668 -0.0452  0.4709  1.5670 

Coefficients:
                   Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)          0.1457     0.0742    1.96                0.051 .  
motivation          -0.0523     0.0347   -1.51                0.133    
pol_conservatism_z   0.0603     0.0548    1.10                0.272    
cluster2            -1.5294     0.0927  -16.49 &lt; 0.0000000000000002 ***
cluster3             0.5587     0.1203    4.65            0.0000052 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.58 on 282 degrees of freedom
Multiple R-squared:  0.662, Adjusted R-squared:  0.658 
F-statistic:  138 on 4 and 282 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3c. Path Analysis</span></span>
<span><span class="va">path_model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  motivation ~ a * knowledge</span></span>
<span><span class="st">  els_score ~ b * motivation + c * knowledge</span></span>
<span><span class="st">  indirect := a * b</span></span>
<span><span class="st">  total := c + indirect</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">path_model</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                           287

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  motivation ~                                                          
    knowledge  (a)   -0.032    0.059   -0.550    0.582   -0.032   -0.032
  els_score ~                                                           
    motivation (b)    0.019    0.039    0.487    0.626    0.019    0.019
    knowledge  (c)    0.751    0.039   19.232    0.000    0.751    0.751

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .motivation        0.995    0.083   11.979    0.000    0.995    0.999
   .els_score         0.435    0.036   11.979    0.000    0.435    0.437

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    indirect         -0.001    0.002   -0.365    0.715   -0.001   -0.001
    total             0.750    0.039   19.218    0.000    0.750    0.750</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 4. Cluster Validation by Motivation-Knowledge Profiles</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">combined_scores</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">knowledge</span>, y <span class="op">=</span> <span class="va">motivation</span>, color <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ellipse.html">stat_ellipse</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Knowledge-Motivation Profiles by Cluster"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Standardized Knowledge Composite"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Standardized Motivation Composite"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="c-1" class="level1"><h1>2c</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combine key measures into correlation matrix</span></span>
<span><span class="va">key_measures</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span></span>
<span>    <span class="co"># Knowledge measures</span></span>
<span>    <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>    <span class="co"># Motivation/attitude measures </span></span>
<span>    <span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span>, <span class="va">pol_conservatism</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute and visualize correlation matrix</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">key_measures</span>, use<span class="op">=</span><span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span><span class="fu">corrplot</span><span class="op">(</span><span class="va">cor_matrix</span>, </span>
<span>         method<span class="op">=</span><span class="st">"color"</span>,</span>
<span>         type<span class="op">=</span><span class="st">"upper"</span>,</span>
<span>         addCoef.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>         tl.col<span class="op">=</span><span class="st">"black"</span>,</span>
<span>         tl.srt<span class="op">=</span><span class="fl">45</span>,</span>
<span>         diag<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>         col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Factor Analysis to examine underlying structure</span></span>
<span><span class="va">fa_results</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="va">key_measures</span>, nfactors<span class="op">=</span><span class="fl">2</span>, rotate<span class="op">=</span><span class="st">"varimax"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fa_results</span>, cut<span class="op">=</span><span class="fl">0.3</span>, sort<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = key_measures, nfactors = 2, rotate = "varimax")
Standardized loadings (pattern matrix) based upon correlation matrix
                     item   MR1   MR2   h2    u2 com
energy_use              2  0.84       0.76 0.244 1.1
energy_save             3  0.73       0.59 0.414 1.2
els_score               4  0.56       0.37 0.634 1.3
numeracy                1  0.55       0.33 0.671 1.2
env_attitude            5        0.99 1.00 0.004 1.0
perceived_difficulty    6 -0.31 -0.41 0.27 0.733 1.9
pol_conservatism        7 -0.33 -0.37 0.25 0.752 2.0

                       MR1  MR2
SS loadings           2.08 1.47
Proportion Var        0.30 0.21
Cumulative Var        0.30 0.51
Proportion Explained  0.59 0.41
Cumulative Proportion 0.59 1.00

Mean item complexity =  1.4
Test of the hypothesis that 2 factors are sufficient.

df null model =  21  with the objective function =  2 with Chi Square =  581
df of  the model are 8  and the objective function was  0.06 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.05 

The harmonic n.obs is  287 with the empirical chi square  11  with prob &lt;  0.21 
The total n.obs was  287  with Likelihood Chi Square =  16  with prob &lt;  0.039 

Tucker Lewis Index of factoring reliability =  0.96
RMSEA index =  0.06  and the 90 % confidence intervals are  0.013 0.1
BIC =  -29
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   MR1  MR2
Correlation of (regression) scores with factors   0.91 1.00
Multiple R square of scores with factors          0.83 0.99
Minimum correlation of possible factor scores     0.66 0.99</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Create composite scores and analyze relationships</span></span>
<span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="co"># Knowledge composite (z-score mean)</span></span>
<span>    knowledge_composite <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">numeracy</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">energy_use</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">energy_save</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">els_score</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co"># Motivation composite</span></span>
<span>    motivation_composite <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">env_attitude</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">perceived_difficulty</span><span class="op">)</span>, </span>
<span>            <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">pol_conservatism</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># 4. Profile Analysis using cluster analysis</span></span>
<span><span class="co"># Standardize variables for clustering</span></span>
<span><span class="va">cluster_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">knowledge_composite</span>, <span class="va">motivation_composite</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Determine optimal number of clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_vars</span>, <span class="va">kmeans</span>, method<span class="op">=</span><span class="st">"silhouette"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform k-means clustering</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">3</span>  <span class="co"># Based on silhouette plot</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_vars</span>, centers<span class="op">=</span><span class="va">k</span>, nstart<span class="op">=</span><span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">clusters</span>, data<span class="op">=</span><span class="va">cluster_vars</span>,</span>
<span>             geom<span class="op">=</span><span class="st">"point"</span>,</span>
<span>             ellipse.type<span class="op">=</span><span class="st">"convex"</span>,</span>
<span>             ggtheme<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Knowledge-Motivation Profiles"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 5. Regression Analysis</span></span>
<span><span class="co"># Model 1: Knowledge predicting motivation</span></span>
<span><span class="va">model_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">motivation_composite</span> <span class="op">~</span> <span class="va">knowledge_composite</span>, data<span class="op">=</span><span class="va">combined_scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model 2: Controlling for demographics if available</span></span>
<span><span class="va">model_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">motivation_composite</span> <span class="op">~</span> <span class="va">knowledge_composite</span> <span class="op">+</span> <span class="va">pol_conservatism</span>, </span>
<span>              data<span class="op">=</span><span class="va">combined_scores</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = motivation_composite ~ knowledge_composite, data = combined_scores)

Residuals:
   Min     1Q Median     3Q    Max 
-3.167 -0.541 -0.007  0.607  1.985 

Coefficients:
                                   Estimate              Std. Error t value
(Intercept)         0.000000000000000000796 0.051394015005993207157    0.00
knowledge_composite 0.494554980602242011400 0.051483786279658251550    9.61
                               Pr(&gt;|t|)    
(Intercept)                           1    
knowledge_composite &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.87 on 285 degrees of freedom
Multiple R-squared:  0.245, Adjusted R-squared:  0.242 
F-statistic: 92.3 on 1 and 285 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = motivation_composite ~ knowledge_composite + pol_conservatism, 
    data = combined_scores)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9267 -0.4231 -0.0482  0.4611  1.7669 

Coefficients:
                    Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)           1.1464     0.0840   13.64 &lt; 0.0000000000000002 ***
knowledge_composite   0.2509     0.0414    6.07         0.0000000042 ***
pol_conservatism     -0.4393     0.0287  -15.31 &lt; 0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.65 on 284 degrees of freedom
Multiple R-squared:  0.586, Adjusted R-squared:  0.583 
F-statistic:  201 on 2 and 284 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 6. Examine cluster profiles</span></span>
<span><span class="va">cluster_profiles</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    mean_knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">knowledge_composite</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">knowledge_composite</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">motivation_composite</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">motivation_composite</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cluster_profiles</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 6
  cluster     n mean_knowledge sd_knowledge mean_motivation sd_motivation
  &lt;fct&gt;   &lt;int&gt;          &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;
1 1          99          0.343        0.609          -0.377         0.560
2 2         112          0.573        0.685           1.01          0.465
3 3          76         -1.29         0.546          -0.999         0.599</code></pre>
</div>
</div>
</section><section id="c-2" class="level1"><h1>3c</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Merge them into one "long" dataframe with all items.</span></span>
<span><span class="va">all_items</span> <span class="op">&lt;-</span> <span class="va">aes_combined</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">att2_combined</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">els</span>,           by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">rs</span>,            by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect how many rows (should match total unique respondents if IDs match)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">all_items</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 287  48</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">all_items</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 48
     id ATT01    ATT02   ATT03   ATT04   ATT05   ATT06   ATT07   ATT08   ATT09  
  &lt;int&gt; &lt;dbl+lb&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
1     1 6 [Someâ€¦ 3 [Verâ€¦ 5 [Neiâ€¦ 6 [Somâ€¦ 6 [Somâ€¦ 5 [Neiâ€¦ 5 [Neiâ€¦ 5 [Neiâ€¦ 4 [Somâ€¦
2     2 7 [Veryâ€¦ 2 [Extâ€¦ 5 [Neiâ€¦ 1 [Do â€¦ 7 [Verâ€¦ 1 [Do â€¦ 1 [Do â€¦ 4 [Somâ€¦ 4 [Somâ€¦
3     3 7 [Veryâ€¦ 6 [Somâ€¦ 8 [Extâ€¦ 6 [Somâ€¦ 8 [Extâ€¦ 6 [Somâ€¦ 8 [Extâ€¦ 6 [Somâ€¦ 5 [Neiâ€¦
4     4 6 [Someâ€¦ 5 [Neiâ€¦ 7 [Verâ€¦ 3 [Verâ€¦ 6 [Somâ€¦ 1 [Do â€¦ 1 [Do â€¦ 5 [Neiâ€¦ 1 [Do â€¦
5     5 5 [Neitâ€¦ 6 [Somâ€¦ 4 [Somâ€¦ 5 [Neiâ€¦ 4 [Somâ€¦ 5 [Neiâ€¦ 6 [Somâ€¦ 6 [Somâ€¦ 5 [Neiâ€¦
6     6 6 [Someâ€¦ 4 [Somâ€¦ 6 [Somâ€¦ 2 [Extâ€¦ 8 [Extâ€¦ 1 [Do â€¦ 1 [Do â€¦ 3 [Verâ€¦ 1 [Do â€¦
# â„¹ 38 more variables: ATT10 &lt;dbl+lbl&gt;, ATT11 &lt;dbl+lbl&gt;, ATT12 &lt;dbl+lbl&gt;,
#   ATT13 &lt;dbl+lbl&gt;, ATT14 &lt;dbl+lbl&gt;, ATT15 &lt;dbl+lbl&gt;, ATT16 &lt;dbl&gt;,
#   ATT17 &lt;dbl&gt;, ATT18 &lt;dbl&gt;, ATT19 &lt;dbl&gt;, ATT20 &lt;dbl&gt;, ATT21 &lt;dbl&gt;,
#   ATT22 &lt;dbl&gt;, ATT23 &lt;dbl&gt;, ATT24 &lt;dbl&gt;, ATT25 &lt;dbl&gt;, ATT26 &lt;dbl&gt;,
#   ATT27 &lt;dbl&gt;, ATT28 &lt;dbl&gt;, ATT29 &lt;dbl&gt;, ATT30 &lt;dbl&gt;, ATT31 &lt;dbl&gt;,
#   ATT32 &lt;dbl&gt;, ATT33 &lt;dbl&gt;, ELS01 &lt;dbl+lbl&gt;, ELS02 &lt;dbl+lbl&gt;,
#   ELS03 &lt;dbl+lbl&gt;, ELS04 &lt;dbl+lbl&gt;, ELS05 &lt;dbl+lbl&gt;, ELS06 &lt;dbl+lbl&gt;, â€¦</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Alternatively, if you want only the *summarized scale scores* </span></span>
<span><span class="co"># for each instrument (as in your existing code):</span></span>
<span><span class="co">#   - attari1, attari2_scores, els_scores, rs_scores </span></span>
<span><span class="co"># we can merge those:</span></span>
<span></span>
<span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">attari1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">attari2_scores</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">els_scores</span>,     by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">rs_scores</span>,      by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rename columns for clarity (optional)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"id"</span>, </span>
<span>  <span class="st">"perceived_difficulty"</span>,  <span class="co"># from Attari Part 1</span></span>
<span>  <span class="st">"numeracy"</span>,</span>
<span>  <span class="st">"energy_use"</span>,</span>
<span>  <span class="st">"energy_save"</span>,</span>
<span>  <span class="st">"els_accuracy"</span>,</span>
<span>  <span class="st">"els_score"</span>,</span>
<span>  <span class="st">"env_attitude"</span>,</span>
<span>  <span class="st">"env_attitude_z"</span>,</span>
<span>  <span class="st">"pol_conservatism"</span>,</span>
<span>  <span class="st">"pol_conservatism_z"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># 2. Examine correlations and underlying structure</span></span>
<span><span class="co"># A. Correlation plot among the *scale-level* variables</span></span>
<span><span class="va">cor_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>         <span class="va">perceived_difficulty</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">cor_vars</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize correlation matrix</span></span>
<span><span class="fu">corrplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span></span>
<span>  <span class="va">cor_matrix</span>, </span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, </span>
<span>  addCoef.col <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>  type <span class="op">=</span> <span class="st">"upper"</span>,</span>
<span>  tl.col  <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  tl.srt  <span class="op">=</span> <span class="fl">45</span>,</span>
<span>  diag    <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># B. Factor Analysis (to see if knowledge &amp; motivation load differently)</span></span>
<span><span class="co">#    Using, e.g., 2-factor solution as a demonstration:</span></span>
<span><span class="va">fa_data</span> <span class="op">&lt;-</span> <span class="va">cor_vars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">two_factor</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="va">fa_data</span>, nfactors <span class="op">=</span> <span class="fl">2</span>, rotate <span class="op">=</span> <span class="st">"varimax"</span>, fm <span class="op">=</span> <span class="st">"ml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">two_factor</span>, cut <span class="op">=</span> <span class="fl">0.30</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  ml
Call: fa(r = fa_data, nfactors = 2, rotate = "varimax", fm = "ml")
Standardized loadings (pattern matrix) based upon correlation matrix
                     item   ML2   ML1   h2    u2 com
energy_use              2  0.85       0.78 0.220 1.1
energy_save             3  0.75       0.62 0.384 1.2
els_score               4  0.53       0.35 0.652 1.4
numeracy                1  0.52       0.30 0.702 1.2
env_attitude            6        0.98 0.98 0.018 1.0
perceived_difficulty    5 -0.31 -0.42 0.27 0.727 1.9
pol_conservatism        7 -0.31 -0.38 0.24 0.759 1.9

                       ML2  ML1
SS loadings           2.06 1.48
Proportion Var        0.29 0.21
Cumulative Var        0.29 0.51
Proportion Explained  0.58 0.42
Cumulative Proportion 0.58 1.00

Mean item complexity =  1.4
Test of the hypothesis that 2 factors are sufficient.

df null model =  21  with the objective function =  2 with Chi Square =  581
df of  the model are 8  and the objective function was  0.05 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.05 

The harmonic n.obs is  287 with the empirical chi square  12  with prob &lt;  0.13 
The total n.obs was  287  with Likelihood Chi Square =  15  with prob &lt;  0.066 

Tucker Lewis Index of factoring reliability =  0.97
RMSEA index =  0.054  and the 90 % confidence intervals are  0 0.097
BIC =  -31
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   ML2  ML1
Correlation of (regression) scores with factors   0.92 0.99
Multiple R square of scores with factors          0.84 0.98
Minimum correlation of possible factor scores     0.68 0.96</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ============================================================</span></span>
<span><span class="co"># 3. Inspect the relation between "motivation" and "knowledge"</span></span>
<span><span class="co"># ============================================================</span></span>
<span></span>
<span><span class="co"># --- (a) Simple regressions</span></span>
<span><span class="co"># For example: Predict ELS knowledge (els_score) from motivation variables</span></span>
<span><span class="va">model_els</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els_score</span> <span class="op">~</span> <span class="va">env_attitude</span> <span class="op">+</span> <span class="va">perceived_difficulty</span> <span class="op">+</span> <span class="va">pol_conservatism</span>, </span>
<span>                data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_els</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els_score ~ env_attitude + perceived_difficulty + 
    pol_conservatism, data = combined_scores)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.3489 -0.7106  0.0245  0.7152  2.2516 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)           -0.6746     0.3692   -1.83   0.0688 . 
env_attitude           0.2526     0.0868    2.91   0.0039 **
perceived_difficulty  -0.1487     0.0623   -2.39   0.0176 * 
pol_conservatism      -0.0891     0.0424   -2.10   0.0364 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.94 on 283 degrees of freedom
Multiple R-squared:  0.132, Adjusted R-squared:  0.123 
F-statistic: 14.3 on 3 and 283 DF,  p-value: 0.0000000102</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># --- (b) Create composites and correlate them</span></span>
<span><span class="co"># Composite for "knowledge": average of numeracy, energy_use, energy_save, els_score</span></span>
<span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    knowledge_composite <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span><span class="op">)</span>, </span>
<span>      na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># For "motivation," you might choose env_attitude and reverse-coded difficulty, </span></span>
<span>    <span class="co"># or some other conceptual combination. Example:</span></span>
<span>    motivation_composite <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">env_attitude</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">perceived_difficulty</span><span class="op">)</span>, </span>
<span>      na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">$</span><span class="va">knowledge_composite</span>, <span class="va">combined_scores</span><span class="op">$</span><span class="va">motivation_composite</span>,</span>
<span>    use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.44</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">knowledge_composite</span>, <span class="va">motivation_composite</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Decide the number of clusters (k). Let's try k = 3 for illustration:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">km_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_fit</span>, data <span class="op">=</span> <span class="va">cluster_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means Clustering on Knowledge vs. Motivation"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors2_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Add cluster membership back to your main dataframe</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">km_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">km_fit</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare mean knowledge &amp; motivation by cluster</span></span>
<span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">km_cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean_knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">knowledge_composite</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">motivation_composite</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 4
  km_cluster mean_knowledge mean_motivation     n
  &lt;fct&gt;               &lt;dbl&gt;           &lt;dbl&gt; &lt;int&gt;
1 1                  -1.04             1.11    75
2 2                   0.362            1.39    85
3 3                   0.370            2.47   127</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># --- (d) Canonical Correlation Analysis (CCA)</span></span>
<span><span class="co"># Splitting your knowledge vs. motivation sets</span></span>
<span></span>
<span><span class="va">knowledge_set</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">motivation_set</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We need same rows for both sets, so do a quick align:</span></span>
<span><span class="va">cca_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">knowledge_set</span>, <span class="va">motivation_set</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="va">cca_df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="va">cca_df</span><span class="op">[</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span></span>
<span><span class="va">cca_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cancor.html">cancor</a></span><span class="op">(</span><span class="va">K</span>, <span class="va">M</span><span class="op">)</span></span>
<span><span class="va">cca_res</span><span class="op">$</span><span class="va">cor</span>  <span class="co"># canonical correlations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.502 0.136 0.084</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Inspect canonical weights and loadings</span></span>
<span><span class="va">cca_res</span><span class="op">$</span><span class="va">xcoef</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>             [,1]    [,2]   [,3]    [,4]
numeracy    0.011  0.0636 -0.020 -0.0152
energy_use  0.025 -0.0251  0.045 -0.0695
energy_save 0.022  0.0099  0.016  0.0788
els_score   0.015 -0.0372 -0.058  0.0074</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cca_res</span><span class="op">$</span><span class="va">ycoef</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                       [,1]   [,2]    [,3]
env_attitude          0.025 -0.041 -0.0792
perceived_difficulty -0.029  0.027 -0.0535
pol_conservatism     -0.020 -0.040 -0.0041</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Hypothetical model: </span></span>
<span><span class="co">#   - latent Knowledge from numeracy, energy_use, energy_save, els_score</span></span>
<span><span class="co">#   - latent Motivation from env_attitude, perceived_difficulty</span></span>
<span><span class="co">#   - regression: Knowledge ~ Motivation</span></span>
<span></span>
<span><span class="va">sem_model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  Knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span><span class="st">  Motivation =~ env_attitude + perceived_difficulty</span></span>
<span><span class="st">  Knowledge ~ Motivation</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_sem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">sem_model</span>, data <span class="op">=</span> <span class="va">combined_scores</span>, missing <span class="op">=</span> <span class="st">"fiml"</span><span class="op">)</span>  <span class="co"># handle missing if needed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_sem</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 32 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        19

  Number of observations                           287
  Number of missing patterns                         1

Model Test User Model:
                                                      
  Test statistic                                13.787
  Degrees of freedom                                 8
  P-value (Chi-square)                           0.087

Model Test Baseline Model:

  Test statistic                               509.961
  Degrees of freedom                                15
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.988
  Tucker-Lewis Index (TLI)                       0.978
                                                      
  Robust Comparative Fit Index (CFI)             0.988
  Robust Tucker-Lewis Index (TLI)                0.978

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -2114.488
  Loglikelihood unrestricted model (H1)      -2107.595
                                                      
  Akaike (AIC)                                4266.977
  Bayesian (BIC)                              4336.507
  Sample-size adjusted Bayesian (SABIC)       4276.256

Root Mean Square Error of Approximation:

  RMSEA                                          0.050
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.094
  P-value H_0: RMSEA &lt;= 0.050                    0.441
  P-value H_0: RMSEA &gt;= 0.080                    0.145
                                                      
  Robust RMSEA                                   0.050
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.094
  P-value H_0: Robust RMSEA &lt;= 0.050             0.441
  P-value H_0: Robust RMSEA &gt;= 0.080             0.145

Standardized Root Mean Square Residual:

  SRMR                                           0.028

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Knowledge =~                                                          
    numeracy          1.000                               0.542    0.543
    energy_use        1.623    0.181    8.970    0.000    0.880    0.882
    energy_save       1.441    0.163    8.822    0.000    0.782    0.783
    els_score         1.088    0.142    7.658    0.000    0.590    0.591
  Motivation =~                                                         
    env_attitude      1.000                               0.499    0.655
    percvd_dffclty   -1.377    0.225   -6.113    0.000   -0.687   -0.688

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Knowledge ~                                                           
    Motivation        0.663    0.124    5.343    0.000    0.609    0.609

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .numeracy          0.000    0.059    0.000    1.000    0.000    0.000
   .energy_use       -0.000    0.059   -0.000    1.000   -0.000   -0.000
   .energy_save      -0.000    0.059   -0.000    1.000   -0.000   -0.000
   .els_score         0.000    0.059    0.000    1.000    0.000    0.000
   .env_attitude      3.591    0.045   79.917    0.000    3.591    4.717
   .percvd_dffclty    0.000    0.059    0.000    1.000    0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .numeracy          0.702    0.063   11.084    0.000    0.702    0.705
   .energy_use        0.222    0.044    5.007    0.000    0.222    0.223
   .energy_save       0.386    0.045    8.535    0.000    0.386    0.387
   .els_score         0.649    0.060   10.831    0.000    0.649    0.651
   .env_attitude      0.331    0.047    7.032    0.000    0.331    0.571
   .percvd_dffclty    0.525    0.084    6.213    0.000    0.525    0.526
   .Knowledge         0.185    0.044    4.215    0.000    0.629    0.629
    Motivation        0.249    0.055    4.523    0.000    1.000    1.000</code></pre>
</div>
</div>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/tegorman13\.github\.io\/Survey_Study\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="./cors1.html" class="pagination-link" aria-label="Instrument Correlations_1">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Instrument Correlations_1</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./org.html" class="pagination-link" aria-label="Organization">
        <span class="nav-page-text">Organization</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb135" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Knowledge &amp; Motivation Correlations-2"</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a><span class="co">    grid:</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a><span class="co">      sidebar-width: 220px</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a><span class="co">      body-width: 1200px</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a><span class="co">      margin-width: 170px</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a><span class="co">      gutter-width: 1.0rem</span></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a><span class="co">  hugo-md:</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a><span class="co">    include: true</span></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a><span class="co">    html-math-method: mathjax</span></span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a><span class="co">    output-file: cor_hugo2.md</span></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a><span class="co">  # pdf: </span></span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a><span class="co">  #   documentclass: article</span></span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a><span class="co">  #   papersize: letter</span></span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a><span class="co">  #   toc: false</span></span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a><span class="co">  #   fontsize: 10pt</span></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a><span class="co">  #   linestretch: 1.5</span></span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a><span class="co">  #   geometry:</span></span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a><span class="co">  #     - top=.5in     </span></span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a><span class="co">  #     - bottom=.5in  </span></span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a><span class="co">  #     - left=.5in    </span></span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a><span class="co">  #     - right=.25in  </span></span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a><span class="co">  #     - heightrounded</span></span>
<span id="cb135-29"><a href="#cb135-29" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb135-30"><a href="#cb135-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-31"><a href="#cb135-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-32"><a href="#cb135-32" aria-hidden="true" tabindex="-1"></a>This study set out to assess how prior survey instruments on sustainable behaviors, knowledge, and attitudes correlate.Many studies on environmental behavior measure people's motivation to show sustainable behavior and classify them as being highly or lowly motivated, and their knowledge about what the right behavior would look like. An example would be recycling.</span>
<span id="cb135-33"><a href="#cb135-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-34"><a href="#cb135-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-35"><a href="#cb135-35" aria-hidden="true" tabindex="-1"></a><span class="fu"># Read data </span></span>
<span id="cb135-36"><a href="#cb135-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-39"><a href="#cb135-39" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-40"><a href="#cb135-40" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr,purrr,tidyr,here, haven,tibble,ggplot2,ggh4x,lme4,knitr,kableExtra,gt,pander,flextable,ggh4x,psych,corrplot,factoextra)</span>
<span id="cb135-41"><a href="#cb135-41" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">2</span>, <span class="at">scipen=</span><span class="dv">999</span>, <span class="at">dplyr.summarise.inform=</span><span class="cn">FALSE</span>)</span>
<span id="cb135-42"><a href="#cb135-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-43"><a href="#cb135-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb135-44"><a href="#cb135-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb135-45"><a href="#cb135-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb135-46"><a href="#cb135-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb135-47"><a href="#cb135-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CCA)</span>
<span id="cb135-48"><a href="#cb135-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qgraph)</span>
<span id="cb135-49"><a href="#cb135-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb135-50"><a href="#cb135-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb135-51"><a href="#cb135-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclust)</span>
<span id="cb135-52"><a href="#cb135-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyLPA)</span>
<span id="cb135-53"><a href="#cb135-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-54"><a href="#cb135-54" aria-hidden="true" tabindex="-1"></a>select <span class="ot">=</span> dplyr<span class="sc">::</span>select</span>
<span id="cb135-55"><a href="#cb135-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-56"><a href="#cb135-56" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>,<span class="st">"survey_functions.R"</span>))</span>
<span id="cb135-57"><a href="#cb135-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-58"><a href="#cb135-58" aria-hidden="true" tabindex="-1"></a>draw <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"draw.rds"</span>))</span>
<span id="cb135-59"><a href="#cb135-59" aria-hidden="true" tabindex="-1"></a><span class="co">#dinst &lt;- readRDS(here("data","dinst.rds"))</span></span>
<span id="cb135-60"><a href="#cb135-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-61"><a href="#cb135-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Attari Energy Survey (Part 1)</span></span>
<span id="cb135-62"><a href="#cb135-62" aria-hidden="true" tabindex="-1"></a>aes1 <span class="ot">&lt;-</span> draw <span class="sc">|&gt;</span> <span class="fu">select</span>(id,ATT01<span class="sc">:</span>ATT18)</span>
<span id="cb135-63"><a href="#cb135-63" aria-hidden="true" tabindex="-1"></a><span class="co">#aes2 &lt;- dinst |&gt; select(id,ATT01:ATT18)</span></span>
<span id="cb135-64"><a href="#cb135-64" aria-hidden="true" tabindex="-1"></a>aes_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(aes1)</span>
<span id="cb135-65"><a href="#cb135-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-66"><a href="#cb135-66" aria-hidden="true" tabindex="-1"></a>att_useSave <span class="ot">&lt;-</span> draw <span class="sc">|&gt;</span> <span class="fu">select</span>(id,ATT19<span class="sc">:</span>ATT33)</span>
<span id="cb135-67"><a href="#cb135-67" aria-hidden="true" tabindex="-1"></a><span class="co">#att_useSave2 &lt;- dinst |&gt; select(id,ATT19:ATT33)</span></span>
<span id="cb135-68"><a href="#cb135-68" aria-hidden="true" tabindex="-1"></a>att2_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(att_useSave)</span>
<span id="cb135-69"><a href="#cb135-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-70"><a href="#cb135-70" aria-hidden="true" tabindex="-1"></a>els1 <span class="ot">&lt;-</span> draw <span class="sc">|&gt;</span> <span class="fu">select</span>(id,ELS01<span class="sc">:</span>ELS08)</span>
<span id="cb135-71"><a href="#cb135-71" aria-hidden="true" tabindex="-1"></a><span class="co">#els2 &lt;- dinst |&gt; select(id,ELS01:ELS08)</span></span>
<span id="cb135-72"><a href="#cb135-72" aria-hidden="true" tabindex="-1"></a>els <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(els1)</span>
<span id="cb135-73"><a href="#cb135-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-74"><a href="#cb135-74" aria-hidden="true" tabindex="-1"></a>rs1 <span class="ot">&lt;-</span> draw <span class="sc">|&gt;</span> <span class="fu">select</span>(id,RS01<span class="sc">:</span>RS06)</span>
<span id="cb135-75"><a href="#cb135-75" aria-hidden="true" tabindex="-1"></a><span class="co">#rs2 &lt;- dinst |&gt; select(id,RS01:RS06)</span></span>
<span id="cb135-76"><a href="#cb135-76" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(rs1)</span>
<span id="cb135-77"><a href="#cb135-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-78"><a href="#cb135-78" aria-hidden="true" tabindex="-1"></a>attari1 <span class="ot">&lt;-</span> <span class="fu">analyze_attari_survey_part1</span>(aes_combined)</span>
<span id="cb135-79"><a href="#cb135-79" aria-hidden="true" tabindex="-1"></a>attari2_scores <span class="ot">&lt;-</span> <span class="fu">analyze_attari_survey</span>(att2_combined)</span>
<span id="cb135-80"><a href="#cb135-80" aria-hidden="true" tabindex="-1"></a>els_scores <span class="ot">&lt;-</span> <span class="fu">analyze_els_survey</span>(els)</span>
<span id="cb135-81"><a href="#cb135-81" aria-hidden="true" tabindex="-1"></a>rs_scores <span class="ot">&lt;-</span> <span class="fu">analyze_recycling_survey</span>(rs)</span>
<span id="cb135-82"><a href="#cb135-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-83"><a href="#cb135-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all scores into one dataframe</span></span>
<span id="cb135-84"><a href="#cb135-84" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> attari1 <span class="sc">%&gt;%</span></span>
<span id="cb135-85"><a href="#cb135-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(attari2_scores, <span class="at">by=</span><span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-86"><a href="#cb135-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(els_scores, <span class="at">by=</span><span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-87"><a href="#cb135-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(rs_scores, <span class="at">by=</span><span class="st">"id"</span>)</span>
<span id="cb135-88"><a href="#cb135-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-89"><a href="#cb135-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for clarity</span></span>
<span id="cb135-90"><a href="#cb135-90" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(combined_scores) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"perceived_difficulty"</span>, <span class="st">"numeracy"</span>, </span>
<span id="cb135-91"><a href="#cb135-91" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, </span>
<span id="cb135-92"><a href="#cb135-92" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"els_accuracy"</span>, <span class="st">"els_score"</span>,</span>
<span id="cb135-93"><a href="#cb135-93" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"env_attitude"</span>, <span class="st">"env_attitude_z"</span>,</span>
<span id="cb135-94"><a href="#cb135-94" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"pol_conservatism"</span>, <span class="st">"pol_conservatism_z"</span>)</span>
<span id="cb135-95"><a href="#cb135-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-96"><a href="#cb135-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-97"><a href="#cb135-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-98"><a href="#cb135-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-99"><a href="#cb135-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-100"><a href="#cb135-100" aria-hidden="true" tabindex="-1"></a><span class="fu"># preview data</span></span>
<span id="cb135-101"><a href="#cb135-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-104"><a href="#cb135-104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-105"><a href="#cb135-105" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>() <span class="sc">|&gt;</span> <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, <span class="at">full_width =</span> F)</span>
<span id="cb135-106"><a href="#cb135-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-107"><a href="#cb135-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-108"><a href="#cb135-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-109"><a href="#cb135-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-110"><a href="#cb135-110" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1a</span></span>
<span id="cb135-111"><a href="#cb135-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-112"><a href="#cb135-112" aria-hidden="true" tabindex="-1"></a> <span class="in">```{r}</span></span>
<span id="cb135-113"><a href="#cb135-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-114"><a href="#cb135-114" aria-hidden="true" tabindex="-1"></a> <span class="co"># 1. Cluster Analysis</span></span>
<span id="cb135-115"><a href="#cb135-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-116"><a href="#cb135-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for clustering (select relevant variables and scale)</span></span>
<span id="cb135-117"><a href="#cb135-117" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-118"><a href="#cb135-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(perceived_difficulty, numeracy, energy_use, energy_save, els_score, env_attitude_z, pol_conservatism_z) <span class="sc">%&gt;%</span></span>
<span id="cb135-119"><a href="#cb135-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-120"><a href="#cb135-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb135-121"><a href="#cb135-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-122"><a href="#cb135-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine optimal number of clusters using the elbow method</span></span>
<span id="cb135-123"><a href="#cb135-123" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>) <span class="sc">+</span></span>
<span id="cb135-124"><a href="#cb135-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Elbow Method for Optimal k"</span>, <span class="at">x =</span> <span class="st">"Number of Clusters k"</span>)</span>
<span id="cb135-125"><a href="#cb135-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-126"><a href="#cb135-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-127"><a href="#cb135-127" aria-hidden="true" tabindex="-1"></a> <span class="in">```</span></span>
<span id="cb135-128"><a href="#cb135-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-129"><a href="#cb135-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-130"><a href="#cb135-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-133"><a href="#cb135-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-134"><a href="#cb135-134" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform k-means clustering (e.g., with 3 clusters)</span></span>
<span id="cb135-135"><a href="#cb135-135" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb135-136"><a href="#cb135-136" aria-hidden="true" tabindex="-1"></a>km_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb135-137"><a href="#cb135-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-138"><a href="#cb135-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the clusters</span></span>
<span id="cb135-139"><a href="#cb135-139" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_result, <span class="at">data =</span> cluster_data,</span>
<span id="cb135-140"><a href="#cb135-140" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb135-141"><a href="#cb135-141" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"convex"</span>,</span>
<span id="cb135-142"><a href="#cb135-142" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb135-143"><a href="#cb135-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clustering of Subjects"</span>)</span>
<span id="cb135-144"><a href="#cb135-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-145"><a href="#cb135-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-146"><a href="#cb135-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-147"><a href="#cb135-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-150"><a href="#cb135-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-151"><a href="#cb135-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster assignments to the main dataframe</span></span>
<span id="cb135-152"><a href="#cb135-152" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(km_result<span class="sc">$</span>cluster)</span>
<span id="cb135-153"><a href="#cb135-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-154"><a href="#cb135-154" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Enhanced Factor Analysis</span></span>
<span id="cb135-155"><a href="#cb135-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-156"><a href="#cb135-156" aria-hidden="true" tabindex="-1"></a><span class="co"># Scree plot to determine the number of factors</span></span>
<span id="cb135-157"><a href="#cb135-157" aria-hidden="true" tabindex="-1"></a>fa_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-158"><a href="#cb135-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(perceived_difficulty, numeracy, energy_use, energy_save, els_score, env_attitude_z, pol_conservatism_z) <span class="sc">%&gt;%</span></span>
<span id="cb135-159"><a href="#cb135-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb135-160"><a href="#cb135-160" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(fa_data)</span>
<span id="cb135-161"><a href="#cb135-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-162"><a href="#cb135-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-163"><a href="#cb135-163" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform factor analysis with, e.g., 3 factors</span></span>
<span id="cb135-164"><a href="#cb135-164" aria-hidden="true" tabindex="-1"></a>fa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(fa_data, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)</span>
<span id="cb135-165"><a href="#cb135-165" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result, <span class="at">cut =</span> <span class="fl">0.3</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-166"><a href="#cb135-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-167"><a href="#cb135-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-168"><a href="#cb135-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-169"><a href="#cb135-169" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Enhanced Regression Models</span></span>
<span id="cb135-170"><a href="#cb135-170" aria-hidden="true" tabindex="-1"></a><span class="co"># Model predicting ELS from motivation, controlling for other knowledge scores</span></span>
<span id="cb135-171"><a href="#cb135-171" aria-hidden="true" tabindex="-1"></a>model_els_enhanced <span class="ot">&lt;-</span> <span class="fu">lm</span>(els_score <span class="sc">~</span> perceived_difficulty <span class="sc">+</span> env_attitude_z <span class="sc">+</span> pol_conservatism_z <span class="sc">+</span></span>
<span id="cb135-172"><a href="#cb135-172" aria-hidden="true" tabindex="-1"></a>                           numeracy <span class="sc">+</span> energy_use <span class="sc">+</span> energy_save, <span class="at">data =</span> combined_scores)</span>
<span id="cb135-173"><a href="#cb135-173" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_els_enhanced)</span>
<span id="cb135-174"><a href="#cb135-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-175"><a href="#cb135-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-176"><a href="#cb135-176" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Interaction Effects in Regression</span></span>
<span id="cb135-177"><a href="#cb135-177" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Interaction between environmental attitude and perceived difficulty on ELS</span></span>
<span id="cb135-178"><a href="#cb135-178" aria-hidden="true" tabindex="-1"></a>model_interaction <span class="ot">&lt;-</span> <span class="fu">lm</span>(els_score <span class="sc">~</span> perceived_difficulty <span class="sc">*</span> env_attitude_z, <span class="at">data =</span> combined_scores)</span>
<span id="cb135-179"><a href="#cb135-179" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_interaction)</span>
<span id="cb135-180"><a href="#cb135-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-181"><a href="#cb135-181" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the interaction (example)</span></span>
<span id="cb135-182"><a href="#cb135-182" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_scores, <span class="fu">aes</span>(<span class="at">x =</span> perceived_difficulty, <span class="at">y =</span> els_score, <span class="at">color =</span> env_attitude_z)) <span class="sc">+</span></span>
<span id="cb135-183"><a href="#cb135-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb135-184"><a href="#cb135-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb135-185"><a href="#cb135-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb135-186"><a href="#cb135-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interaction of Perceived Difficulty and Environmental Attitude on ELS"</span>,</span>
<span id="cb135-187"><a href="#cb135-187" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Perceived Difficulty"</span>,</span>
<span id="cb135-188"><a href="#cb135-188" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Energy Literacy Score"</span>) <span class="sc">+</span></span>
<span id="cb135-189"><a href="#cb135-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-190"><a href="#cb135-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-191"><a href="#cb135-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-192"><a href="#cb135-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-193"><a href="#cb135-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-194"><a href="#cb135-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-195"><a href="#cb135-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-196"><a href="#cb135-196" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2a</span></span>
<span id="cb135-197"><a href="#cb135-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-200"><a href="#cb135-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-201"><a href="#cb135-201" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb135-202"><a href="#cb135-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb135-203"><a href="#cb135-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-204"><a href="#cb135-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-205"><a href="#cb135-205" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> attari1 <span class="sc">%&gt;%</span></span>
<span id="cb135-206"><a href="#cb135-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(attari2_scores, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-207"><a href="#cb135-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(els_scores,       <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-208"><a href="#cb135-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(rs_scores,        <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb135-209"><a href="#cb135-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-210"><a href="#cb135-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-211"><a href="#cb135-211" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create knowledge profiles using cluster analysis</span></span>
<span id="cb135-212"><a href="#cb135-212" aria-hidden="true" tabindex="-1"></a>knowledge_vars <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span> </span>
<span id="cb135-213"><a href="#cb135-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy_score, relative_energy_use_score, </span>
<span id="cb135-214"><a href="#cb135-214" aria-hidden="true" tabindex="-1"></a>         relative_energy_save_score, els)</span>
<span id="cb135-215"><a href="#cb135-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-216"><a href="#cb135-216" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb135-217"><a href="#cb135-217" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(<span class="fu">scale</span>(knowledge_vars), <span class="at">centers=</span><span class="dv">3</span>)</span>
<span id="cb135-218"><a href="#cb135-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-219"><a href="#cb135-219" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster membership to data</span></span>
<span id="cb135-220"><a href="#cb135-220" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>knowledge_cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(clusters<span class="sc">$</span>cluster)</span>
<span id="cb135-221"><a href="#cb135-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-222"><a href="#cb135-222" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare motivation scores across clusters</span></span>
<span id="cb135-223"><a href="#cb135-223" aria-hidden="true" tabindex="-1"></a>cluster_comparison <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb135-224"><a href="#cb135-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(knowledge_cluster) <span class="sc">%&gt;%</span></span>
<span id="cb135-225"><a href="#cb135-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb135-226"><a href="#cb135-226" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_env_attitude =</span> <span class="fu">mean</span>(env_attitude, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-227"><a href="#cb135-227" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_difficulty =</span> <span class="fu">mean</span>(perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-228"><a href="#cb135-228" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-229"><a href="#cb135-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-230"><a href="#cb135-230" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Test for non-linear relationships</span></span>
<span id="cb135-231"><a href="#cb135-231" aria-hidden="true" tabindex="-1"></a>gam_model <span class="ot">&lt;-</span> <span class="fu">gam</span>(els <span class="sc">~</span> <span class="fu">s</span>(env_attitude) <span class="sc">+</span> <span class="fu">s</span>(perceived_difficulty_score), </span>
<span id="cb135-232"><a href="#cb135-232" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>combined_df)</span>
<span id="cb135-233"><a href="#cb135-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-234"><a href="#cb135-234" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Create interaction model between knowledge and motivation</span></span>
<span id="cb135-235"><a href="#cb135-235" aria-hidden="true" tabindex="-1"></a>interaction_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(els <span class="sc">~</span> env_attitude <span class="sc">*</span> perceived_difficulty_score <span class="sc">+</span> </span>
<span id="cb135-236"><a href="#cb135-236" aria-hidden="true" tabindex="-1"></a>                         numeracy_score, <span class="at">data=</span>combined_df)</span>
<span id="cb135-237"><a href="#cb135-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-238"><a href="#cb135-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-239"><a href="#cb135-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-240"><a href="#cb135-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-241"><a href="#cb135-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-242"><a href="#cb135-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-243"><a href="#cb135-243" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Enhanced Correlation Plot</span></span>
<span id="cb135-244"><a href="#cb135-244" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb135-245"><a href="#cb135-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy_score, relative_energy_use_score, </span>
<span id="cb135-246"><a href="#cb135-246" aria-hidden="true" tabindex="-1"></a>         relative_energy_save_score, els, </span>
<span id="cb135-247"><a href="#cb135-247" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty_score, env_attitude, </span>
<span id="cb135-248"><a href="#cb135-248" aria-hidden="true" tabindex="-1"></a>         pol_conservatism_z) <span class="sc">%&gt;%</span></span>
<span id="cb135-249"><a href="#cb135-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb135-250"><a href="#cb135-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-251"><a href="#cb135-251" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, </span>
<span id="cb135-252"><a href="#cb135-252" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> <span class="st">"color"</span>,</span>
<span id="cb135-253"><a href="#cb135-253" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb135-254"><a href="#cb135-254" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">"black"</span>,</span>
<span id="cb135-255"><a href="#cb135-255" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb135-256"><a href="#cb135-256" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb135-257"><a href="#cb135-257" aria-hidden="true" tabindex="-1"></a>         <span class="at">diag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb135-258"><a href="#cb135-258" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span>))(<span class="dv">200</span>))</span>
<span id="cb135-259"><a href="#cb135-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-260"><a href="#cb135-260" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Knowledge Profile Clustering</span></span>
<span id="cb135-261"><a href="#cb135-261" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize knowledge variables</span></span>
<span id="cb135-262"><a href="#cb135-262" aria-hidden="true" tabindex="-1"></a>knowledge_vars <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb135-263"><a href="#cb135-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy_score, relative_energy_use_score, </span>
<span id="cb135-264"><a href="#cb135-264" aria-hidden="true" tabindex="-1"></a>         relative_energy_save_score, els) <span class="sc">%&gt;%</span></span>
<span id="cb135-265"><a href="#cb135-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb135-266"><a href="#cb135-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-267"><a href="#cb135-267" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine optimal number of clusters</span></span>
<span id="cb135-268"><a href="#cb135-268" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb135-269"><a href="#cb135-269" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(k) {</span>
<span id="cb135-270"><a href="#cb135-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kmeans</span>(knowledge_vars, <span class="at">centers=</span>k)<span class="sc">$</span>tot.withinss</span>
<span id="cb135-271"><a href="#cb135-271" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb135-272"><a href="#cb135-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-273"><a href="#cb135-273" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform k-means clustering</span></span>
<span id="cb135-274"><a href="#cb135-274" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># Based on elbow plot inspection</span></span>
<span id="cb135-275"><a href="#cb135-275" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(knowledge_vars, <span class="at">centers=</span>k)</span>
<span id="cb135-276"><a href="#cb135-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-277"><a href="#cb135-277" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster membership to data</span></span>
<span id="cb135-278"><a href="#cb135-278" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>knowledge_cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(clusters<span class="sc">$</span>cluster)</span>
<span id="cb135-279"><a href="#cb135-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-280"><a href="#cb135-280" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize clusters</span></span>
<span id="cb135-281"><a href="#cb135-281" aria-hidden="true" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(knowledge_vars)</span>
<span id="cb135-282"><a href="#cb135-282" aria-hidden="true" tabindex="-1"></a>cluster_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb135-283"><a href="#cb135-283" aria-hidden="true" tabindex="-1"></a>  <span class="at">PC1 =</span> pca_result<span class="sc">$</span>x[,<span class="dv">1</span>],</span>
<span id="cb135-284"><a href="#cb135-284" aria-hidden="true" tabindex="-1"></a>  <span class="at">PC2 =</span> pca_result<span class="sc">$</span>x[,<span class="dv">2</span>],</span>
<span id="cb135-285"><a href="#cb135-285" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cluster =</span> combined_df<span class="sc">$</span>knowledge_cluster</span>
<span id="cb135-286"><a href="#cb135-286" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb135-287"><a href="#cb135-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-288"><a href="#cb135-288" aria-hidden="true" tabindex="-1"></a><span class="co"># Create cluster visualization</span></span>
<span id="cb135-289"><a href="#cb135-289" aria-hidden="true" tabindex="-1"></a>p_clusters <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cluster_df, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">color=</span>Cluster)) <span class="sc">+</span></span>
<span id="cb135-290"><a href="#cb135-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb135-291"><a href="#cb135-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb135-292"><a href="#cb135-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Knowledge Profiles Clustering"</span>,</span>
<span id="cb135-293"><a href="#cb135-293" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"First Principal Component"</span>,</span>
<span id="cb135-294"><a href="#cb135-294" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Second Principal Component"</span>)</span>
<span id="cb135-295"><a href="#cb135-295" aria-hidden="true" tabindex="-1"></a>p_clusters</span>
<span id="cb135-296"><a href="#cb135-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-297"><a href="#cb135-297" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Non-linear GAM Analysis</span></span>
<span id="cb135-298"><a href="#cb135-298" aria-hidden="true" tabindex="-1"></a>gam_model <span class="ot">&lt;-</span> <span class="fu">gam</span>(els <span class="sc">~</span> <span class="fu">s</span>(env_attitude) <span class="sc">+</span> <span class="fu">s</span>(perceived_difficulty_score), </span>
<span id="cb135-299"><a href="#cb135-299" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>combined_df)</span>
<span id="cb135-300"><a href="#cb135-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-301"><a href="#cb135-301" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction grid for GAM visualization</span></span>
<span id="cb135-302"><a href="#cb135-302" aria-hidden="true" tabindex="-1"></a>env_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(combined_df<span class="sc">$</span>env_attitude, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-303"><a href="#cb135-303" aria-hidden="true" tabindex="-1"></a>                <span class="fu">max</span>(combined_df<span class="sc">$</span>env_attitude, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-304"><a href="#cb135-304" aria-hidden="true" tabindex="-1"></a>                <span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb135-305"><a href="#cb135-305" aria-hidden="true" tabindex="-1"></a>diff_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(combined_df<span class="sc">$</span>perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-306"><a href="#cb135-306" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">max</span>(combined_df<span class="sc">$</span>perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-307"><a href="#cb135-307" aria-hidden="true" tabindex="-1"></a>                 <span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb135-308"><a href="#cb135-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-309"><a href="#cb135-309" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict ELS scores</span></span>
<span id="cb135-310"><a href="#cb135-310" aria-hidden="true" tabindex="-1"></a>pred_env <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_model, </span>
<span id="cb135-311"><a href="#cb135-311" aria-hidden="true" tabindex="-1"></a>                   <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">env_attitude=</span>env_grid,</span>
<span id="cb135-312"><a href="#cb135-312" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">perceived_difficulty_score=</span><span class="fu">mean</span>(combined_df<span class="sc">$</span>perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span>
<span id="cb135-313"><a href="#cb135-313" aria-hidden="true" tabindex="-1"></a>pred_diff <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_model,</span>
<span id="cb135-314"><a href="#cb135-314" aria-hidden="true" tabindex="-1"></a>                    <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">perceived_difficulty_score=</span>diff_grid,</span>
<span id="cb135-315"><a href="#cb135-315" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">env_attitude=</span><span class="fu">mean</span>(combined_df<span class="sc">$</span>env_attitude, <span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span>
<span id="cb135-316"><a href="#cb135-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-317"><a href="#cb135-317" aria-hidden="true" tabindex="-1"></a><span class="co"># Create GAM plots</span></span>
<span id="cb135-318"><a href="#cb135-318" aria-hidden="true" tabindex="-1"></a>p_gam_env <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb135-319"><a href="#cb135-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>env_grid, <span class="at">y=</span>pred_env), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb135-320"><a href="#cb135-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>combined_df, <span class="fu">aes</span>(<span class="at">x=</span>env_attitude, <span class="at">y=</span>els), <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb135-321"><a href="#cb135-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb135-322"><a href="#cb135-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Non-linear Relationship: Environmental Attitude and Energy Literacy"</span>,</span>
<span id="cb135-323"><a href="#cb135-323" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Environmental Attitude"</span>,</span>
<span id="cb135-324"><a href="#cb135-324" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Energy Literacy Score"</span>)</span>
<span id="cb135-325"><a href="#cb135-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-326"><a href="#cb135-326" aria-hidden="true" tabindex="-1"></a>p_gam_diff <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb135-327"><a href="#cb135-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>diff_grid, <span class="at">y=</span>pred_diff), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb135-328"><a href="#cb135-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>combined_df, <span class="fu">aes</span>(<span class="at">x=</span>perceived_difficulty_score, <span class="at">y=</span>els), <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb135-329"><a href="#cb135-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb135-330"><a href="#cb135-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Non-linear Relationship: Perceived Difficulty and Energy Literacy"</span>,</span>
<span id="cb135-331"><a href="#cb135-331" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Perceived Difficulty Score"</span>,</span>
<span id="cb135-332"><a href="#cb135-332" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Energy Literacy Score"</span>)</span>
<span id="cb135-333"><a href="#cb135-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-334"><a href="#cb135-334" aria-hidden="true" tabindex="-1"></a><span class="co">#p_gam_diff</span></span>
<span id="cb135-335"><a href="#cb135-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-336"><a href="#cb135-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-337"><a href="#cb135-337" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Knowledge-Motivation Interaction Analysis</span></span>
<span id="cb135-338"><a href="#cb135-338" aria-hidden="true" tabindex="-1"></a>interaction_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(els <span class="sc">~</span> env_attitude <span class="sc">*</span> perceived_difficulty_score <span class="sc">+</span> </span>
<span id="cb135-339"><a href="#cb135-339" aria-hidden="true" tabindex="-1"></a>                         numeracy_score, <span class="at">data=</span>combined_df)</span>
<span id="cb135-340"><a href="#cb135-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-341"><a href="#cb135-341" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interaction_model)</span>
<span id="cb135-342"><a href="#cb135-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-343"><a href="#cb135-343" aria-hidden="true" tabindex="-1"></a><span class="co"># Create interaction plot data</span></span>
<span id="cb135-344"><a href="#cb135-344" aria-hidden="true" tabindex="-1"></a>env_levels <span class="ot">&lt;-</span> <span class="fu">quantile</span>(combined_df<span class="sc">$</span>env_attitude, <span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-345"><a href="#cb135-345" aria-hidden="true" tabindex="-1"></a>diff_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(combined_df<span class="sc">$</span>perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-346"><a href="#cb135-346" aria-hidden="true" tabindex="-1"></a>                <span class="fu">max</span>(combined_df<span class="sc">$</span>perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-347"><a href="#cb135-347" aria-hidden="true" tabindex="-1"></a>                <span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb135-348"><a href="#cb135-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-349"><a href="#cb135-349" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange all plots</span></span>
<span id="cb135-350"><a href="#cb135-350" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p_clusters, p_gam_env, p_gam_diff, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb135-351"><a href="#cb135-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-352"><a href="#cb135-352" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical summaries</span></span>
<span id="cb135-353"><a href="#cb135-353" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gam_model)</span>
<span id="cb135-354"><a href="#cb135-354" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interaction_model)</span>
<span id="cb135-355"><a href="#cb135-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-356"><a href="#cb135-356" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster profile analysis</span></span>
<span id="cb135-357"><a href="#cb135-357" aria-hidden="true" tabindex="-1"></a>cluster_profiles <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb135-358"><a href="#cb135-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(knowledge_cluster) <span class="sc">%&gt;%</span></span>
<span id="cb135-359"><a href="#cb135-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb135-360"><a href="#cb135-360" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_numeracy =</span> <span class="fu">mean</span>(numeracy_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-361"><a href="#cb135-361" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_energy_use =</span> <span class="fu">mean</span>(relative_energy_use_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-362"><a href="#cb135-362" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_energy_save =</span> <span class="fu">mean</span>(relative_energy_save_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-363"><a href="#cb135-363" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_els =</span> <span class="fu">mean</span>(els, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-364"><a href="#cb135-364" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_env_attitude =</span> <span class="fu">mean</span>(env_attitude, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-365"><a href="#cb135-365" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_difficulty =</span> <span class="fu">mean</span>(perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-366"><a href="#cb135-366" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb135-367"><a href="#cb135-367" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-368"><a href="#cb135-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-369"><a href="#cb135-369" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cluster_profiles)</span>
<span id="cb135-370"><a href="#cb135-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-371"><a href="#cb135-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-372"><a href="#cb135-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-373"><a href="#cb135-373" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb135-374"><a href="#cb135-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-375"><a href="#cb135-375" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3a</span></span>
<span id="cb135-376"><a href="#cb135-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-379"><a href="#cb135-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-380"><a href="#cb135-380" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: K-means clustering on knowledge + motivation</span></span>
<span id="cb135-381"><a href="#cb135-381" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset your knowledge &amp; motivation columns</span></span>
<span id="cb135-382"><a href="#cb135-382" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb135-383"><a href="#cb135-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy_score, relative_energy_use_score, relative_energy_save_score,</span>
<span id="cb135-384"><a href="#cb135-384" aria-hidden="true" tabindex="-1"></a>         els, perceived_difficulty_score, env_attitude, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb135-385"><a href="#cb135-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb135-386"><a href="#cb135-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-387"><a href="#cb135-387" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale them</span></span>
<span id="cb135-388"><a href="#cb135-388" aria-hidden="true" tabindex="-1"></a>cluster_data_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(cluster_data)</span>
<span id="cb135-389"><a href="#cb135-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-390"><a href="#cb135-390" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide on number of clusters (e.g. 2â€“5) â€“ use e.g. Elbow method</span></span>
<span id="cb135-391"><a href="#cb135-391" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data_scaled, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>)</span>
<span id="cb135-392"><a href="#cb135-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-393"><a href="#cb135-393" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose we choose 3 clusters as a demonstration</span></span>
<span id="cb135-394"><a href="#cb135-394" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb135-395"><a href="#cb135-395" aria-hidden="true" tabindex="-1"></a>km_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data_scaled, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb135-396"><a href="#cb135-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-397"><a href="#cb135-397" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster membership back into the original data</span></span>
<span id="cb135-398"><a href="#cb135-398" aria-hidden="true" tabindex="-1"></a>cluster_data<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(km_result<span class="sc">$</span>cluster)</span>
<span id="cb135-399"><a href="#cb135-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-400"><a href="#cb135-400" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize clusters in 2D (using PCA behind the scenes)</span></span>
<span id="cb135-401"><a href="#cb135-401" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_result, <span class="at">data =</span> cluster_data_scaled,</span>
<span id="cb135-402"><a href="#cb135-402" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">ellipse.type =</span> <span class="st">"convex"</span>) <span class="sc">+</span></span>
<span id="cb135-403"><a href="#cb135-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb135-404"><a href="#cb135-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clusters of Knowledge &amp; Motivation Variables"</span>)</span>
<span id="cb135-405"><a href="#cb135-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-406"><a href="#cb135-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-407"><a href="#cb135-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-408"><a href="#cb135-408" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Grab relevant variables</span></span>
<span id="cb135-409"><a href="#cb135-409" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb135-410"><a href="#cb135-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy_score, relative_energy_use_score, relative_energy_save_score,</span>
<span id="cb135-411"><a href="#cb135-411" aria-hidden="true" tabindex="-1"></a>         els, perceived_difficulty_score, env_attitude, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb135-412"><a href="#cb135-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb135-413"><a href="#cb135-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-414"><a href="#cb135-414" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Standardize/scale them</span></span>
<span id="cb135-415"><a href="#cb135-415" aria-hidden="true" tabindex="-1"></a>cluster_data_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(cluster_data)</span>
<span id="cb135-416"><a href="#cb135-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-417"><a href="#cb135-417" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Determine the optimal number of clusters (Elbow or Silhouette methods)</span></span>
<span id="cb135-418"><a href="#cb135-418" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data_scaled, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>) <span class="sc">+</span></span>
<span id="cb135-419"><a href="#cb135-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-420"><a href="#cb135-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-421"><a href="#cb135-421" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Run k-means with your chosen number of clusters (say k = 3)</span></span>
<span id="cb135-422"><a href="#cb135-422" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb135-423"><a href="#cb135-423" aria-hidden="true" tabindex="-1"></a>km_res <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data_scaled, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb135-424"><a href="#cb135-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-425"><a href="#cb135-425" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Visualize</span></span>
<span id="cb135-426"><a href="#cb135-426" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_res, <span class="at">data =</span> cluster_data_scaled,</span>
<span id="cb135-427"><a href="#cb135-427" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">ellipse.type =</span> <span class="st">"convex"</span>) <span class="sc">+</span></span>
<span id="cb135-428"><a href="#cb135-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb135-429"><a href="#cb135-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clusters of Knowledge &amp; Motivation Variables"</span>)</span>
<span id="cb135-430"><a href="#cb135-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-431"><a href="#cb135-431" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Inspect cluster means</span></span>
<span id="cb135-432"><a href="#cb135-432" aria-hidden="true" tabindex="-1"></a>cluster_centers <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(km_res<span class="sc">$</span>centers)</span>
<span id="cb135-433"><a href="#cb135-433" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cluster_centers) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(cluster_data)</span>
<span id="cb135-434"><a href="#cb135-434" aria-hidden="true" tabindex="-1"></a>cluster_centers</span>
<span id="cb135-435"><a href="#cb135-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-436"><a href="#cb135-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-437"><a href="#cb135-437" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb135-438"><a href="#cb135-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-441"><a href="#cb135-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-442"><a href="#cb135-442" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb135-443"><a href="#cb135-443" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb135-444"><a href="#cb135-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-445"><a href="#cb135-445" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of hierarchical clustering if that is preferred</span></span>
<span id="cb135-446"><a href="#cb135-446" aria-hidden="true" tabindex="-1"></a>dist_mat <span class="ot">&lt;-</span> <span class="fu">dist</span>(cluster_data_scaled, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb135-447"><a href="#cb135-447" aria-hidden="true" tabindex="-1"></a>hc_res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist_mat, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb135-448"><a href="#cb135-448" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc_res, <span class="at">main =</span> <span class="st">"Dendrogram of Hierarchical Clustering"</span>)</span>
<span id="cb135-449"><a href="#cb135-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-450"><a href="#cb135-450" aria-hidden="true" tabindex="-1"></a><span class="co"># Cut tree at chosen k</span></span>
<span id="cb135-451"><a href="#cb135-451" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc_res, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb135-452"><a href="#cb135-452" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clusters)</span>
<span id="cb135-453"><a href="#cb135-453" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-454"><a href="#cb135-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-455"><a href="#cb135-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-458"><a href="#cb135-458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-459"><a href="#cb135-459" aria-hidden="true" tabindex="-1"></a><span class="co"># Example mediation: knowledge -&gt; perceived_difficulty -&gt; env_attitude</span></span>
<span id="cb135-460"><a href="#cb135-460" aria-hidden="true" tabindex="-1"></a>model_mediation <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb135-461"><a href="#cb135-461" aria-hidden="true" tabindex="-1"></a><span class="st">  # direct effect</span></span>
<span id="cb135-462"><a href="#cb135-462" aria-hidden="true" tabindex="-1"></a><span class="st">  env_attitude ~ c*els</span></span>
<span id="cb135-463"><a href="#cb135-463" aria-hidden="true" tabindex="-1"></a><span class="st">  # mediator</span></span>
<span id="cb135-464"><a href="#cb135-464" aria-hidden="true" tabindex="-1"></a><span class="st">  perceived_difficulty_score ~ a*els</span></span>
<span id="cb135-465"><a href="#cb135-465" aria-hidden="true" tabindex="-1"></a><span class="st">  env_attitude ~ b*perceived_difficulty_score</span></span>
<span id="cb135-466"><a href="#cb135-466" aria-hidden="true" tabindex="-1"></a><span class="st">  # indirect effect</span></span>
<span id="cb135-467"><a href="#cb135-467" aria-hidden="true" tabindex="-1"></a><span class="st">  ab := a*b</span></span>
<span id="cb135-468"><a href="#cb135-468" aria-hidden="true" tabindex="-1"></a><span class="st">  # total effect</span></span>
<span id="cb135-469"><a href="#cb135-469" aria-hidden="true" tabindex="-1"></a><span class="st">  total := c + (a*b)</span></span>
<span id="cb135-470"><a href="#cb135-470" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb135-471"><a href="#cb135-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-472"><a href="#cb135-472" aria-hidden="true" tabindex="-1"></a>fit_mediation <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_mediation, <span class="at">data =</span> combined_df, <span class="at">missing=</span><span class="st">"fiml"</span>)</span>
<span id="cb135-473"><a href="#cb135-473" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_mediation, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized=</span><span class="cn">TRUE</span>, <span class="at">rsquare=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-474"><a href="#cb135-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-475"><a href="#cb135-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-476"><a href="#cb135-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-477"><a href="#cb135-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-478"><a href="#cb135-478" aria-hidden="true" tabindex="-1"></a>----</span>
<span id="cb135-479"><a href="#cb135-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-480"><a href="#cb135-480" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb135-481"><a href="#cb135-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-482"><a href="#cb135-482" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4a</span></span>
<span id="cb135-483"><a href="#cb135-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-486"><a href="#cb135-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-487"><a href="#cb135-487" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb135-488"><a href="#cb135-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb135-489"><a href="#cb135-489" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Example composite for knowledge: average of (z-scored) numeracy, </span></span>
<span id="cb135-490"><a href="#cb135-490" aria-hidden="true" tabindex="-1"></a>    <span class="co"># energy_use, energy_save, ELS. </span></span>
<span id="cb135-491"><a href="#cb135-491" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (You can also sum them, but average is convenient.)</span></span>
<span id="cb135-492"><a href="#cb135-492" aria-hidden="true" tabindex="-1"></a>    <span class="at">composite_knowledge =</span> <span class="fu">rowMeans</span>(</span>
<span id="cb135-493"><a href="#cb135-493" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(numeracy_score, relative_energy_use_score, </span>
<span id="cb135-494"><a href="#cb135-494" aria-hidden="true" tabindex="-1"></a>            relative_energy_save_score, els),</span>
<span id="cb135-495"><a href="#cb135-495" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">FALSE</span>  <span class="co"># If a row has missing for any item, result = NA</span></span>
<span id="cb135-496"><a href="#cb135-496" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb135-497"><a href="#cb135-497" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb135-498"><a href="#cb135-498" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Example composite for motivation: </span></span>
<span id="cb135-499"><a href="#cb135-499" aria-hidden="true" tabindex="-1"></a>    <span class="co"># env_attitude might be already in a favorable direction, but if </span></span>
<span id="cb135-500"><a href="#cb135-500" aria-hidden="true" tabindex="-1"></a>    <span class="co"># perceived_difficulty is "difficulty," consider reversing so that </span></span>
<span id="cb135-501"><a href="#cb135-501" aria-hidden="true" tabindex="-1"></a>    <span class="co"># higher = "less difficulty" = "higher motivation."</span></span>
<span id="cb135-502"><a href="#cb135-502" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For example: reverse_diff = (-1)*perceived_difficulty_score</span></span>
<span id="cb135-503"><a href="#cb135-503" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Then average with env_attitude (if you want them combined).</span></span>
<span id="cb135-504"><a href="#cb135-504" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If you are including pol_conservatism as well, you must decide </span></span>
<span id="cb135-505"><a href="#cb135-505" aria-hidden="true" tabindex="-1"></a>    <span class="co"># how to handle that in the composite. Possibly reverse-coded </span></span>
<span id="cb135-506"><a href="#cb135-506" aria-hidden="true" tabindex="-1"></a>    <span class="co"># so that higher # = more liberal or more "pro-environment" stance. </span></span>
<span id="cb135-507"><a href="#cb135-507" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (It's your theoretical call.)</span></span>
<span id="cb135-508"><a href="#cb135-508" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb135-509"><a href="#cb135-509" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For now, let's do a small composite with environmental attitude </span></span>
<span id="cb135-510"><a href="#cb135-510" aria-hidden="true" tabindex="-1"></a>    <span class="co"># and reversed difficulty:</span></span>
<span id="cb135-511"><a href="#cb135-511" aria-hidden="true" tabindex="-1"></a>    <span class="at">reverse_diff =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> perceived_difficulty_score,</span>
<span id="cb135-512"><a href="#cb135-512" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb135-513"><a href="#cb135-513" aria-hidden="true" tabindex="-1"></a>    <span class="at">composite_motivation =</span> <span class="fu">rowMeans</span>(</span>
<span id="cb135-514"><a href="#cb135-514" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(env_attitude, reverse_diff), </span>
<span id="cb135-515"><a href="#cb135-515" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">FALSE</span></span>
<span id="cb135-516"><a href="#cb135-516" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb135-517"><a href="#cb135-517" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-518"><a href="#cb135-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-519"><a href="#cb135-519" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll create a small data frame with just the two composites, </span></span>
<span id="cb135-520"><a href="#cb135-520" aria-hidden="true" tabindex="-1"></a><span class="co"># removing any incomplete cases</span></span>
<span id="cb135-521"><a href="#cb135-521" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-522"><a href="#cb135-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(composite_knowledge, composite_motivation) <span class="sc">%&gt;%</span></span>
<span id="cb135-523"><a href="#cb135-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb135-524"><a href="#cb135-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-525"><a href="#cb135-525" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide on number of clusters "k". Letâ€™s try k = 3:</span></span>
<span id="cb135-526"><a href="#cb135-526" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb135-527"><a href="#cb135-527" aria-hidden="true" tabindex="-1"></a>km3 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb135-528"><a href="#cb135-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-529"><a href="#cb135-529" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect results</span></span>
<span id="cb135-530"><a href="#cb135-530" aria-hidden="true" tabindex="-1"></a>km3</span>
<span id="cb135-531"><a href="#cb135-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-532"><a href="#cb135-532" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb135-533"><a href="#cb135-533" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km3, <span class="at">data =</span> cluster_data,</span>
<span id="cb135-534"><a href="#cb135-534" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">ellipse.type =</span> <span class="st">"convex"</span>) <span class="sc">+</span></span>
<span id="cb135-535"><a href="#cb135-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb135-536"><a href="#cb135-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means (k=3) Clustering on Knowledge vs. Motivation"</span>)</span>
<span id="cb135-537"><a href="#cb135-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-538"><a href="#cb135-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-539"><a href="#cb135-539" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(km3<span class="sc">$</span>cluster)</span>
<span id="cb135-540"><a href="#cb135-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-541"><a href="#cb135-541" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare mean knowledge &amp; motivation by cluster</span></span>
<span id="cb135-542"><a href="#cb135-542" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-543"><a href="#cb135-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb135-544"><a href="#cb135-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb135-545"><a href="#cb135-545" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb135-546"><a href="#cb135-546" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_knowledge =</span> <span class="fu">mean</span>(composite_knowledge, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb135-547"><a href="#cb135-547" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_motivation =</span> <span class="fu">mean</span>(composite_motivation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-548"><a href="#cb135-548" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb135-549"><a href="#cb135-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-550"><a href="#cb135-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-551"><a href="#cb135-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-552"><a href="#cb135-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-553"><a href="#cb135-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-554"><a href="#cb135-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-555"><a href="#cb135-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-556"><a href="#cb135-556" aria-hidden="true" tabindex="-1"></a>-------</span>
<span id="cb135-557"><a href="#cb135-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-558"><a href="#cb135-558" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb135-559"><a href="#cb135-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-560"><a href="#cb135-560" aria-hidden="true" tabindex="-1"></a><span class="fu"># 5a</span></span>
<span id="cb135-561"><a href="#cb135-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-564"><a href="#cb135-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-565"><a href="#cb135-565" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb135-566"><a href="#cb135-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb135-567"><a href="#cb135-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-568"><a href="#cb135-568" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> attari1 <span class="sc">%&gt;%</span></span>
<span id="cb135-569"><a href="#cb135-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(attari2_scores, <span class="at">by=</span><span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-570"><a href="#cb135-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(els_scores, <span class="at">by=</span><span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-571"><a href="#cb135-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(rs_scores, <span class="at">by=</span><span class="st">"id"</span>)</span>
<span id="cb135-572"><a href="#cb135-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-573"><a href="#cb135-573" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for clarity</span></span>
<span id="cb135-574"><a href="#cb135-574" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(combined_scores) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"perceived_difficulty"</span>, <span class="st">"numeracy"</span>, </span>
<span id="cb135-575"><a href="#cb135-575" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, </span>
<span id="cb135-576"><a href="#cb135-576" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"els_accuracy"</span>, <span class="st">"els_score"</span>,</span>
<span id="cb135-577"><a href="#cb135-577" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"env_attitude"</span>, <span class="st">"env_attitude_z"</span>,</span>
<span id="cb135-578"><a href="#cb135-578" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"pol_conservatism"</span>, <span class="st">"pol_conservatism_z"</span>)</span>
<span id="cb135-579"><a href="#cb135-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-580"><a href="#cb135-580" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(km_result<span class="sc">$</span>cluster)</span>
<span id="cb135-581"><a href="#cb135-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-582"><a href="#cb135-582" aria-hidden="true" tabindex="-1"></a><span class="co"># Create composite knowledge score</span></span>
<span id="cb135-583"><a href="#cb135-583" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>composite_knowledge <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(combined_scores[, <span class="fu">c</span>(<span class="st">"numeracy"</span>, <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, <span class="st">"els_score"</span>)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-584"><a href="#cb135-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-585"><a href="#cb135-585" aria-hidden="true" tabindex="-1"></a><span class="co"># Create standardized scores for profile analysis</span></span>
<span id="cb135-586"><a href="#cb135-586" aria-hidden="true" tabindex="-1"></a>profile_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-587"><a href="#cb135-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, cluster, numeracy, energy_use, energy_save, </span>
<span id="cb135-588"><a href="#cb135-588" aria-hidden="true" tabindex="-1"></a>         els_score, env_attitude, perceived_difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb135-589"><a href="#cb135-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(measure, value, <span class="sc">-</span>id, <span class="sc">-</span>cluster) <span class="sc">%&gt;%</span></span>
<span id="cb135-590"><a href="#cb135-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(measure) <span class="sc">%&gt;%</span></span>
<span id="cb135-591"><a href="#cb135-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_score =</span> <span class="fu">scale</span>(value)[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb135-592"><a href="#cb135-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb135-593"><a href="#cb135-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-594"><a href="#cb135-594" aria-hidden="true" tabindex="-1"></a><span class="co"># Create profile plot</span></span>
<span id="cb135-595"><a href="#cb135-595" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(profile_data, <span class="fu">aes</span>(<span class="at">x =</span> measure, <span class="at">y =</span> z_score, <span class="at">color =</span> cluster, <span class="at">group =</span> cluster)) <span class="sc">+</span></span>
<span id="cb135-596"><a href="#cb135-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb135-597"><a href="#cb135-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb135-598"><a href="#cb135-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb135-599"><a href="#cb135-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb135-600"><a href="#cb135-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb135-601"><a href="#cb135-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Knowledge-Motivation Profiles by Cluster"</span>,</span>
<span id="cb135-602"><a href="#cb135-602" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Measure"</span>, <span class="at">y =</span> <span class="st">"Standardized Score"</span>)</span>
<span id="cb135-603"><a href="#cb135-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-604"><a href="#cb135-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-605"><a href="#cb135-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-606"><a href="#cb135-606" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Canonical Correlation Analysis between Knowledge and Motivation Sets</span></span>
<span id="cb135-607"><a href="#cb135-607" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare matrices</span></span>
<span id="cb135-608"><a href="#cb135-608" aria-hidden="true" tabindex="-1"></a>knowledge_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span> <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score) <span class="sc">%&gt;%</span></span>
<span id="cb135-609"><a href="#cb135-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb135-610"><a href="#cb135-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-611"><a href="#cb135-611" aria-hidden="true" tabindex="-1"></a>motivation_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-612"><a href="#cb135-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(env_attitude, perceived_difficulty, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb135-613"><a href="#cb135-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb135-614"><a href="#cb135-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-615"><a href="#cb135-615" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform CCA</span></span>
<span id="cb135-616"><a href="#cb135-616" aria-hidden="true" tabindex="-1"></a>cc_result <span class="ot">&lt;-</span> <span class="fu">cancor</span>(knowledge_vars, motivation_vars)</span>
<span id="cb135-617"><a href="#cb135-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-618"><a href="#cb135-618" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Network Analysis to Visualize Variable Relationships</span></span>
<span id="cb135-619"><a href="#cb135-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-620"><a href="#cb135-620" aria-hidden="true" tabindex="-1"></a><span class="co"># Create correlation matrix</span></span>
<span id="cb135-621"><a href="#cb135-621" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-622"><a href="#cb135-622" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score,</span>
<span id="cb135-623"><a href="#cb135-623" aria-hidden="true" tabindex="-1"></a>                         env_attitude, perceived_difficulty, pol_conservatism),</span>
<span id="cb135-624"><a href="#cb135-624" aria-hidden="true" tabindex="-1"></a>                 <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb135-625"><a href="#cb135-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-626"><a href="#cb135-626" aria-hidden="true" tabindex="-1"></a><span class="co"># Create network plot</span></span>
<span id="cb135-627"><a href="#cb135-627" aria-hidden="true" tabindex="-1"></a><span class="fu">qgraph</span>(cor_matrix, </span>
<span id="cb135-628"><a href="#cb135-628" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"spring"</span>,</span>
<span id="cb135-629"><a href="#cb135-629" aria-hidden="true" tabindex="-1"></a>       <span class="at">groups =</span> <span class="fu">list</span>(<span class="at">Knowledge =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">Motivation =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb135-630"><a href="#cb135-630" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"lightblue"</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">"lightgreen"</span>, <span class="dv">3</span>)))</span>
<span id="cb135-631"><a href="#cb135-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-632"><a href="#cb135-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-633"><a href="#cb135-633" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Mixed Effects Model to Account for Potential Group-Level Effects</span></span>
<span id="cb135-634"><a href="#cb135-634" aria-hidden="true" tabindex="-1"></a>mixed_model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(els_score <span class="sc">~</span> env_attitude <span class="sc">+</span> perceived_difficulty <span class="sc">+</span> </span>
<span id="cb135-635"><a href="#cb135-635" aria-hidden="true" tabindex="-1"></a>                     (<span class="dv">1</span><span class="sc">|</span>cluster), <span class="at">data =</span> combined_scores)</span>
<span id="cb135-636"><a href="#cb135-636" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mixed_model)</span>
<span id="cb135-637"><a href="#cb135-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-638"><a href="#cb135-638" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Structural Equation Model for Path Analysis</span></span>
<span id="cb135-639"><a href="#cb135-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-640"><a href="#cb135-640" aria-hidden="true" tabindex="-1"></a><span class="co"># Define model</span></span>
<span id="cb135-641"><a href="#cb135-641" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb135-642"><a href="#cb135-642" aria-hidden="true" tabindex="-1"></a><span class="st">  # Measurement model</span></span>
<span id="cb135-643"><a href="#cb135-643" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span id="cb135-644"><a href="#cb135-644" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation =~ env_attitude + perceived_difficulty + pol_conservatism</span></span>
<span id="cb135-645"><a href="#cb135-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-646"><a href="#cb135-646" aria-hidden="true" tabindex="-1"></a><span class="st">  # Structural model</span></span>
<span id="cb135-647"><a href="#cb135-647" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge ~ motivation</span></span>
<span id="cb135-648"><a href="#cb135-648" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb135-649"><a href="#cb135-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-650"><a href="#cb135-650" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb135-651"><a href="#cb135-651" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">data =</span> combined_scores)</span>
<span id="cb135-652"><a href="#cb135-652" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-653"><a href="#cb135-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-654"><a href="#cb135-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-655"><a href="#cb135-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-656"><a href="#cb135-656" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Classification Tree for Predicting Knowledge Levels - rpart functions</span></span>
<span id="cb135-657"><a href="#cb135-657" aria-hidden="true" tabindex="-1"></a><span class="co"># Create binary knowledge indicator (high/low) based on median split</span></span>
<span id="cb135-658"><a href="#cb135-658" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>knowledge_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(combined_scores<span class="sc">$</span>composite_knowledge <span class="sc">&gt;</span> </span>
<span id="cb135-659"><a href="#cb135-659" aria-hidden="true" tabindex="-1"></a>                                               <span class="fu">median</span>(combined_scores<span class="sc">$</span>composite_knowledge, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb135-660"><a href="#cb135-660" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"High"</span>, <span class="st">"Low"</span>))</span>
<span id="cb135-661"><a href="#cb135-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-662"><a href="#cb135-662" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit tree</span></span>
<span id="cb135-663"><a href="#cb135-663" aria-hidden="true" tabindex="-1"></a>tree_model <span class="ot">&lt;-</span> <span class="fu">rpart</span>(knowledge_level <span class="sc">~</span> env_attitude <span class="sc">+</span> perceived_difficulty <span class="sc">+</span> </span>
<span id="cb135-664"><a href="#cb135-664" aria-hidden="true" tabindex="-1"></a>                     pol_conservatism, <span class="at">data =</span> combined_scores)</span>
<span id="cb135-665"><a href="#cb135-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-666"><a href="#cb135-666" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot tree</span></span>
<span id="cb135-667"><a href="#cb135-667" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree_model, <span class="at">extra =</span> <span class="dv">1</span>)</span>
<span id="cb135-668"><a href="#cb135-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-669"><a href="#cb135-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-670"><a href="#cb135-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-671"><a href="#cb135-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-672"><a href="#cb135-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-673"><a href="#cb135-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-674"><a href="#cb135-674" aria-hidden="true" tabindex="-1"></a>--------</span>
<span id="cb135-675"><a href="#cb135-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-676"><a href="#cb135-676" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb135-677"><a href="#cb135-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-678"><a href="#cb135-678" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1b</span></span>
<span id="cb135-679"><a href="#cb135-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-682"><a href="#cb135-682" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-683"><a href="#cb135-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb135-684"><a href="#cb135-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb135-685"><a href="#cb135-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-686"><a href="#cb135-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-687"><a href="#cb135-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-688"><a href="#cb135-688" aria-hidden="true" tabindex="-1"></a>lpa_model <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(cluster_data_scaled)</span>
<span id="cb135-689"><a href="#cb135-689" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lpa_model)</span>
<span id="cb135-690"><a href="#cb135-690" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lpa_model, <span class="st">"BIC"</span>)</span>
<span id="cb135-691"><a href="#cb135-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-692"><a href="#cb135-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-693"><a href="#cb135-693" aria-hidden="true" tabindex="-1"></a>can_cor <span class="ot">&lt;-</span> <span class="fu">cancor</span>(<span class="fu">select</span>(combined_scores, numeracy, energy_use, energy_save),</span>
<span id="cb135-694"><a href="#cb135-694" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">select</span>(combined_scores, env_attitude_z, perceived_difficulty))</span>
<span id="cb135-695"><a href="#cb135-695" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(can_cor<span class="sc">$</span>cor)</span>
<span id="cb135-696"><a href="#cb135-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-697"><a href="#cb135-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-698"><a href="#cb135-698" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data_scaled, cluster<span class="sc">::</span>pam, <span class="at">method =</span> <span class="st">"silhouette"</span>) <span class="sc">+</span></span>
<span id="cb135-699"><a href="#cb135-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Silhouette Method for Optimal k"</span>)</span>
<span id="cb135-700"><a href="#cb135-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-701"><a href="#cb135-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-702"><a href="#cb135-702" aria-hidden="true" tabindex="-1"></a>sem_model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb135-703"><a href="#cb135-703" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge =~ numeracy + energy_use + energy_save + els_accuracy</span></span>
<span id="cb135-704"><a href="#cb135-704" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation =~ env_attitude_z + perceived_difficulty</span></span>
<span id="cb135-705"><a href="#cb135-705" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge ~ motivation</span></span>
<span id="cb135-706"><a href="#cb135-706" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb135-707"><a href="#cb135-707" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(sem_model, <span class="at">data =</span> combined_scores)</span>
<span id="cb135-708"><a href="#cb135-708" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-709"><a href="#cb135-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-710"><a href="#cb135-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-711"><a href="#cb135-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-712"><a href="#cb135-712" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-713"><a href="#cb135-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb135-714"><a href="#cb135-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(numeracy, env_attitude_z), </span>
<span id="cb135-715"><a href="#cb135-715" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">sd =</span> sd)))</span>
<span id="cb135-716"><a href="#cb135-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-717"><a href="#cb135-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-718"><a href="#cb135-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-719"><a href="#cb135-719" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lpa_model, <span class="st">"BIC"</span>) <span class="co"># Visualize model selection</span></span>
<span id="cb135-720"><a href="#cb135-720" aria-hidden="true" tabindex="-1"></a>lpa_3class <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(cluster_data_scaled, <span class="at">G=</span><span class="dv">3</span>) <span class="co"># Force 3-class solution</span></span>
<span id="cb135-721"><a href="#cb135-721" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lpa_3class, <span class="at">parameters=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-722"><a href="#cb135-722" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lpa_3class, <span class="at">what=</span><span class="st">"classification"</span>) <span class="co"># Visualize classification</span></span>
<span id="cb135-723"><a href="#cb135-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-724"><a href="#cb135-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-725"><a href="#cb135-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-726"><a href="#cb135-726" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Interpret canonical variables</span></span>
<span id="cb135-727"><a href="#cb135-727" aria-hidden="true" tabindex="-1"></a>cancor_loadings <span class="ot">&lt;-</span> can_cor<span class="sc">$</span>xcoef <span class="sc">%&gt;%</span> </span>
<span id="cb135-728"><a href="#cb135-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-729"><a href="#cb135-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-730"><a href="#cb135-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Dimension1=</span>V1, <span class="at">Dimension2=</span>V2, <span class="at">Dimension3=</span>V3)</span>
<span id="cb135-731"><a href="#cb135-731" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cancor_loadings)</span>
<span id="cb135-732"><a href="#cb135-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-733"><a href="#cb135-733" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Improve SEM specification</span></span>
<span id="cb135-734"><a href="#cb135-734" aria-hidden="true" tabindex="-1"></a>sem_improved <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb135-735"><a href="#cb135-735" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge =~ numeracy + energy_use + energy_save + els_accuracy</span></span>
<span id="cb135-736"><a href="#cb135-736" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation =~ env_attitude_z + perceived_difficulty</span></span>
<span id="cb135-737"><a href="#cb135-737" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge ~ motivation</span></span>
<span id="cb135-738"><a href="#cb135-738" aria-hidden="true" tabindex="-1"></a><span class="st">  els_accuracy ~~ energy_use # Add residual covariance</span></span>
<span id="cb135-739"><a href="#cb135-739" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb135-740"><a href="#cb135-740" aria-hidden="true" tabindex="-1"></a>fit_improved <span class="ot">&lt;-</span> <span class="fu">sem</span>(sem_improved, <span class="at">data=</span>combined_scores)</span>
<span id="cb135-741"><a href="#cb135-741" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_improved, <span class="at">fit.measures=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-742"><a href="#cb135-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-743"><a href="#cb135-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-744"><a href="#cb135-744" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Validate clusters with outcomes</span></span>
<span id="cb135-745"><a href="#cb135-745" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-746"><a href="#cb135-746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb135-747"><a href="#cb135-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">recycling_rate =</span> <span class="fu">mean</span>(env_attitude_z, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-748"><a href="#cb135-748" aria-hidden="true" tabindex="-1"></a>            <span class="at">energy_behavior =</span> <span class="fu">mean</span>(energy_save, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb135-749"><a href="#cb135-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>cluster, <span class="at">names_to=</span><span class="st">"outcome"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-750"><a href="#cb135-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>cluster, <span class="at">y=</span>value, <span class="at">fill=</span>outcome)) <span class="sc">+</span></span>
<span id="cb135-751"><a href="#cb135-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb135-752"><a href="#cb135-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Cluster Validation Through Behavioral Outcomes"</span>)</span>
<span id="cb135-753"><a href="#cb135-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-754"><a href="#cb135-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-755"><a href="#cb135-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-756"><a href="#cb135-756" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb135-757"><a href="#cb135-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-758"><a href="#cb135-758" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2b</span></span>
<span id="cb135-759"><a href="#cb135-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-760"><a href="#cb135-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-763"><a href="#cb135-763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-764"><a href="#cb135-764" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb135-765"><a href="#cb135-765" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb135-766"><a href="#cb135-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-767"><a href="#cb135-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-768"><a href="#cb135-768" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all items into a single dataframe</span></span>
<span id="cb135-769"><a href="#cb135-769" aria-hidden="true" tabindex="-1"></a>all_items <span class="ot">&lt;-</span> <span class="fu">full_join</span>(aes_combined, att2_combined, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-770"><a href="#cb135-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(els, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-771"><a href="#cb135-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(rs, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb135-772"><a href="#cb135-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-773"><a href="#cb135-773" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only item columns for factor analysis</span></span>
<span id="cb135-774"><a href="#cb135-774" aria-hidden="true" tabindex="-1"></a>item_columns <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(all_items), <span class="st">"id"</span>)</span>
<span id="cb135-775"><a href="#cb135-775" aria-hidden="true" tabindex="-1"></a>item_data <span class="ot">&lt;-</span> all_items[, item_columns]</span>
<span id="cb135-776"><a href="#cb135-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-777"><a href="#cb135-777" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform factor analysis</span></span>
<span id="cb135-778"><a href="#cb135-778" aria-hidden="true" tabindex="-1"></a>fa_items <span class="ot">&lt;-</span> <span class="fu">fa</span>(item_data, <span class="at">nfactors =</span> <span class="dv">5</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)  <span class="co"># Adjust nfactors as needed</span></span>
<span id="cb135-779"><a href="#cb135-779" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_items, <span class="at">cut =</span> <span class="fl">0.3</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-780"><a href="#cb135-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-781"><a href="#cb135-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-782"><a href="#cb135-782" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb135-783"><a href="#cb135-783" aria-hidden="true" tabindex="-1"></a><span class="st">  # Measurement model</span></span>
<span id="cb135-784"><a href="#cb135-784" aria-hidden="true" tabindex="-1"></a><span class="st">  Knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span id="cb135-785"><a href="#cb135-785" aria-hidden="true" tabindex="-1"></a><span class="st">  Motivation =~ env_attitude_z + perceived_difficulty</span></span>
<span id="cb135-786"><a href="#cb135-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-787"><a href="#cb135-787" aria-hidden="true" tabindex="-1"></a><span class="st">  # Structural model</span></span>
<span id="cb135-788"><a href="#cb135-788" aria-hidden="true" tabindex="-1"></a><span class="st">  Knowledge ~ Motivation</span></span>
<span id="cb135-789"><a href="#cb135-789" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb135-790"><a href="#cb135-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-791"><a href="#cb135-791" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">data =</span> combined_scores)</span>
<span id="cb135-792"><a href="#cb135-792" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-793"><a href="#cb135-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-794"><a href="#cb135-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-795"><a href="#cb135-795" aria-hidden="true" tabindex="-1"></a><span class="co"># Example LPA (using tidyLPA)</span></span>
<span id="cb135-796"><a href="#cb135-796" aria-hidden="true" tabindex="-1"></a>lpa_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-797"><a href="#cb135-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score, env_attitude_z, perceived_difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb135-798"><a href="#cb135-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb135-799"><a href="#cb135-799" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert all to numeric</span></span>
<span id="cb135-800"><a href="#cb135-800" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(as.numeric)</span>
<span id="cb135-801"><a href="#cb135-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-802"><a href="#cb135-802" aria-hidden="true" tabindex="-1"></a>lpa_results <span class="ot">&lt;-</span> lpa_data <span class="sc">%&gt;%</span></span>
<span id="cb135-803"><a href="#cb135-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">estimate_profiles</span>(<span class="at">n_profiles =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="co"># Estimate models with 1-5 profiles</span></span>
<span id="cb135-804"><a href="#cb135-804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compare_solutions</span>(<span class="at">statistics =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>))</span>
<span id="cb135-805"><a href="#cb135-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-806"><a href="#cb135-806" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lpa_results)</span>
<span id="cb135-807"><a href="#cb135-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-808"><a href="#cb135-808" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine optimal k using silhouette method</span></span>
<span id="cb135-809"><a href="#cb135-809" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data_scaled, kmeans, <span class="at">method =</span> <span class="st">"silhouette"</span>) <span class="sc">+</span></span>
<span id="cb135-810"><a href="#cb135-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Silhouette Method for Optimal k"</span>)</span>
<span id="cb135-811"><a href="#cb135-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-812"><a href="#cb135-812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-813"><a href="#cb135-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-814"><a href="#cb135-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-815"><a href="#cb135-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-816"><a href="#cb135-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-817"><a href="#cb135-817" aria-hidden="true" tabindex="-1"></a>-----</span>
<span id="cb135-818"><a href="#cb135-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-819"><a href="#cb135-819" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3b</span></span>
<span id="cb135-820"><a href="#cb135-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-823"><a href="#cb135-823" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-824"><a href="#cb135-824" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 11</span></span>
<span id="cb135-825"><a href="#cb135-825" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb135-826"><a href="#cb135-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-827"><a href="#cb135-827" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Create a correlation matrix of the key knowledge &amp; motivation subscales</span></span>
<span id="cb135-828"><a href="#cb135-828" aria-hidden="true" tabindex="-1"></a><span class="co">#    ensuring no duplicates (e.g., pick either 'env_attitude' or 'env_attitude_z').</span></span>
<span id="cb135-829"><a href="#cb135-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-830"><a href="#cb135-830" aria-hidden="true" tabindex="-1"></a>cor_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-831"><a href="#cb135-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score,</span>
<span id="cb135-832"><a href="#cb135-832" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty, env_attitude, pol_conservatism)</span>
<span id="cb135-833"><a href="#cb135-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-834"><a href="#cb135-834" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Compute correlations</span></span>
<span id="cb135-835"><a href="#cb135-835" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(cor_vars, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb135-836"><a href="#cb135-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-837"><a href="#cb135-837" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Visualize</span></span>
<span id="cb135-838"><a href="#cb135-838" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">type=</span><span class="st">"upper"</span>, </span>
<span id="cb135-839"><a href="#cb135-839" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.col=</span><span class="st">"black"</span>, <span class="at">addCoef.col=</span><span class="st">"black"</span>)</span>
<span id="cb135-840"><a href="#cb135-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-841"><a href="#cb135-841" aria-hidden="true" tabindex="-1"></a>fa_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-842"><a href="#cb135-842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score,</span>
<span id="cb135-843"><a href="#cb135-843" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty, env_attitude, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb135-844"><a href="#cb135-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb135-845"><a href="#cb135-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-846"><a href="#cb135-846" aria-hidden="true" tabindex="-1"></a>fa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(fa_data, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"ml"</span>)</span>
<span id="cb135-847"><a href="#cb135-847" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result, <span class="at">cut=</span><span class="fl">0.3</span>, <span class="at">sort=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-848"><a href="#cb135-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-849"><a href="#cb135-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-850"><a href="#cb135-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-851"><a href="#cb135-851" aria-hidden="true" tabindex="-1"></a>model_motivation <span class="ot">&lt;-</span> <span class="fu">lm</span>(env_attitude <span class="sc">~</span> els_score <span class="sc">+</span> numeracy <span class="sc">+</span> pol_conservatism,</span>
<span id="cb135-852"><a href="#cb135-852" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data=</span>combined_scores)</span>
<span id="cb135-853"><a href="#cb135-853" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_motivation)</span>
<span id="cb135-854"><a href="#cb135-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-855"><a href="#cb135-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-856"><a href="#cb135-856" aria-hidden="true" tabindex="-1"></a>model_knowledge <span class="ot">&lt;-</span> <span class="fu">lm</span>(els_score <span class="sc">~</span> perceived_difficulty <span class="sc">+</span> env_attitude <span class="sc">+</span> pol_conservatism,</span>
<span id="cb135-857"><a href="#cb135-857" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data=</span>combined_scores)</span>
<span id="cb135-858"><a href="#cb135-858" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_knowledge)</span>
<span id="cb135-859"><a href="#cb135-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-860"><a href="#cb135-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-861"><a href="#cb135-861" aria-hidden="true" tabindex="-1"></a>knowledge_only <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-862"><a href="#cb135-862" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score) <span class="sc">%&gt;%</span></span>
<span id="cb135-863"><a href="#cb135-863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-864"><a href="#cb135-864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb135-865"><a href="#cb135-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-866"><a href="#cb135-866" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb135-867"><a href="#cb135-867" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide k with elbow or silhouette</span></span>
<span id="cb135-868"><a href="#cb135-868" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(knowledge_only, kmeans, <span class="at">method=</span><span class="st">"wss"</span>)</span>
<span id="cb135-869"><a href="#cb135-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-870"><a href="#cb135-870" aria-hidden="true" tabindex="-1"></a>km_knowl <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(knowledge_only, <span class="at">centers=</span><span class="dv">3</span>, <span class="at">nstart=</span><span class="dv">25</span>)</span>
<span id="cb135-871"><a href="#cb135-871" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_knowl, <span class="at">data =</span> knowledge_only)</span>
<span id="cb135-872"><a href="#cb135-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-873"><a href="#cb135-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-874"><a href="#cb135-874" aria-hidden="true" tabindex="-1"></a>all_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-875"><a href="#cb135-875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score,</span>
<span id="cb135-876"><a href="#cb135-876" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty, env_attitude, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb135-877"><a href="#cb135-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-878"><a href="#cb135-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb135-879"><a href="#cb135-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-880"><a href="#cb135-880" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb135-881"><a href="#cb135-881" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(all_vars, kmeans, <span class="at">method=</span><span class="st">"wss"</span>)</span>
<span id="cb135-882"><a href="#cb135-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-883"><a href="#cb135-883" aria-hidden="true" tabindex="-1"></a>km_all <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(all_vars, <span class="at">centers=</span><span class="dv">3</span>, <span class="at">nstart=</span><span class="dv">25</span>)</span>
<span id="cb135-884"><a href="#cb135-884" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_all, <span class="at">data=</span>all_vars)</span>
<span id="cb135-885"><a href="#cb135-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-886"><a href="#cb135-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-887"><a href="#cb135-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-888"><a href="#cb135-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-889"><a href="#cb135-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-890"><a href="#cb135-890" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb135-891"><a href="#cb135-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-892"><a href="#cb135-892" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4b</span></span>
<span id="cb135-893"><a href="#cb135-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-896"><a href="#cb135-896" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-897"><a href="#cb135-897" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 11</span></span>
<span id="cb135-898"><a href="#cb135-898" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb135-899"><a href="#cb135-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-900"><a href="#cb135-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-901"><a href="#cb135-901" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Summarize clusters on an extra measure</span></span>
<span id="cb135-902"><a href="#cb135-902" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-903"><a href="#cb135-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb135-904"><a href="#cb135-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb135-905"><a href="#cb135-905" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_recycling =</span> <span class="fu">mean</span>(env_attitude_z, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-906"><a href="#cb135-906" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_recycling   =</span> <span class="fu">sd</span>(env_attitude_z, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-907"><a href="#cb135-907" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb135-908"><a href="#cb135-908" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb135-909"><a href="#cb135-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(cluster)</span>
<span id="cb135-910"><a href="#cb135-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-911"><a href="#cb135-911" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. ANOVA to test whether clusters differ significantly </span></span>
<span id="cb135-912"><a href="#cb135-912" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(env_attitude_z <span class="sc">~</span> cluster, <span class="at">data =</span> combined_scores)</span>
<span id="cb135-913"><a href="#cb135-913" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span>
<span id="cb135-914"><a href="#cb135-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-915"><a href="#cb135-915" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Pairwise comparisons if ANOVA is significant</span></span>
<span id="cb135-916"><a href="#cb135-916" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb135-917"><a href="#cb135-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-918"><a href="#cb135-918" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data to knowledge &amp; motivation variables</span></span>
<span id="cb135-919"><a href="#cb135-919" aria-hidden="true" tabindex="-1"></a>lpa_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-920"><a href="#cb135-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score, </span>
<span id="cb135-921"><a href="#cb135-921" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty, env_attitude, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb135-922"><a href="#cb135-922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-923"><a href="#cb135-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb135-924"><a href="#cb135-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-925"><a href="#cb135-925" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-based clustering</span></span>
<span id="cb135-926"><a href="#cb135-926" aria-hidden="true" tabindex="-1"></a>lpa_model <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(lpa_data)</span>
<span id="cb135-927"><a href="#cb135-927" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lpa_model)  <span class="co"># Tells you how many clusters &amp; the type of covariance structure</span></span>
<span id="cb135-928"><a href="#cb135-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-929"><a href="#cb135-929" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract membership</span></span>
<span id="cb135-930"><a href="#cb135-930" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>LPA_cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(lpa_model<span class="sc">$</span>classification)</span>
<span id="cb135-931"><a href="#cb135-931" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(combined_scores<span class="sc">$</span>LPA_cluster)</span>
<span id="cb135-932"><a href="#cb135-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-933"><a href="#cb135-933" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare means across the new LPA-based clusters</span></span>
<span id="cb135-934"><a href="#cb135-934" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-935"><a href="#cb135-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LPA_cluster) <span class="sc">%&gt;%</span></span>
<span id="cb135-936"><a href="#cb135-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb135-937"><a href="#cb135-937" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(numeracy<span class="sc">:</span>pol_conservatism, mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-938"><a href="#cb135-938" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-939"><a href="#cb135-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-940"><a href="#cb135-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-941"><a href="#cb135-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-942"><a href="#cb135-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-943"><a href="#cb135-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-944"><a href="#cb135-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-945"><a href="#cb135-945" aria-hidden="true" tabindex="-1"></a>--------</span>
<span id="cb135-946"><a href="#cb135-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-947"><a href="#cb135-947" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb135-948"><a href="#cb135-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-949"><a href="#cb135-949" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1c</span></span>
<span id="cb135-950"><a href="#cb135-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-953"><a href="#cb135-953" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-954"><a href="#cb135-954" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all individual survey items from each instrument</span></span>
<span id="cb135-955"><a href="#cb135-955" aria-hidden="true" tabindex="-1"></a>all_items <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(aes_combined, att2_combined) <span class="sc">%&gt;%</span></span>
<span id="cb135-956"><a href="#cb135-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(els, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-957"><a href="#cb135-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(rs, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb135-958"><a href="#cb135-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-959"><a href="#cb135-959" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only item columns for analysis</span></span>
<span id="cb135-960"><a href="#cb135-960" aria-hidden="true" tabindex="-1"></a>item_data <span class="ot">&lt;-</span> all_items <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>id)</span>
<span id="cb135-961"><a href="#cb135-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-962"><a href="#cb135-962" aria-hidden="true" tabindex="-1"></a>subscale_cors <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-963"><a href="#cb135-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(perceived_difficulty, numeracy, energy_use, energy_save,</span>
<span id="cb135-964"><a href="#cb135-964" aria-hidden="true" tabindex="-1"></a>         els_score, env_attitude_z, pol_conservatism_z) <span class="sc">%&gt;%</span></span>
<span id="cb135-965"><a href="#cb135-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb135-966"><a href="#cb135-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-967"><a href="#cb135-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-968"><a href="#cb135-968" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Knowledge-Motivation Relationship Analyses</span></span>
<span id="cb135-969"><a href="#cb135-969" aria-hidden="true" tabindex="-1"></a><span class="co"># Create composite scores with explicit content alignment</span></span>
<span id="cb135-970"><a href="#cb135-970" aria-hidden="true" tabindex="-1"></a>knowledge_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"numeracy"</span>, <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, <span class="st">"els_score"</span>)</span>
<span id="cb135-971"><a href="#cb135-971" aria-hidden="true" tabindex="-1"></a>motivation_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"env_attitude_z"</span>, <span class="st">"perceived_difficulty"</span>)</span>
<span id="cb135-972"><a href="#cb135-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-973"><a href="#cb135-973" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-974"><a href="#cb135-974" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb135-975"><a href="#cb135-975" aria-hidden="true" tabindex="-1"></a>    <span class="at">knowledge =</span> <span class="fu">scale</span>(<span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">all_of</span>(knowledge_vars)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb135-976"><a href="#cb135-976" aria-hidden="true" tabindex="-1"></a>    <span class="at">motivation =</span> <span class="fu">scale</span>(<span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">all_of</span>(motivation_vars)) <span class="sc">*</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb135-977"><a href="#cb135-977" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-978"><a href="#cb135-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-979"><a href="#cb135-979" aria-hidden="true" tabindex="-1"></a><span class="co"># 3a. Bivariate Correlation</span></span>
<span id="cb135-980"><a href="#cb135-980" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(combined_scores, <span class="fu">cor.test</span>(knowledge, motivation))</span>
<span id="cb135-981"><a href="#cb135-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-982"><a href="#cb135-982" aria-hidden="true" tabindex="-1"></a><span class="co"># 3b. Hierarchical Regression</span></span>
<span id="cb135-983"><a href="#cb135-983" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(knowledge <span class="sc">~</span> motivation <span class="sc">+</span> pol_conservatism_z <span class="sc">+</span> cluster, </span>
<span id="cb135-984"><a href="#cb135-984" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> combined_scores)</span>
<span id="cb135-985"><a href="#cb135-985" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb135-986"><a href="#cb135-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-987"><a href="#cb135-987" aria-hidden="true" tabindex="-1"></a><span class="co"># 3c. Path Analysis</span></span>
<span id="cb135-988"><a href="#cb135-988" aria-hidden="true" tabindex="-1"></a>path_model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb135-989"><a href="#cb135-989" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation ~ a * knowledge</span></span>
<span id="cb135-990"><a href="#cb135-990" aria-hidden="true" tabindex="-1"></a><span class="st">  els_score ~ b * motivation + c * knowledge</span></span>
<span id="cb135-991"><a href="#cb135-991" aria-hidden="true" tabindex="-1"></a><span class="st">  indirect := a * b</span></span>
<span id="cb135-992"><a href="#cb135-992" aria-hidden="true" tabindex="-1"></a><span class="st">  total := c + indirect</span></span>
<span id="cb135-993"><a href="#cb135-993" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb135-994"><a href="#cb135-994" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(path_model, <span class="at">data =</span> combined_scores)</span>
<span id="cb135-995"><a href="#cb135-995" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-996"><a href="#cb135-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-997"><a href="#cb135-997" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Cluster Validation by Motivation-Knowledge Profiles</span></span>
<span id="cb135-998"><a href="#cb135-998" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_scores, <span class="fu">aes</span>(<span class="at">x =</span> knowledge, <span class="at">y =</span> motivation, <span class="at">color =</span> cluster)) <span class="sc">+</span></span>
<span id="cb135-999"><a href="#cb135-999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb135-1000"><a href="#cb135-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">level =</span> <span class="fl">0.95</span>) <span class="sc">+</span></span>
<span id="cb135-1001"><a href="#cb135-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Knowledge-Motivation Profiles by Cluster"</span>,</span>
<span id="cb135-1002"><a href="#cb135-1002" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Standardized Knowledge Composite"</span>,</span>
<span id="cb135-1003"><a href="#cb135-1003" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Standardized Motivation Composite"</span>) <span class="sc">+</span></span>
<span id="cb135-1004"><a href="#cb135-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-1005"><a href="#cb135-1005" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1006"><a href="#cb135-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1007"><a href="#cb135-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1008"><a href="#cb135-1008" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2c</span></span>
<span id="cb135-1009"><a href="#cb135-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1012"><a href="#cb135-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-1013"><a href="#cb135-1013" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine key measures into correlation matrix</span></span>
<span id="cb135-1014"><a href="#cb135-1014" aria-hidden="true" tabindex="-1"></a>key_measures <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-1015"><a href="#cb135-1015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb135-1016"><a href="#cb135-1016" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Knowledge measures</span></span>
<span id="cb135-1017"><a href="#cb135-1017" aria-hidden="true" tabindex="-1"></a>    numeracy, energy_use, energy_save, els_score,</span>
<span id="cb135-1018"><a href="#cb135-1018" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Motivation/attitude measures </span></span>
<span id="cb135-1019"><a href="#cb135-1019" aria-hidden="true" tabindex="-1"></a>    env_attitude, perceived_difficulty, pol_conservatism</span>
<span id="cb135-1020"><a href="#cb135-1020" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb135-1021"><a href="#cb135-1021" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb135-1022"><a href="#cb135-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1023"><a href="#cb135-1023" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and visualize correlation matrix</span></span>
<span id="cb135-1024"><a href="#cb135-1024" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(key_measures, <span class="at">use=</span><span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb135-1025"><a href="#cb135-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, </span>
<span id="cb135-1026"><a href="#cb135-1026" aria-hidden="true" tabindex="-1"></a>         <span class="at">method=</span><span class="st">"color"</span>,</span>
<span id="cb135-1027"><a href="#cb135-1027" aria-hidden="true" tabindex="-1"></a>         <span class="at">type=</span><span class="st">"upper"</span>,</span>
<span id="cb135-1028"><a href="#cb135-1028" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">"black"</span>,</span>
<span id="cb135-1029"><a href="#cb135-1029" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col=</span><span class="st">"black"</span>,</span>
<span id="cb135-1030"><a href="#cb135-1030" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.srt=</span><span class="dv">45</span>,</span>
<span id="cb135-1031"><a href="#cb135-1031" aria-hidden="true" tabindex="-1"></a>         <span class="at">diag=</span><span class="cn">FALSE</span>,</span>
<span id="cb135-1032"><a href="#cb135-1032" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span>))(<span class="dv">200</span>))</span>
<span id="cb135-1033"><a href="#cb135-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1034"><a href="#cb135-1034" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Factor Analysis to examine underlying structure</span></span>
<span id="cb135-1035"><a href="#cb135-1035" aria-hidden="true" tabindex="-1"></a>fa_results <span class="ot">&lt;-</span> <span class="fu">fa</span>(key_measures, <span class="at">nfactors=</span><span class="dv">2</span>, <span class="at">rotate=</span><span class="st">"varimax"</span>)</span>
<span id="cb135-1036"><a href="#cb135-1036" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_results, <span class="at">cut=</span><span class="fl">0.3</span>, <span class="at">sort=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-1037"><a href="#cb135-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1038"><a href="#cb135-1038" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Create composite scores and analyze relationships</span></span>
<span id="cb135-1039"><a href="#cb135-1039" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-1040"><a href="#cb135-1040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb135-1041"><a href="#cb135-1041" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Knowledge composite (z-score mean)</span></span>
<span id="cb135-1042"><a href="#cb135-1042" aria-hidden="true" tabindex="-1"></a>    <span class="at">knowledge_composite =</span> <span class="fu">scale</span>(<span class="fu">rowMeans</span>(</span>
<span id="cb135-1043"><a href="#cb135-1043" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(<span class="fu">scale</span>(numeracy), <span class="fu">scale</span>(energy_use), </span>
<span id="cb135-1044"><a href="#cb135-1044" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale</span>(energy_save), <span class="fu">scale</span>(els_score)))),</span>
<span id="cb135-1045"><a href="#cb135-1045" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Motivation composite</span></span>
<span id="cb135-1046"><a href="#cb135-1046" aria-hidden="true" tabindex="-1"></a>    <span class="at">motivation_composite =</span> <span class="fu">scale</span>(<span class="fu">rowMeans</span>(</span>
<span id="cb135-1047"><a href="#cb135-1047" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(<span class="fu">scale</span>(env_attitude), <span class="sc">-</span><span class="fu">scale</span>(perceived_difficulty), </span>
<span id="cb135-1048"><a href="#cb135-1048" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span><span class="fu">scale</span>(pol_conservatism))))</span>
<span id="cb135-1049"><a href="#cb135-1049" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-1050"><a href="#cb135-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1051"><a href="#cb135-1051" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Profile Analysis using cluster analysis</span></span>
<span id="cb135-1052"><a href="#cb135-1052" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize variables for clustering</span></span>
<span id="cb135-1053"><a href="#cb135-1053" aria-hidden="true" tabindex="-1"></a>cluster_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-1054"><a href="#cb135-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(knowledge_composite, motivation_composite) <span class="sc">%&gt;%</span></span>
<span id="cb135-1055"><a href="#cb135-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-1056"><a href="#cb135-1056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb135-1057"><a href="#cb135-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1058"><a href="#cb135-1058" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine optimal number of clusters</span></span>
<span id="cb135-1059"><a href="#cb135-1059" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_vars, kmeans, <span class="at">method=</span><span class="st">"silhouette"</span>)</span>
<span id="cb135-1060"><a href="#cb135-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1061"><a href="#cb135-1061" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform k-means clustering</span></span>
<span id="cb135-1062"><a href="#cb135-1062" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb135-1063"><a href="#cb135-1063" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># Based on silhouette plot</span></span>
<span id="cb135-1064"><a href="#cb135-1064" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_vars, <span class="at">centers=</span>k, <span class="at">nstart=</span><span class="dv">25</span>)</span>
<span id="cb135-1065"><a href="#cb135-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1066"><a href="#cb135-1066" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize clusters</span></span>
<span id="cb135-1067"><a href="#cb135-1067" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(clusters, <span class="at">data=</span>cluster_vars,</span>
<span id="cb135-1068"><a href="#cb135-1068" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom=</span><span class="st">"point"</span>,</span>
<span id="cb135-1069"><a href="#cb135-1069" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type=</span><span class="st">"convex"</span>,</span>
<span id="cb135-1070"><a href="#cb135-1070" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme=</span><span class="fu">theme_minimal</span>()) <span class="sc">+</span></span>
<span id="cb135-1071"><a href="#cb135-1071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Knowledge-Motivation Profiles"</span>)</span>
<span id="cb135-1072"><a href="#cb135-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1073"><a href="#cb135-1073" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Regression Analysis</span></span>
<span id="cb135-1074"><a href="#cb135-1074" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1: Knowledge predicting motivation</span></span>
<span id="cb135-1075"><a href="#cb135-1075" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(motivation_composite <span class="sc">~</span> knowledge_composite, <span class="at">data=</span>combined_scores)</span>
<span id="cb135-1076"><a href="#cb135-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1077"><a href="#cb135-1077" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2: Controlling for demographics if available</span></span>
<span id="cb135-1078"><a href="#cb135-1078" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(motivation_composite <span class="sc">~</span> knowledge_composite <span class="sc">+</span> pol_conservatism, </span>
<span id="cb135-1079"><a href="#cb135-1079" aria-hidden="true" tabindex="-1"></a>              <span class="at">data=</span>combined_scores)</span>
<span id="cb135-1080"><a href="#cb135-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1081"><a href="#cb135-1081" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_1)</span>
<span id="cb135-1082"><a href="#cb135-1082" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_2)</span>
<span id="cb135-1083"><a href="#cb135-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1084"><a href="#cb135-1084" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Examine cluster profiles</span></span>
<span id="cb135-1085"><a href="#cb135-1085" aria-hidden="true" tabindex="-1"></a>cluster_profiles <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-1086"><a href="#cb135-1086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cluster =</span> <span class="fu">factor</span>(clusters<span class="sc">$</span>cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb135-1087"><a href="#cb135-1087" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb135-1088"><a href="#cb135-1088" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb135-1089"><a href="#cb135-1089" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb135-1090"><a href="#cb135-1090" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_knowledge =</span> <span class="fu">mean</span>(knowledge_composite, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-1091"><a href="#cb135-1091" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_knowledge =</span> <span class="fu">sd</span>(knowledge_composite, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-1092"><a href="#cb135-1092" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_motivation =</span> <span class="fu">mean</span>(motivation_composite, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb135-1093"><a href="#cb135-1093" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_motivation =</span> <span class="fu">sd</span>(motivation_composite, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb135-1094"><a href="#cb135-1094" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-1095"><a href="#cb135-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1096"><a href="#cb135-1096" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cluster_profiles)</span>
<span id="cb135-1097"><a href="#cb135-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1098"><a href="#cb135-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1099"><a href="#cb135-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1100"><a href="#cb135-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1101"><a href="#cb135-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1102"><a href="#cb135-1102" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3c</span></span>
<span id="cb135-1103"><a href="#cb135-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1106"><a href="#cb135-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-1107"><a href="#cb135-1107" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb135-1108"><a href="#cb135-1108" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb135-1109"><a href="#cb135-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1110"><a href="#cb135-1110" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge them into one "long" dataframe with all items.</span></span>
<span id="cb135-1111"><a href="#cb135-1111" aria-hidden="true" tabindex="-1"></a>all_items <span class="ot">&lt;-</span> aes_combined <span class="sc">%&gt;%</span></span>
<span id="cb135-1112"><a href="#cb135-1112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(att2_combined, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-1113"><a href="#cb135-1113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(els,           <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-1114"><a href="#cb135-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(rs,            <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb135-1115"><a href="#cb135-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1116"><a href="#cb135-1116" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect how many rows (should match total unique respondents if IDs match)</span></span>
<span id="cb135-1117"><a href="#cb135-1117" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(all_items)</span>
<span id="cb135-1118"><a href="#cb135-1118" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_items)</span>
<span id="cb135-1119"><a href="#cb135-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1120"><a href="#cb135-1120" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively, if you want only the *summarized scale scores* </span></span>
<span id="cb135-1121"><a href="#cb135-1121" aria-hidden="true" tabindex="-1"></a><span class="co"># for each instrument (as in your existing code):</span></span>
<span id="cb135-1122"><a href="#cb135-1122" aria-hidden="true" tabindex="-1"></a><span class="co">#   - attari1, attari2_scores, els_scores, rs_scores </span></span>
<span id="cb135-1123"><a href="#cb135-1123" aria-hidden="true" tabindex="-1"></a><span class="co"># we can merge those:</span></span>
<span id="cb135-1124"><a href="#cb135-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1125"><a href="#cb135-1125" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> attari1 <span class="sc">%&gt;%</span></span>
<span id="cb135-1126"><a href="#cb135-1126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(attari2_scores, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-1127"><a href="#cb135-1127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(els_scores,     <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-1128"><a href="#cb135-1128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(rs_scores,      <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb135-1129"><a href="#cb135-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1130"><a href="#cb135-1130" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for clarity (optional)</span></span>
<span id="cb135-1131"><a href="#cb135-1131" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(combined_scores) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb135-1132"><a href="#cb135-1132" aria-hidden="true" tabindex="-1"></a>  <span class="st">"id"</span>, </span>
<span id="cb135-1133"><a href="#cb135-1133" aria-hidden="true" tabindex="-1"></a>  <span class="st">"perceived_difficulty"</span>,  <span class="co"># from Attari Part 1</span></span>
<span id="cb135-1134"><a href="#cb135-1134" aria-hidden="true" tabindex="-1"></a>  <span class="st">"numeracy"</span>,</span>
<span id="cb135-1135"><a href="#cb135-1135" aria-hidden="true" tabindex="-1"></a>  <span class="st">"energy_use"</span>,</span>
<span id="cb135-1136"><a href="#cb135-1136" aria-hidden="true" tabindex="-1"></a>  <span class="st">"energy_save"</span>,</span>
<span id="cb135-1137"><a href="#cb135-1137" aria-hidden="true" tabindex="-1"></a>  <span class="st">"els_accuracy"</span>,</span>
<span id="cb135-1138"><a href="#cb135-1138" aria-hidden="true" tabindex="-1"></a>  <span class="st">"els_score"</span>,</span>
<span id="cb135-1139"><a href="#cb135-1139" aria-hidden="true" tabindex="-1"></a>  <span class="st">"env_attitude"</span>,</span>
<span id="cb135-1140"><a href="#cb135-1140" aria-hidden="true" tabindex="-1"></a>  <span class="st">"env_attitude_z"</span>,</span>
<span id="cb135-1141"><a href="#cb135-1141" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pol_conservatism"</span>,</span>
<span id="cb135-1142"><a href="#cb135-1142" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pol_conservatism_z"</span></span>
<span id="cb135-1143"><a href="#cb135-1143" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb135-1144"><a href="#cb135-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1145"><a href="#cb135-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1146"><a href="#cb135-1146" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Examine correlations and underlying structure</span></span>
<span id="cb135-1147"><a href="#cb135-1147" aria-hidden="true" tabindex="-1"></a><span class="co"># A. Correlation plot among the *scale-level* variables</span></span>
<span id="cb135-1148"><a href="#cb135-1148" aria-hidden="true" tabindex="-1"></a>cor_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-1149"><a href="#cb135-1149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score,</span>
<span id="cb135-1150"><a href="#cb135-1150" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty, env_attitude, pol_conservatism)</span>
<span id="cb135-1151"><a href="#cb135-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1152"><a href="#cb135-1152" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(cor_vars, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb135-1153"><a href="#cb135-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1154"><a href="#cb135-1154" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize correlation matrix</span></span>
<span id="cb135-1155"><a href="#cb135-1155" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(</span>
<span id="cb135-1156"><a href="#cb135-1156" aria-hidden="true" tabindex="-1"></a>  cor_matrix, </span>
<span id="cb135-1157"><a href="#cb135-1157" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"color"</span>, </span>
<span id="cb135-1158"><a href="#cb135-1158" aria-hidden="true" tabindex="-1"></a>  <span class="at">addCoef.col =</span> <span class="st">"black"</span>, </span>
<span id="cb135-1159"><a href="#cb135-1159" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb135-1160"><a href="#cb135-1160" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col  =</span> <span class="st">"black"</span>,</span>
<span id="cb135-1161"><a href="#cb135-1161" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.srt  =</span> <span class="dv">45</span>,</span>
<span id="cb135-1162"><a href="#cb135-1162" aria-hidden="true" tabindex="-1"></a>  <span class="at">diag    =</span> <span class="cn">FALSE</span></span>
<span id="cb135-1163"><a href="#cb135-1163" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb135-1164"><a href="#cb135-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1165"><a href="#cb135-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1166"><a href="#cb135-1166" aria-hidden="true" tabindex="-1"></a><span class="co"># B. Factor Analysis (to see if knowledge &amp; motivation load differently)</span></span>
<span id="cb135-1167"><a href="#cb135-1167" aria-hidden="true" tabindex="-1"></a><span class="co">#    Using, e.g., 2-factor solution as a demonstration:</span></span>
<span id="cb135-1168"><a href="#cb135-1168" aria-hidden="true" tabindex="-1"></a>fa_data <span class="ot">&lt;-</span> cor_vars <span class="sc">%&gt;%</span></span>
<span id="cb135-1169"><a href="#cb135-1169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb135-1170"><a href="#cb135-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1171"><a href="#cb135-1171" aria-hidden="true" tabindex="-1"></a>two_factor <span class="ot">&lt;-</span> <span class="fu">fa</span>(fa_data, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"ml"</span>)</span>
<span id="cb135-1172"><a href="#cb135-1172" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(two_factor, <span class="at">cut =</span> <span class="fl">0.30</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-1173"><a href="#cb135-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1174"><a href="#cb135-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1175"><a href="#cb135-1175" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb135-1176"><a href="#cb135-1176" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Inspect the relation between "motivation" and "knowledge"</span></span>
<span id="cb135-1177"><a href="#cb135-1177" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb135-1178"><a href="#cb135-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1179"><a href="#cb135-1179" aria-hidden="true" tabindex="-1"></a><span class="co"># --- (a) Simple regressions</span></span>
<span id="cb135-1180"><a href="#cb135-1180" aria-hidden="true" tabindex="-1"></a><span class="co"># For example: Predict ELS knowledge (els_score) from motivation variables</span></span>
<span id="cb135-1181"><a href="#cb135-1181" aria-hidden="true" tabindex="-1"></a>model_els <span class="ot">&lt;-</span> <span class="fu">lm</span>(els_score <span class="sc">~</span> env_attitude <span class="sc">+</span> perceived_difficulty <span class="sc">+</span> pol_conservatism, </span>
<span id="cb135-1182"><a href="#cb135-1182" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> combined_scores)</span>
<span id="cb135-1183"><a href="#cb135-1183" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_els)</span>
<span id="cb135-1184"><a href="#cb135-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1185"><a href="#cb135-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1186"><a href="#cb135-1186" aria-hidden="true" tabindex="-1"></a><span class="co"># --- (b) Create composites and correlate them</span></span>
<span id="cb135-1187"><a href="#cb135-1187" aria-hidden="true" tabindex="-1"></a><span class="co"># Composite for "knowledge": average of numeracy, energy_use, energy_save, els_score</span></span>
<span id="cb135-1188"><a href="#cb135-1188" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-1189"><a href="#cb135-1189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb135-1190"><a href="#cb135-1190" aria-hidden="true" tabindex="-1"></a>    <span class="at">knowledge_composite =</span> <span class="fu">rowMeans</span>(</span>
<span id="cb135-1191"><a href="#cb135-1191" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(numeracy, energy_use, energy_save, els_score), </span>
<span id="cb135-1192"><a href="#cb135-1192" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb135-1193"><a href="#cb135-1193" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb135-1194"><a href="#cb135-1194" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For "motivation," you might choose env_attitude and reverse-coded difficulty, </span></span>
<span id="cb135-1195"><a href="#cb135-1195" aria-hidden="true" tabindex="-1"></a>    <span class="co"># or some other conceptual combination. Example:</span></span>
<span id="cb135-1196"><a href="#cb135-1196" aria-hidden="true" tabindex="-1"></a>    <span class="at">motivation_composite =</span> <span class="fu">rowMeans</span>(</span>
<span id="cb135-1197"><a href="#cb135-1197" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(env_attitude, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> perceived_difficulty), </span>
<span id="cb135-1198"><a href="#cb135-1198" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb135-1199"><a href="#cb135-1199" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb135-1200"><a href="#cb135-1200" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-1201"><a href="#cb135-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1202"><a href="#cb135-1202" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(combined_scores<span class="sc">$</span>knowledge_composite, combined_scores<span class="sc">$</span>motivation_composite,</span>
<span id="cb135-1203"><a href="#cb135-1203" aria-hidden="true" tabindex="-1"></a>    <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb135-1204"><a href="#cb135-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1205"><a href="#cb135-1205" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-1206"><a href="#cb135-1206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(knowledge_composite, motivation_composite) <span class="sc">%&gt;%</span></span>
<span id="cb135-1207"><a href="#cb135-1207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-1208"><a href="#cb135-1208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb135-1209"><a href="#cb135-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1210"><a href="#cb135-1210" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide the number of clusters (k). Let's try k = 3 for illustration:</span></span>
<span id="cb135-1211"><a href="#cb135-1211" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb135-1212"><a href="#cb135-1212" aria-hidden="true" tabindex="-1"></a>km_fit <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb135-1213"><a href="#cb135-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1214"><a href="#cb135-1214" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize clusters</span></span>
<span id="cb135-1215"><a href="#cb135-1215" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_fit, <span class="at">data =</span> cluster_data) <span class="sc">+</span></span>
<span id="cb135-1216"><a href="#cb135-1216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clustering on Knowledge vs. Motivation"</span>) <span class="sc">+</span></span>
<span id="cb135-1217"><a href="#cb135-1217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-1218"><a href="#cb135-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1219"><a href="#cb135-1219" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster membership back to your main dataframe</span></span>
<span id="cb135-1220"><a href="#cb135-1220" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>km_cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(km_fit<span class="sc">$</span>cluster)</span>
<span id="cb135-1221"><a href="#cb135-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1222"><a href="#cb135-1222" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare mean knowledge &amp; motivation by cluster</span></span>
<span id="cb135-1223"><a href="#cb135-1223" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-1224"><a href="#cb135-1224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(km_cluster) <span class="sc">%&gt;%</span></span>
<span id="cb135-1225"><a href="#cb135-1225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb135-1226"><a href="#cb135-1226" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_knowledge =</span> <span class="fu">mean</span>(knowledge_composite, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb135-1227"><a href="#cb135-1227" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_motivation =</span> <span class="fu">mean</span>(motivation_composite, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb135-1228"><a href="#cb135-1228" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb135-1229"><a href="#cb135-1229" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-1230"><a href="#cb135-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1231"><a href="#cb135-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1232"><a href="#cb135-1232" aria-hidden="true" tabindex="-1"></a><span class="co"># --- (d) Canonical Correlation Analysis (CCA)</span></span>
<span id="cb135-1233"><a href="#cb135-1233" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting your knowledge vs. motivation sets</span></span>
<span id="cb135-1234"><a href="#cb135-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1235"><a href="#cb135-1235" aria-hidden="true" tabindex="-1"></a>knowledge_set <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-1236"><a href="#cb135-1236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score) <span class="sc">%&gt;%</span></span>
<span id="cb135-1237"><a href="#cb135-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb135-1238"><a href="#cb135-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1239"><a href="#cb135-1239" aria-hidden="true" tabindex="-1"></a>motivation_set <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb135-1240"><a href="#cb135-1240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(env_attitude, perceived_difficulty, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb135-1241"><a href="#cb135-1241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb135-1242"><a href="#cb135-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1243"><a href="#cb135-1243" aria-hidden="true" tabindex="-1"></a><span class="co"># We need same rows for both sets, so do a quick align:</span></span>
<span id="cb135-1244"><a href="#cb135-1244" aria-hidden="true" tabindex="-1"></a>cca_df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">data.frame</span>(knowledge_set, motivation_set))</span>
<span id="cb135-1245"><a href="#cb135-1245" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> cca_df[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb135-1246"><a href="#cb135-1246" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> cca_df[, <span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb135-1247"><a href="#cb135-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1248"><a href="#cb135-1248" aria-hidden="true" tabindex="-1"></a>cca_res <span class="ot">&lt;-</span> <span class="fu">cancor</span>(K, M)</span>
<span id="cb135-1249"><a href="#cb135-1249" aria-hidden="true" tabindex="-1"></a>cca_res<span class="sc">$</span>cor  <span class="co"># canonical correlations</span></span>
<span id="cb135-1250"><a href="#cb135-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1251"><a href="#cb135-1251" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect canonical weights and loadings</span></span>
<span id="cb135-1252"><a href="#cb135-1252" aria-hidden="true" tabindex="-1"></a>cca_res<span class="sc">$</span>xcoef</span>
<span id="cb135-1253"><a href="#cb135-1253" aria-hidden="true" tabindex="-1"></a>cca_res<span class="sc">$</span>ycoef</span>
<span id="cb135-1254"><a href="#cb135-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1255"><a href="#cb135-1255" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothetical model: </span></span>
<span id="cb135-1256"><a href="#cb135-1256" aria-hidden="true" tabindex="-1"></a><span class="co">#   - latent Knowledge from numeracy, energy_use, energy_save, els_score</span></span>
<span id="cb135-1257"><a href="#cb135-1257" aria-hidden="true" tabindex="-1"></a><span class="co">#   - latent Motivation from env_attitude, perceived_difficulty</span></span>
<span id="cb135-1258"><a href="#cb135-1258" aria-hidden="true" tabindex="-1"></a><span class="co">#   - regression: Knowledge ~ Motivation</span></span>
<span id="cb135-1259"><a href="#cb135-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1260"><a href="#cb135-1260" aria-hidden="true" tabindex="-1"></a>sem_model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb135-1261"><a href="#cb135-1261" aria-hidden="true" tabindex="-1"></a><span class="st">  Knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span id="cb135-1262"><a href="#cb135-1262" aria-hidden="true" tabindex="-1"></a><span class="st">  Motivation =~ env_attitude + perceived_difficulty</span></span>
<span id="cb135-1263"><a href="#cb135-1263" aria-hidden="true" tabindex="-1"></a><span class="st">  Knowledge ~ Motivation</span></span>
<span id="cb135-1264"><a href="#cb135-1264" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb135-1265"><a href="#cb135-1265" aria-hidden="true" tabindex="-1"></a>fit_sem <span class="ot">&lt;-</span> <span class="fu">sem</span>(sem_model, <span class="at">data =</span> combined_scores, <span class="at">missing =</span> <span class="st">"fiml"</span>)  <span class="co"># handle missing if needed</span></span>
<span id="cb135-1266"><a href="#cb135-1266" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_sem, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-1267"><a href="#cb135-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1268"><a href="#cb135-1268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Â© 2025 <a href="https://tegorman13.github.io">Thomas Gorman</a></p>
</div>   
    <div class="nav-footer-center">
<p>site made with <a href="https://cran.r-project.org/"><i class="fa-brands fa-r-project" aria-label="r-project"></i></a> and <a href="https://quarto.org/">Quarto</a></p>
<div class="toc-actions"><ul><li><a href="https://github.com/tegorman13/Survey_Study/blob/main/cors2.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://github.com/tegorman13/Survey_Study" target="_blank">
<p><i class="fa-brands fa-github fa-2.0x" aria-label="github"></i></p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>