<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.13">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Instrument Correlations â€“ CCL Survey Study</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./cors1.html" rel="next">
<link href="./inst.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-66ab7fd5e73b7f0a764e0d49b3e29ab1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8ebe664a20a329468a5069a44ff81306.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<!-- academic icons --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
<!-- fontawesome icons --><script src="https://kit.fontawesome.com/1392a7030f.js" crossorigin="anonymous"></script>
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">CCL Survey Study</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="./org.html" aria-current="page"> 
<span class="menu-text">Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./cors.html"> 
<span class="menu-text">Correlations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./inspect.html"> 
<span class="menu-text">items</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/tegorman13/Survey_Study"> <i class="bi bi-github" role="img" aria-label="github">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./inst.html"><strong>Analyses</strong></a></li><li class="breadcrumb-item"><a href="./cors.html">Correlations</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Analyses</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inst.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">Survey Items</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cors.html" class="sidebar-item-text sidebar-link active"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cors1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instrument Correlations_b</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./org.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">Organization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inspect.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">Inspect</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="cor_hugo.md"><i class="bi bi-file-code"></i>CommonMark (hugo)</a></li></ul></div></div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./inst.html"><strong>Analyses</strong></a></li><li class="breadcrumb-item"><a href="./cors.html">Correlations</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Instrument Correlations</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header><div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">dplyr</span>,<span class="va">purrr</span>,<span class="va">tidyr</span>,<span class="va">here</span>, <span class="va">haven</span>,<span class="va">tibble</span>,<span class="va">ggplot2</span>,<span class="va">ggh4x</span>,<span class="va">lme4</span>,<span class="va">knitr</span>,<span class="va">kableExtra</span>,<span class="va">gt</span>,<span class="va">pander</span>,<span class="va">flextable</span>,<span class="va">ggh4x</span>,<span class="va">psych</span>,<span class="va">corrplot</span>,<span class="va">factoextra</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">2</span>, scipen<span class="op">=</span><span class="fl">999</span>, dplyr.summarise.inform<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"scripts"</span>,<span class="st">"survey_functions.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">draw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"draw.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dinst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"dinst.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Attari Energy Survey (Part 1)</span></span>
<span><span class="va">aes1</span> <span class="op">&lt;-</span> <span class="va">draw</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">ATT01</span><span class="op">:</span><span class="va">ATT18</span><span class="op">)</span></span>
<span><span class="va">aes2</span> <span class="op">&lt;-</span> <span class="va">dinst</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">ATT01</span><span class="op">:</span><span class="va">ATT18</span><span class="op">)</span></span>
<span><span class="va">aes_combined</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">aes1</span>, <span class="va">aes2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">att_useSave</span> <span class="op">&lt;-</span> <span class="va">draw</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">ATT19</span><span class="op">:</span><span class="va">ATT33</span><span class="op">)</span></span>
<span><span class="va">att_useSave2</span> <span class="op">&lt;-</span> <span class="va">dinst</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">ATT19</span><span class="op">:</span><span class="va">ATT33</span><span class="op">)</span></span>
<span><span class="va">att2_combined</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">att_useSave</span>, <span class="va">att_useSave2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">els1</span> <span class="op">&lt;-</span> <span class="va">draw</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">ELS01</span><span class="op">:</span><span class="va">ELS08</span><span class="op">)</span></span>
<span><span class="va">els2</span> <span class="op">&lt;-</span> <span class="va">dinst</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">ELS01</span><span class="op">:</span><span class="va">ELS08</span><span class="op">)</span></span>
<span><span class="va">els</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">els1</span>,<span class="va">els2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rs1</span> <span class="op">&lt;-</span> <span class="va">draw</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">RS01</span><span class="op">:</span><span class="va">RS06</span><span class="op">)</span></span>
<span><span class="va">rs2</span> <span class="op">&lt;-</span> <span class="va">dinst</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>,<span class="va">RS01</span><span class="op">:</span><span class="va">RS06</span><span class="op">)</span></span>
<span><span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">rs1</span>,<span class="va">rs2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">attari1</span> <span class="op">&lt;-</span> <span class="fu">analyze_attari_survey_part1</span><span class="op">(</span><span class="va">aes_combined</span><span class="op">)</span></span>
<span><span class="va">attari2_scores</span> <span class="op">&lt;-</span> <span class="fu">analyze_attari_survey</span><span class="op">(</span><span class="va">att2_combined</span><span class="op">)</span></span>
<span><span class="va">els_scores</span> <span class="op">&lt;-</span> <span class="fu">analyze_els_survey</span><span class="op">(</span><span class="va">els</span><span class="op">)</span></span>
<span><span class="va">rs_scores</span> <span class="op">&lt;-</span> <span class="fu">analyze_recycling_survey</span><span class="op">(</span><span class="va">rs</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine all scores into one dataframe</span></span>
<span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">attari1</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">attari2_scores</span>, by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">els_scores</span>, by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">rs_scores</span>, by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rename columns for clarity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"perceived_difficulty"</span>, <span class="st">"numeracy"</span>, </span>
<span>                          <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, </span>
<span>                          <span class="st">"els_accuracy"</span>, <span class="st">"els_score"</span>,</span>
<span>                          <span class="st">"env_attitude"</span>, <span class="st">"env_attitude_z"</span>,</span>
<span>                          <span class="st">"pol_conservatism"</span>, <span class="st">"pol_conservatism_z"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1. Cluster Analysis</span></span>
<span></span>
<span><span class="co"># Prepare data for clustering (select relevant variables and scale)</span></span>
<span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">perceived_difficulty</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>, <span class="va">env_attitude_z</span>, <span class="va">pol_conservatism_z</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Determine optimal number of clusters using the elbow method</span></span>
<span><span class="fu">fviz_nbclust</span><span class="op">(</span><span class="va">cluster_data</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"wss"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Elbow Method for Optimal k"</span>, x <span class="op">=</span> <span class="st">"Number of Clusters k"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform k-means clustering (e.g., with 3 clusters)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">km_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the clusters</span></span>
<span><span class="fu">fviz_cluster</span><span class="op">(</span><span class="va">km_result</span>, data <span class="op">=</span> <span class="va">cluster_data</span>,</span>
<span>             geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>             ellipse.type <span class="op">=</span> <span class="st">"convex"</span>,</span>
<span>             ggtheme <span class="op">=</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means Clustering of Subjects"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Add cluster assignments to the main dataframe</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">km_result</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Enhanced Factor Analysis</span></span>
<span></span>
<span><span class="co"># Scree plot to determine the number of factors</span></span>
<span><span class="va">fa_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">perceived_difficulty</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>, <span class="va">env_attitude_z</span>, <span class="va">pol_conservatism_z</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">scree</span><span class="op">(</span><span class="va">fa_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform factor analysis with, e.g., 3 factors</span></span>
<span><span class="va">fa_result</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="va">fa_data</span>, nfactors <span class="op">=</span> <span class="fl">2</span>, rotate <span class="op">=</span> <span class="st">"varimax"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fa_result</span>, cut <span class="op">=</span> <span class="fl">0.3</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = fa_data, nfactors = 2, rotate = "varimax")
Standardized loadings (pattern matrix) based upon correlation matrix
                     item   MR1   MR2   h2     u2 com
energy_use              3  0.77       0.61 0.3856 1.1
energy_save             4  0.68       0.49 0.5146 1.1
numeracy                2  0.52       0.29 0.7067 1.2
els_score               5  0.50       0.30 0.6954 1.4
pol_conservatism_z      7             0.14 0.8570 2.0
env_attitude_z          6        0.99 1.00 0.0035 1.0
perceived_difficulty    1       -0.36 0.19 0.8120 1.7

                       MR1  MR2
SS loadings           1.72 1.31
Proportion Var        0.25 0.19
Cumulative Var        0.25 0.43
Proportion Explained  0.57 0.43
Cumulative Proportion 0.57 1.00

Mean item complexity =  1.4
Test of the hypothesis that 2 factors are sufficient.

df null model =  21  with the objective function =  1.3 with Chi Square =  760
df of  the model are 8  and the objective function was  0.03 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.04 

The harmonic n.obs is  586 with the empirical chi square  17  with prob &lt;  0.035 
The total n.obs was  586  with Likelihood Chi Square =  17  with prob &lt;  0.029 

Tucker Lewis Index of factoring reliability =  0.97
RMSEA index =  0.044  and the 90 % confidence intervals are  0.014 0.073
BIC =  -34
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   MR1  MR2
Correlation of (regression) scores with factors   0.87 1.00
Multiple R square of scores with factors          0.76 0.99
Minimum correlation of possible factor scores     0.52 0.99</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Enhanced Regression Models</span></span>
<span><span class="co"># Model predicting ELS from motivation, controlling for other knowledge scores</span></span>
<span><span class="va">model_els_enhanced</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els_score</span> <span class="op">~</span> <span class="va">perceived_difficulty</span> <span class="op">+</span> <span class="va">env_attitude_z</span> <span class="op">+</span> <span class="va">pol_conservatism_z</span> <span class="op">+</span></span>
<span>                           <span class="va">numeracy</span> <span class="op">+</span> <span class="va">energy_use</span> <span class="op">+</span> <span class="va">energy_save</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_els_enhanced</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els_score ~ perceived_difficulty + env_attitude_z + 
    pol_conservatism_z + numeracy + energy_use + energy_save, 
    data = combined_scores)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.8527 -0.5932 -0.0299  0.6199  1.8308 

Coefficients:
                                 Estimate           Std. Error t value Pr(&gt;|t|)
(Intercept)          -0.00000000000000163  0.03613218269822796    0.00   1.0000
perceived_difficulty -0.06114449214752567  0.04004735896976241   -1.53   0.1274
env_attitude_z        0.13430310791561964  0.04088654156087833    3.28   0.0011
pol_conservatism_z   -0.02729118081676693  0.03888339472559318   -0.70   0.4830
numeracy              0.16978503215872956  0.04078151886943691    4.16 0.000036
energy_use            0.19904507771344263  0.04637687030463776    4.29 0.000021
energy_save           0.13859460176947813  0.04521755406911262    3.07   0.0023
                        
(Intercept)             
perceived_difficulty    
env_attitude_z       ** 
pol_conservatism_z      
numeracy             ***
energy_use           ***
energy_save          ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.88 on 579 degrees of freedom
Multiple R-squared:  0.243, Adjusted R-squared:  0.235 
F-statistic: 30.9 on 6 and 579 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 4. Interaction Effects in Regression</span></span>
<span><span class="co"># Example: Interaction between environmental attitude and perceived difficulty on ELS</span></span>
<span><span class="va">model_interaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els_score</span> <span class="op">~</span> <span class="va">perceived_difficulty</span> <span class="op">*</span> <span class="va">env_attitude_z</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_interaction</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els_score ~ perceived_difficulty * env_attitude_z, 
    data = combined_scores)

Residuals:
   Min     1Q Median     3Q    Max 
-3.169 -0.678  0.026  0.689  2.285 

Coefficients:
                                    Estimate Std. Error t value   Pr(&gt;|t|)    
(Intercept)                          -0.0130     0.0423   -0.31     0.7592    
perceived_difficulty                 -0.1383     0.0428   -3.23     0.0013 ** 
env_attitude_z                        0.2187     0.0428    5.11 0.00000045 ***
perceived_difficulty:env_attitude_z  -0.0337     0.0393   -0.86     0.3915    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.96 on 582 degrees of freedom
Multiple R-squared:  0.0915,    Adjusted R-squared:  0.0868 
F-statistic: 19.5 on 3 and 582 DF,  p-value: 0.00000000000438</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize the interaction (example)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">combined_scores</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">perceived_difficulty</span>, y <span class="op">=</span> <span class="va">els_score</span>, color <span class="op">=</span> <span class="va">env_attitude_z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_gradient</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Interaction of Perceived Difficulty and Environmental Attitude on ELS"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Perceived Difficulty"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Energy Literacy Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">combined_df</span> <span class="op">&lt;-</span> <span class="va">attari1</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">attari2_scores</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">els_scores</span>,       by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">rs_scores</span>,        by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># 1. Create knowledge profiles using cluster analysis</span></span>
<span><span class="va">knowledge_vars</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>, </span>
<span>         <span class="va">relative_energy_save_score</span>, <span class="va">els</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">knowledge_vars</span><span class="op">)</span>, centers<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add cluster membership to data</span></span>
<span><span class="va">combined_df</span><span class="op">$</span><span class="va">knowledge_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare motivation scores across clusters</span></span>
<span><span class="va">cluster_comparison</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">knowledge_cluster</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean_env_attitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">env_attitude</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_difficulty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Test for non-linear relationships</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span>
<span><span class="va">gam_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span><span class="va">els</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">env_attitude</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">perceived_difficulty_score</span><span class="op">)</span>, </span>
<span>                 data<span class="op">=</span><span class="va">combined_df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Create interaction model between knowledge and motivation</span></span>
<span><span class="va">interaction_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els</span> <span class="op">~</span> <span class="va">env_attitude</span> <span class="op">*</span> <span class="va">perceived_difficulty_score</span> <span class="op">+</span> </span>
<span>                         <span class="va">numeracy_score</span>, data<span class="op">=</span><span class="va">combined_df</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot">corrplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1. Enhanced Correlation Plot</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>, </span>
<span>         <span class="va">relative_energy_save_score</span>, <span class="va">els</span>, </span>
<span>         <span class="va">perceived_difficulty_score</span>, <span class="va">env_attitude</span>, </span>
<span>         <span class="va">pol_conservatism_z</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">cor_matrix</span>, </span>
<span>         method <span class="op">=</span> <span class="st">"color"</span>,</span>
<span>         type <span class="op">=</span> <span class="st">"upper"</span>,</span>
<span>         addCoef.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>         tl.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>         tl.srt <span class="op">=</span> <span class="fl">45</span>,</span>
<span>         diag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>         col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Knowledge Profile Clustering</span></span>
<span><span class="co"># Standardize knowledge variables</span></span>
<span><span class="va">knowledge_vars</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>, </span>
<span>         <span class="va">relative_energy_save_score</span>, <span class="va">els</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Determine optimal number of clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">wss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">knowledge_vars</span>, centers<span class="op">=</span><span class="va">k</span><span class="op">)</span><span class="op">$</span><span class="va">tot.withinss</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform k-means clustering</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">3</span>  <span class="co"># Based on elbow plot inspection</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">knowledge_vars</span>, centers<span class="op">=</span><span class="va">k</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add cluster membership to data</span></span>
<span><span class="va">combined_df</span><span class="op">$</span><span class="va">knowledge_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize clusters</span></span>
<span><span class="va">pca_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">knowledge_vars</span><span class="op">)</span></span>
<span><span class="va">cluster_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  PC1 <span class="op">=</span> <span class="va">pca_result</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>  PC2 <span class="op">=</span> <span class="va">pca_result</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>  Cluster <span class="op">=</span> <span class="va">combined_df</span><span class="op">$</span><span class="va">knowledge_cluster</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create cluster visualization</span></span>
<span><span class="va">p_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">cluster_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PC1</span>, y<span class="op">=</span><span class="va">PC2</span>, color<span class="op">=</span><span class="va">Cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Knowledge Profiles Clustering"</span>,</span>
<span>       x<span class="op">=</span><span class="st">"First Principal Component"</span>,</span>
<span>       y<span class="op">=</span><span class="st">"Second Principal Component"</span><span class="op">)</span></span>
<span><span class="va">p_clusters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Non-linear GAM Analysis</span></span>
<span><span class="va">gam_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op">(</span><span class="va">els</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">env_attitude</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">perceived_difficulty_score</span><span class="op">)</span>, </span>
<span>                 data<span class="op">=</span><span class="va">combined_df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create prediction grid for GAM visualization</span></span>
<span><span class="va">env_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">env_attitude</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">env_attitude</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">diff_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict ELS scores</span></span>
<span><span class="va">pred_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">gam_model</span>, </span>
<span>                   newdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>env_attitude<span class="op">=</span><span class="va">env_grid</span>,</span>
<span>                                    perceived_difficulty_score<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pred_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">gam_model</span>,</span>
<span>                    newdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>perceived_difficulty_score<span class="op">=</span><span class="va">diff_grid</span>,</span>
<span>                                     env_attitude<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">env_attitude</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create GAM plots</span></span>
<span><span class="va">p_gam_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">env_grid</span>, y<span class="op">=</span><span class="va">pred_env</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">combined_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">env_attitude</span>, y<span class="op">=</span><span class="va">els</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Non-linear Relationship: Environmental Attitude and Energy Literacy"</span>,</span>
<span>       x<span class="op">=</span><span class="st">"Environmental Attitude"</span>,</span>
<span>       y<span class="op">=</span><span class="st">"Energy Literacy Score"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_gam_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">diff_grid</span>, y<span class="op">=</span><span class="va">pred_diff</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">combined_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">perceived_difficulty_score</span>, y<span class="op">=</span><span class="va">els</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Non-linear Relationship: Perceived Difficulty and Energy Literacy"</span>,</span>
<span>       x<span class="op">=</span><span class="st">"Perceived Difficulty Score"</span>,</span>
<span>       y<span class="op">=</span><span class="st">"Energy Literacy Score"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#p_gam_diff</span></span>
<span></span>
<span></span>
<span><span class="co"># 4. Knowledge-Motivation Interaction Analysis</span></span>
<span><span class="va">interaction_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els</span> <span class="op">~</span> <span class="va">env_attitude</span> <span class="op">*</span> <span class="va">perceived_difficulty_score</span> <span class="op">+</span> </span>
<span>                         <span class="va">numeracy_score</span>, data<span class="op">=</span><span class="va">combined_df</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">interaction_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els ~ env_attitude * perceived_difficulty_score + 
    numeracy_score, data = combined_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.0152 -0.6285  0.0088  0.6599  2.2174 

Coefficients:
                                        Estimate Std. Error t value
(Intercept)                              -0.7906     0.1966   -4.02
env_attitude                              0.2192     0.0538    4.07
perceived_difficulty_score               -0.0550     0.1782   -0.31
numeracy_score                            0.2909     0.0387    7.52
env_attitude:perceived_difficulty_score  -0.0177     0.0488   -0.36
                                                Pr(&gt;|t|)    
(Intercept)                             0.00006570557947 ***
env_attitude                            0.00005257587373 ***
perceived_difficulty_score                          0.76    
numeracy_score                          0.00000000000021 ***
env_attitude:perceived_difficulty_score             0.72    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.91 on 581 degrees of freedom
Multiple R-squared:  0.172, Adjusted R-squared:  0.166 
F-statistic: 30.2 on 4 and 581 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create interaction plot data</span></span>
<span><span class="va">env_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">env_attitude</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">diff_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">combined_df</span><span class="op">$</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># pred_data &lt;- expand.grid(</span></span>
<span><span class="co">#   perceived_difficulty_score = diff_seq,</span></span>
<span><span class="co">#   env_attitude = levels(factor(combined_df$env_attitude)),</span></span>
<span><span class="co">#   numeracy_score = mean(combined_df$numeracy_score, na.rm=TRUE)</span></span>
<span><span class="co"># )</span></span>
<span></span>
<span><span class="co"># pred_data$predicted_els &lt;- predict(interaction_model, newdata=pred_data)</span></span>
<span></span>
<span><span class="co"># p_interaction &lt;- ggplot(pred_data, aes(x=perceived_difficulty_score, y=predicted_els, </span></span>
<span><span class="co">#                                       color=factor(env_attitude))) +</span></span>
<span><span class="co">#   geom_line() +</span></span>
<span><span class="co">#   theme_minimal() +</span></span>
<span><span class="co">#   labs(title="Interaction between Environmental Attitude and Perceived Difficulty",</span></span>
<span><span class="co">#        x="Perceived Difficulty Score",</span></span>
<span><span class="co">#        y="Predicted Energy Literacy Score",</span></span>
<span><span class="co">#        color="Environmental\nAttitude Level")</span></span>
<span></span>
<span><span class="co"># Arrange all plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p_clusters</span>, <span class="va">p_gam_env</span>, <span class="va">p_gam_diff</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Print statistical summaries</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">gam_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
els ~ s(env_attitude) + s(perceived_difficulty_score)

Parametric coefficients:
                       Estimate          Std. Error t value Pr(&gt;|t|)
(Intercept) 0.00000000000000488 0.03867979305614088       0        1

Approximate significance of smooth terms:
                               edf Ref.df    F   p-value    
s(env_attitude)               5.44   6.52 6.19 0.0000016 ***
s(perceived_difficulty_score) 6.28   7.42 3.76   0.00043 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.123   Deviance explained = 14.1%
GCV = 0.89618  Scale est. = 0.87673   n = 586</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">interaction_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els ~ env_attitude * perceived_difficulty_score + 
    numeracy_score, data = combined_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.0152 -0.6285  0.0088  0.6599  2.2174 

Coefficients:
                                        Estimate Std. Error t value
(Intercept)                              -0.7906     0.1966   -4.02
env_attitude                              0.2192     0.0538    4.07
perceived_difficulty_score               -0.0550     0.1782   -0.31
numeracy_score                            0.2909     0.0387    7.52
env_attitude:perceived_difficulty_score  -0.0177     0.0488   -0.36
                                                Pr(&gt;|t|)    
(Intercept)                             0.00006570557947 ***
env_attitude                            0.00005257587373 ***
perceived_difficulty_score                          0.76    
numeracy_score                          0.00000000000021 ***
env_attitude:perceived_difficulty_score             0.72    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.91 on 581 degrees of freedom
Multiple R-squared:  0.172, Adjusted R-squared:  0.166 
F-statistic: 30.2 on 4 and 581 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Cluster profile analysis</span></span>
<span><span class="va">cluster_profiles</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">knowledge_cluster</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean_numeracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">numeracy_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_energy_use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">relative_energy_use_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_energy_save <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">relative_energy_save_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_els <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">els</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_env_attitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">env_attitude</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_difficulty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">perceived_difficulty_score</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cluster_profiles</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 8
  knowledge_cluster mean_numeracy mean_energy_use mean_energy_save mean_els
  &lt;fct&gt;                     &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;    &lt;dbl&gt;
1 1                        -1.43           -0.670           -0.679   -0.790
2 2                         0.361          -0.386           -0.470   -0.463
3 3                         0.459           0.635            0.705    0.756
# â„¹ 3 more variables: mean_env_attitude &lt;dbl&gt;, mean_difficulty &lt;dbl&gt;, n &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example: K-means clustering on knowledge + motivation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span>   <span class="co"># for visualization of clusters</span></span>
<span></span>
<span><span class="co"># Subset your knowledge &amp; motivation columns</span></span>
<span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>, <span class="va">relative_energy_save_score</span>,</span>
<span>         <span class="va">els</span>, <span class="va">perceived_difficulty_score</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Scale them</span></span>
<span><span class="va">cluster_data_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">cluster_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Decide on number of clusters (e.g. 2â€“5) â€“ use e.g. Elbow method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"wss"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Suppose we choose 3 clusters as a demonstration</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">km_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add cluster membership back into the original data</span></span>
<span><span class="va">cluster_data</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">km_result</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize clusters in 2D (using PCA behind the scenes)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_result</span>, data <span class="op">=</span> <span class="va">cluster_data_scaled</span>,</span>
<span>             geom <span class="op">=</span> <span class="st">"point"</span>, ellipse.type <span class="op">=</span> <span class="st">"convex"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means Clusters of Knowledge &amp; Motivation Variables"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1. Grab relevant variables</span></span>
<span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>, <span class="va">relative_energy_save_score</span>,</span>
<span>         <span class="va">els</span>, <span class="va">perceived_difficulty_score</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Standardize/scale them</span></span>
<span><span class="va">cluster_data_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">cluster_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Determine the optimal number of clusters (Elbow or Silhouette methods)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"wss"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 4. Run k-means with your chosen number of clusters (say k = 3)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">km_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5. Visualize</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_res</span>, data <span class="op">=</span> <span class="va">cluster_data_scaled</span>,</span>
<span>             geom <span class="op">=</span> <span class="st">"point"</span>, ellipse.type <span class="op">=</span> <span class="st">"convex"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means Clusters of Knowledge &amp; Motivation Variables"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 6. Inspect cluster means</span></span>
<span><span class="va">cluster_centers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">km_res</span><span class="op">$</span><span class="va">centers</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cluster_centers</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cluster_data</span><span class="op">)</span></span>
<span><span class="va">cluster_centers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  numeracy_score relative_energy_use_score relative_energy_save_score   els
1          -0.80                     -0.74                      -0.76 -0.89
2           0.19                      0.12                       0.13  0.33
3           0.48                      0.48                       0.49  0.44
  perceived_difficulty_score env_attitude pol_conservatism
1                       0.69      -0.6788             0.41
2                      -0.35       0.0008             0.84
3                      -0.27       0.5253            -0.96</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example of hierarchical clustering if that is preferred</span></span>
<span><span class="va">dist_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span>
<span><span class="va">hc_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">dist_mat</span>, method <span class="op">=</span> <span class="st">"ward.D2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">hc_res</span>, main <span class="op">=</span> <span class="st">"Dendrogram of Hierarchical Clustering"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Cut tree at chosen k</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">hc_res</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>clusters
  1   2   3 
211  65 310 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example mediation: knowledge -&gt; perceived_difficulty -&gt; env_attitude</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_mediation</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  # direct effect</span></span>
<span><span class="st">  env_attitude ~ c*els</span></span>
<span><span class="st">  # mediator</span></span>
<span><span class="st">  perceived_difficulty_score ~ a*els</span></span>
<span><span class="st">  env_attitude ~ b*perceived_difficulty_score</span></span>
<span><span class="st">  # indirect effect</span></span>
<span><span class="st">  ab := a*b</span></span>
<span><span class="st">  # total effect</span></span>
<span><span class="st">  total := c + (a*b)</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="va">fit_mediation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model_mediation</span>, data <span class="op">=</span> <span class="va">combined_df</span>, missing<span class="op">=</span><span class="st">"fiml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_mediation</span>, fit.measures<span class="op">=</span><span class="cn">TRUE</span>, standardized<span class="op">=</span><span class="cn">TRUE</span>, rsquare<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         7

  Number of observations                           586
  Number of missing patterns                         1

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Model Test Baseline Model:

  Test statistic                               149.690
  Degrees of freedom                                 3
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000
  Tucker-Lewis Index (TLI)                       1.000
                                                      
  Robust Comparative Fit Index (CFI)             1.000
  Robust Tucker-Lewis Index (TLI)                1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1434.548
  Loglikelihood unrestricted model (H1)      -1434.548
                                                      
  Akaike (AIC)                                2883.095
  Bayesian (BIC)                              2913.709
  Sample-size adjusted Bayesian (SABIC)       2891.486

Root Mean Square Error of Approximation:

  RMSEA                                          0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.000
  P-value H_0: RMSEA &lt;= 0.050                       NA
  P-value H_0: RMSEA &gt;= 0.080                       NA
                                                      
  Robust RMSEA                                   0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.000
  P-value H_0: Robust RMSEA &lt;= 0.050                NA
  P-value H_0: Robust RMSEA &gt;= 0.080                NA

Standardized Root Mean Square Residual:

  SRMR                                           0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Regressions:
                               Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
  env_attitude ~                                                           
    els        (c)                0.152    0.029    5.151    0.000    0.152
  perceived_difficulty_score ~                                             
    els        (a)               -0.222    0.040   -5.506    0.000   -0.222
  env_attitude ~                                                           
    prcvd_dff_ (b)               -0.263    0.029   -8.934    0.000   -0.263
  Std.all
         
    0.197
         
   -0.222
         
   -0.342

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .env_attitude      3.583    0.029  124.796    0.000    3.583    4.653
   .prcvd_dffclty_    0.000    0.040    0.000    1.000    0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .env_attitude      0.483    0.028   17.117    0.000    0.483    0.815
   .prcvd_dffclty_    0.949    0.055   17.117    0.000    0.949    0.951

R-Square:
                   Estimate
    env_attitude      0.185
    prcvd_dffclty_    0.049

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    ab                0.058    0.012    4.687    0.000    0.058    0.076
    total             0.210    0.031    6.862    0.000    0.210    0.273</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Example composite for knowledge: average of (z-scored) numeracy, </span></span>
<span>    <span class="co"># energy_use, energy_save, ELS. </span></span>
<span>    <span class="co"># (You can also sum them, but average is convenient.)</span></span>
<span>    composite_knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>, </span>
<span>            <span class="va">relative_energy_save_score</span>, <span class="va">els</span><span class="op">)</span>,</span>
<span>      na.rm <span class="op">=</span> <span class="cn">FALSE</span>  <span class="co"># If a row has missing for any item, result = NA</span></span>
<span>    <span class="op">)</span>,</span>
<span>    </span>
<span>    <span class="co"># Example composite for motivation: </span></span>
<span>    <span class="co"># env_attitude might be already in a favorable direction, but if </span></span>
<span>    <span class="co"># perceived_difficulty is "difficulty," consider reversing so that </span></span>
<span>    <span class="co"># higher = "less difficulty" = "higher motivation."</span></span>
<span>    <span class="co"># For example: reverse_diff = (-1)*perceived_difficulty_score</span></span>
<span>    <span class="co"># Then average with env_attitude (if you want them combined).</span></span>
<span>    <span class="co"># If you are including pol_conservatism as well, you must decide </span></span>
<span>    <span class="co"># how to handle that in the composite. Possibly reverse-coded </span></span>
<span>    <span class="co"># so that higher # = more liberal or more "pro-environment" stance. </span></span>
<span>    <span class="co"># (It's your theoretical call.)</span></span>
<span>    </span>
<span>    <span class="co"># For now, let's do a small composite with environmental attitude </span></span>
<span>    <span class="co"># and reversed difficulty:</span></span>
<span>    reverse_diff <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">perceived_difficulty_score</span>,</span>
<span>    </span>
<span>    composite_motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">env_attitude</span>, <span class="va">reverse_diff</span><span class="op">)</span>, </span>
<span>      na.rm <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span>  <span class="co"># for nice cluster visualizations</span></span>
<span></span>
<span><span class="co"># We'll create a small data frame with just the two composites, </span></span>
<span><span class="co"># removing any incomplete cases</span></span>
<span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">composite_knowledge</span>, <span class="va">composite_motivation</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Decide on number of clusters "k". Letâ€™s try k = 3:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> </span>
<span><span class="va">km3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect results</span></span>
<span><span class="va">km3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 3 clusters of sizes 184, 167, 235

Cluster means:
  composite_knowledge composite_motivation
1               -0.79                  1.2
2                0.47                  1.4
3                0.29                  2.5

Clustering vector:
  [1] 2 3 1 3 2 3 3 1 2 3 3 3 1 3 1 1 1 1 1 3 3 2 1 3 3 3 2 3 1 1 2 2 2 3 2 2 2
 [38] 1 3 2 1 3 2 1 2 3 3 1 1 1 2 2 3 1 3 2 3 3 1 3 2 3 1 2 3 2 1 3 1 3 3 1 3 2
 [75] 2 3 1 3 1 3 3 3 3 2 2 2 1 2 3 1 2 3 3 3 2 3 1 3 2 3 3 3 3 2 2 2 3 3 3 3 2
[112] 3 2 3 3 1 3 3 2 2 2 1 3 3 2 2 3 3 2 2 3 3 3 3 1 1 3 3 3 1 3 1 3 2 3 3 2 2
[149] 2 3 3 2 2 1 3 3 1 2 2 1 2 3 3 2 3 1 3 3 2 2 3 2 2 1 2 3 1 3 2 2 2 3 3 1 2
[186] 1 2 2 3 3 3 2 1 2 2 2 3 2 3 2 3 2 3 1 1 1 3 3 3 2 1 2 3 1 2 1 3 2 2 3 2 2
[223] 3 1 3 1 2 2 3 2 1 1 2 2 3 2 1 3 1 1 1 2 2 1 1 1 3 1 3 1 3 1 1 2 1 2 1 1 1
[260] 3 1 3 1 3 3 1 1 1 3 1 1 1 1 1 3 3 1 2 1 1 1 1 1 1 1 3 1 3 2 1 1 3 1 2 2 2
[297] 2 3 2 2 3 2 1 3 3 1 2 1 1 1 1 2 2 3 2 1 3 1 1 2 3 3 2 2 3 3 1 1 1 2 2 1 3
[334] 1 3 3 3 1 1 1 2 2 2 1 3 3 3 1 1 3 1 2 2 3 2 2 1 1 1 1 1 3 3 1 2 3 3 2 1 3
[371] 1 2 3 3 3 2 1 3 2 3 3 3 3 2 1 3 2 3 3 3 1 1 1 1 2 2 1 3 3 3 3 2 3 1 1 3 1
[408] 3 2 2 2 1 2 2 3 1 2 3 3 2 3 1 2 3 1 1 3 3 1 1 3 2 2 1 3 1 3 2 2 3 2 3 1 1
[445] 2 1 1 2 3 3 2 1 3 1 2 2 2 2 3 1 1 2 2 3 3 2 3 3 1 3 2 3 1 3 3 1 2 3 3 1 3
[482] 3 3 2 3 3 2 2 3 1 1 1 2 1 3 1 1 3 1 1 3 1 3 3 3 1 3 3 3 3 3 3 1 2 2 3 3 1
[519] 3 1 2 3 2 1 2 2 1 2 3 3 3 3 3 3 1 3 3 3 3 1 3 1 3 2 1 1 2 3 3 1 2 1 3 1 1
[556] 2 1 1 1 1 3 1 3 2 1 3 3 2 2 3 3 3 2 1 3 3 1 1 1 3 3 2 3 3 3 2

Within cluster sum of squares by cluster:
[1] 103  67 108
 (between_SS / total_SS =  57.0 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km3</span>, data <span class="op">=</span> <span class="va">cluster_data</span>,</span>
<span>             geom <span class="op">=</span> <span class="st">"point"</span>, ellipse.type <span class="op">=</span> <span class="st">"convex"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means (k=3) Clustering on Knowledge vs. Motivation"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">combined_scores</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">km3</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare mean knowledge &amp; motivation by cluster</span></span>
<span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    mean_knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">composite_knowledge</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">composite_motivation</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 4
  cluster     n mean_knowledge mean_motivation
  &lt;fct&gt;   &lt;int&gt;          &lt;dbl&gt;           &lt;dbl&gt;
1 1         184         -0.794            1.22
2 2         167          0.469            1.44
3 3         235          0.288            2.49</code></pre>
</div>
</div>
<hr>
<p>#1b</p>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">attari1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">attari2_scores</span>, by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">els_scores</span>, by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">rs_scores</span>, by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rename columns for clarity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"perceived_difficulty"</span>, <span class="st">"numeracy"</span>, </span>
<span>                          <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, </span>
<span>                          <span class="st">"els_accuracy"</span>, <span class="st">"els_score"</span>,</span>
<span>                          <span class="st">"env_attitude"</span>, <span class="st">"env_attitude_z"</span>,</span>
<span>                          <span class="st">"pol_conservatism"</span>, <span class="st">"pol_conservatism_z"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">km_result</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create composite knowledge score</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">composite_knowledge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"numeracy"</span>, <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, <span class="st">"els_score"</span><span class="op">)</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create standardized scores for profile analysis</span></span>
<span><span class="va">profile_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">cluster</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, </span>
<span>         <span class="va">els_score</span>, <span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">gather</span><span class="op">(</span><span class="va">measure</span>, <span class="va">value</span>, <span class="op">-</span><span class="va">id</span>, <span class="op">-</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">measure</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>z_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create profile plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">profile_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">measure</span>, y <span class="op">=</span> <span class="va">z_score</span>, color <span class="op">=</span> <span class="va">cluster</span>, group <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"line"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Knowledge-Motivation Profiles by Cluster"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Measure"</span>, y <span class="op">=</span> <span class="st">"Standardized Score"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Canonical Correlation Analysis between Knowledge and Motivation Sets</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CCA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">select</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span></span>
<span></span>
<span><span class="co"># Prepare matrices</span></span>
<span><span class="va">knowledge_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">motivation_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform CCA</span></span>
<span><span class="va">cc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cancor.html">cancor</a></span><span class="op">(</span><span class="va">knowledge_vars</span>, <span class="va">motivation_vars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Network Analysis to Visualize Variable Relationships</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">qgraph</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create correlation matrix</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>                   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>                         <span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span>, <span class="va">pol_conservatism</span><span class="op">)</span>,</span>
<span>                 use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create network plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qgraph/man/qgraph.html">qgraph</a></span><span class="op">(</span><span class="va">cor_matrix</span>, </span>
<span>       layout <span class="op">=</span> <span class="st">"spring"</span>,</span>
<span>       groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Knowledge <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, Motivation <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>,</span>
<span>       color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"lightgreen"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 4. Mixed Effects Model to Account for Potential Group-Level Effects</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/">lme4</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mixed_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">els_score</span> <span class="op">~</span> <span class="va">env_attitude</span> <span class="op">+</span> <span class="va">perceived_difficulty</span> <span class="op">+</span> </span>
<span>                     <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">cluster</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mixed_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: els_score ~ env_attitude + perceived_difficulty + (1 | cluster)
   Data: combined_scores

REML criterion at convergence: 1432

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.446 -0.743  0.019  0.716  2.054 

Random effects:
 Groups   Name        Variance Std.Dev.
 cluster  (Intercept) 0.583    0.763   
 Residual             0.650    0.806   
Number of obs: 586, groups:  cluster, 3

Fixed effects:
                     Estimate Std. Error t value
(Intercept)           -0.1027     0.4782   -0.21
env_attitude           0.0172     0.0515    0.33
perceived_difficulty   0.0600     0.0386    1.55

Correlation of Fixed Effects:
            (Intr) env_tt
env_attitud -0.382       
prcvd_dffcl -0.095  0.244</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 5. Structural Equation Model for Path Analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  # Measurement model</span></span>
<span><span class="st">  knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span><span class="st">  motivation =~ env_attitude + perceived_difficulty + pol_conservatism</span></span>
<span><span class="st"></span></span>
<span><span class="st">  # Structural model</span></span>
<span><span class="st">  knowledge ~ motivation</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="co"># Fit model</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 36 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        15

  Number of observations                           586

Model Test User Model:
                                                      
  Test statistic                                48.061
  Degrees of freedom                                13
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               765.733
  Degrees of freedom                                21
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.953
  Tucker-Lewis Index (TLI)                       0.924

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -5510.805
  Loglikelihood unrestricted model (H1)      -5486.775
                                                      
  Akaike (AIC)                               11051.610
  Bayesian (BIC)                             11117.210
  Sample-size adjusted Bayesian (SABIC)      11069.590

Root Mean Square Error of Approximation:

  RMSEA                                          0.068
  90 Percent confidence interval - lower         0.048
  90 Percent confidence interval - upper         0.089
  P-value H_0: RMSEA &lt;= 0.050                    0.068
  P-value H_0: RMSEA &gt;= 0.080                    0.180

Standardized Root Mean Square Residual:

  SRMR                                           0.045

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  knowledge =~                                                          
    numeracy          1.000                               0.534    0.534
    energy_use        1.441    0.131   10.978    0.000    0.769    0.769
    energy_save       1.331    0.123   10.786    0.000    0.710    0.711
    els_score         1.024    0.109    9.393    0.000    0.546    0.547
  motivation =~                                                         
    env_attitude      1.000                               0.506    0.657
    percvd_dffclty   -1.068    0.142   -7.515    0.000   -0.540   -0.541
    pol_conservtsm   -1.159    0.175   -6.635    0.000   -0.586   -0.413

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  knowledge ~                                                           
    motivation        0.609    0.094    6.497    0.000    0.577    0.577

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .numeracy          0.714    0.047   15.120    0.000    0.714    0.715
   .energy_use        0.408    0.042    9.619    0.000    0.408    0.408
   .energy_save       0.494    0.042   11.665    0.000    0.494    0.495
   .els_score         0.700    0.047   14.976    0.000    0.700    0.701
   .env_attitude      0.337    0.037    9.074    0.000    0.337    0.569
   .percvd_dffclty    0.706    0.056   12.591    0.000    0.706    0.708
   .pol_conservtsm    1.668    0.111   14.976    0.000    1.668    0.829
   .knowledge         0.190    0.034    5.553    0.000    0.667    0.667
    motivation        0.256    0.042    6.021    0.000    1.000    1.000</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 6. Classification Tree for Predicting Knowledge Levels</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bethatkinson/rpart">rpart</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.milbo.org/rpart-plot/index.html">rpart.plot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create binary knowledge indicator (high/low) based on median split</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">knowledge_level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">$</span><span class="va">composite_knowledge</span> <span class="op">&gt;</span> </span>
<span>                                               <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">$</span><span class="va">composite_knowledge</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                                               <span class="st">"High"</span>, <span class="st">"Low"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit tree</span></span>
<span><span class="va">tree_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">knowledge_level</span> <span class="op">~</span> <span class="va">env_attitude</span> <span class="op">+</span> <span class="va">perceived_difficulty</span> <span class="op">+</span> </span>
<span>                     <span class="va">pol_conservatism</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot tree</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/rpart.plot/man/rpart.plot.html">rpart.plot</a></span><span class="op">(</span><span class="va">tree_model</span>, extra <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<section id="b" class="level1"><h1>2b</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mclust-org.github.io/mclust/">mclust</a></span><span class="op">)</span></span>
<span><span class="va">lpa_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lpa_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>---------------------------------------------------- 
Gaussian finite mixture model fitted by EM algorithm 
---------------------------------------------------- 

Mclust VEE (ellipsoidal, equal shape and orientation) model with 8 components: 

 log-likelihood   n df    BIC    ICL
          -4869 586 98 -10362 -10419

Clustering table:
  1   2   3   4   5   6   7   8 
 54 123 115  30  81  68  83  32 </code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lpa_model</span>, <span class="st">"BIC"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">can_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cancor.html">cancor</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">combined_scores</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">combined_scores</span>, <span class="va">env_attitude_z</span>, <span class="va">perceived_difficulty</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">can_cor</span><span class="op">$</span><span class="va">cor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.324 0.084</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, <span class="fu">cluster</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/cluster/man/pam.html">pam</a></span>, method <span class="op">=</span> <span class="st">"silhouette"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Silhouette Method for Optimal k"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sem_model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  knowledge =~ numeracy + energy_use + energy_save + els_accuracy</span></span>
<span><span class="st">  motivation =~ env_attitude_z + perceived_difficulty</span></span>
<span><span class="st">  knowledge ~ motivation</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">sem_model</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 34 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        13

  Number of observations                           586

Model Test User Model:
                                                      
  Test statistic                                23.012
  Degrees of freedom                                 8
  P-value (Chi-square)                           0.003

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  knowledge =~                                                          
    numeracy          1.000                               0.527    0.527
    energy_use        1.469    0.136   10.825    0.000    0.774    0.774
    energy_save       1.352    0.127   10.662    0.000    0.712    0.713
    els_accuracy      1.925    0.208    9.263    0.000    1.014    0.543
  motivation =~                                                         
    env_attitude_z    1.000                               0.618    0.619
    percvd_dffclty   -1.006    0.160   -6.283    0.000   -0.622   -0.623

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  knowledge ~                                                           
    motivation        0.450    0.076    5.903    0.000    0.529    0.529

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .numeracy          0.721    0.047   15.176    0.000    0.721    0.722
   .energy_use        0.400    0.043    9.282    0.000    0.400    0.400
   .energy_save       0.491    0.043   11.489    0.000    0.491    0.492
   .els_accuracy      2.463    0.164   15.004    0.000    2.463    0.705
   .env_attitude_z    0.616    0.070    8.860    0.000    0.616    0.617
   .percvd_dffclty    0.611    0.070    8.726    0.000    0.611    0.612
   .knowledge         0.200    0.036    5.586    0.000    0.721    0.721
    motivation        0.382    0.075    5.087    0.000    1.000    1.000</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">env_attitude_z</span><span class="op">)</span>, </span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 5
  cluster numeracy_mean numeracy_sd env_attitude_z_mean env_attitude_z_sd
  &lt;fct&gt;           &lt;dbl&gt;       &lt;dbl&gt;               &lt;dbl&gt;             &lt;dbl&gt;
1 1              -0.802       0.983           -0.679                0.890
2 2               0.187       0.774            0.000799             0.869
3 3               0.480       0.761            0.525                0.848</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lpa_model</span>, <span class="st">"BIC"</span><span class="op">)</span> <span class="co"># Visualize model selection</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lpa_3class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, G<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co"># Force 3-class solution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lpa_3class</span>, parameters<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>---------------------------------------------------- 
Gaussian finite mixture model fitted by EM algorithm 
---------------------------------------------------- 

Mclust VEE (ellipsoidal, equal shape and orientation) model with 3 components: 

 log-likelihood   n df    BIC    ICL
          -5302 586 53 -10943 -11055

Clustering table:
  1   2   3 
236 270  80 

Mixing probabilities:
   1    2    3 
0.39 0.46 0.16 

Means:
                             [,1]  [,2]  [,3]
numeracy_score              0.108  0.31 -1.18
relative_energy_use_score  -0.010  0.26 -0.74
relative_energy_save_score -0.021  0.32 -0.89
els                         0.069  0.28 -0.98
perceived_difficulty_score -0.163 -0.20  0.99
env_attitude               -0.196  0.32 -0.46
pol_conservatism            0.889 -0.95  0.58

Variances:
[,,1]
                           numeracy_score relative_energy_use_score
numeracy_score                      0.800                      0.27
relative_energy_use_score           0.266                      0.97
relative_energy_save_score          0.151                      0.47
els                                 0.127                      0.27
perceived_difficulty_score          0.087                     -0.11
env_attitude                        0.088                      0.13
pol_conservatism                   -0.051                     -0.05
                           relative_energy_save_score     els
numeracy_score                                 0.1511  0.1272
relative_energy_use_score                      0.4697  0.2750
relative_energy_save_score                     0.9038  0.2033
els                                            0.2033  0.8974
perceived_difficulty_score                    -0.0940 -0.0432
env_attitude                                   0.1237  0.1850
pol_conservatism                               0.0079 -0.0076
                           perceived_difficulty_score env_attitude
numeracy_score                                  0.087        0.088
relative_energy_use_score                      -0.108        0.133
relative_energy_save_score                     -0.094        0.124
els                                            -0.043        0.185
perceived_difficulty_score                      0.890       -0.326
env_attitude                                   -0.326        0.996
pol_conservatism                                0.014       -0.044
                           pol_conservatism
numeracy_score                      -0.0507
relative_energy_use_score           -0.0504
relative_energy_save_score           0.0079
els                                 -0.0076
perceived_difficulty_score           0.0139
env_attitude                        -0.0441
pol_conservatism                     0.2415
[,,2]
                           numeracy_score relative_energy_use_score
numeracy_score                      0.658                     0.219
relative_energy_use_score           0.219                     0.798
relative_energy_save_score          0.124                     0.386
els                                 0.105                     0.226
perceived_difficulty_score          0.071                    -0.089
env_attitude                        0.073                     0.109
pol_conservatism                   -0.042                    -0.041
                           relative_energy_save_score     els
numeracy_score                                 0.1243  0.1046
relative_energy_use_score                      0.3863  0.2262
relative_energy_save_score                     0.7434  0.1672
els                                            0.1672  0.7381
perceived_difficulty_score                    -0.0773 -0.0355
env_attitude                                   0.1018  0.1522
pol_conservatism                               0.0065 -0.0063
                           perceived_difficulty_score env_attitude
numeracy_score                                  0.071        0.073
relative_energy_use_score                      -0.089        0.109
relative_energy_save_score                     -0.077        0.102
els                                            -0.036        0.152
perceived_difficulty_score                      0.732       -0.268
env_attitude                                   -0.268        0.819
pol_conservatism                                0.011       -0.036
                           pol_conservatism
numeracy_score                      -0.0417
relative_energy_use_score           -0.0415
relative_energy_save_score           0.0065
els                                 -0.0063
perceived_difficulty_score           0.0114
env_attitude                        -0.0363
pol_conservatism                     0.1987
[,,3]
                           numeracy_score relative_energy_use_score
numeracy_score                      0.785                     0.261
relative_energy_use_score           0.261                     0.952
relative_energy_save_score          0.148                     0.461
els                                 0.125                     0.270
perceived_difficulty_score          0.085                    -0.106
env_attitude                        0.087                     0.130
pol_conservatism                   -0.050                    -0.049
                           relative_energy_save_score     els
numeracy_score                                 0.1483  0.1248
relative_energy_use_score                      0.4608  0.2698
relative_energy_save_score                     0.8868  0.1994
els                                            0.1994  0.8806
perceived_difficulty_score                    -0.0922 -0.0424
env_attitude                                   0.1214  0.1816
pol_conservatism                               0.0078 -0.0075
                           perceived_difficulty_score env_attitude
numeracy_score                                  0.085        0.087
relative_energy_use_score                      -0.106        0.130
relative_energy_save_score                     -0.092        0.121
els                                            -0.042        0.182
perceived_difficulty_score                      0.874       -0.320
env_attitude                                   -0.320        0.977
pol_conservatism                                0.014       -0.043
                           pol_conservatism
numeracy_score                      -0.0498
relative_energy_use_score           -0.0494
relative_energy_save_score           0.0078
els                                 -0.0075
perceived_difficulty_score           0.0136
env_attitude                        -0.0432
pol_conservatism                     0.2370</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lpa_3class</span>, what<span class="op">=</span><span class="st">"classification"</span><span class="op">)</span> <span class="co"># Visualize classification</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Interpret canonical variables</span></span>
<span><span class="va">cancor_loadings</span> <span class="op">&lt;-</span> <span class="va">can_cor</span><span class="op">$</span><span class="va">xcoef</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">rownames_to_column</span><span class="op">(</span><span class="st">"variable"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>Dimension1<span class="op">=</span><span class="va">V1</span>, Dimension2<span class="op">=</span><span class="va">V2</span>, Dimension3<span class="op">=</span><span class="va">V3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cancor_loadings</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     variable Dimension1 Dimension2 Dimension3
1    numeracy      0.010      0.045    0.00041
2  energy_use      0.017     -0.019    0.04573
3 energy_save      0.023     -0.012   -0.04353</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Improve SEM specification</span></span>
<span><span class="va">sem_improved</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  knowledge =~ numeracy + energy_use + energy_save + els_accuracy</span></span>
<span><span class="st">  motivation =~ env_attitude_z + perceived_difficulty</span></span>
<span><span class="st">  knowledge ~ motivation</span></span>
<span><span class="st">  els_accuracy ~~ energy_use # Add residual covariance</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_improved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">sem_improved</span>, data<span class="op">=</span><span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_improved</span>, fit.measures<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 37 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

  Number of observations                           586

Model Test User Model:
                                                      
  Test statistic                                19.280
  Degrees of freedom                                 7
  P-value (Chi-square)                           0.007

Model Test Baseline Model:

  Test statistic                               680.231
  Degrees of freedom                                15
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.982
  Tucker-Lewis Index (TLI)                       0.960

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -5022.340
  Loglikelihood unrestricted model (H1)      -5012.700
                                                      
  Akaike (AIC)                               10072.681
  Bayesian (BIC)                             10133.907
  Sample-size adjusted Bayesian (SABIC)      10089.462

Root Mean Square Error of Approximation:

  RMSEA                                          0.055
  90 Percent confidence interval - lower         0.026
  90 Percent confidence interval - upper         0.085
  P-value H_0: RMSEA &lt;= 0.050                    0.350
  P-value H_0: RMSEA &gt;= 0.080                    0.085

Standardized Root Mean Square Residual:

  SRMR                                           0.029

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  knowledge =~                                        
    numeracy          1.000                           
    energy_use        1.551    0.154   10.076    0.000
    energy_save       1.312    0.122   10.768    0.000
    els_accuracy      2.123    0.248    8.545    0.000
  motivation =~                                       
    env_attitude_z    1.000                           
    percvd_dffclty   -0.999    0.158   -6.311    0.000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  knowledge ~                                         
    motivation        0.436    0.075    5.812    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
 .energy_use ~~                                       
   .els_accuracy     -0.150    0.077   -1.946    0.052

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .numeracy          0.727    0.048   15.278    0.000
   .energy_use        0.346    0.054    6.423    0.000
   .energy_save       0.531    0.046   11.596    0.000
   .els_accuracy      2.269    0.189   11.994    0.000
   .env_attitude_z    0.613    0.070    8.811    0.000
   .percvd_dffclty    0.614    0.069    8.836    0.000
   .knowledge         0.198    0.035    5.650    0.000
    motivation        0.385    0.075    5.111    0.000</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 4. Validate clusters with outcomes</span></span>
<span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>recycling_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">env_attitude_z</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            energy_behavior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">energy_save</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">cluster</span>, names_to<span class="op">=</span><span class="st">"outcome"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">cluster</span>, y<span class="op">=</span><span class="va">value</span>, fill<span class="op">=</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Cluster Validation Through Behavioral Outcomes"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-10-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="b-1" class="level1"><h1>3b</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combine all items into a single dataframe</span></span>
<span><span class="va">all_items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">aes_combined</span>, <span class="va">att2_combined</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">els</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">rs</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select only item columns for factor analysis</span></span>
<span><span class="va">item_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">all_items</span><span class="op">)</span>, <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="va">item_data</span> <span class="op">&lt;-</span> <span class="va">all_items</span><span class="op">[</span>, <span class="va">item_columns</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Perform factor analysis</span></span>
<span><span class="va">fa_items</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="va">item_data</span>, nfactors <span class="op">=</span> <span class="fl">5</span>, rotate <span class="op">=</span> <span class="st">"varimax"</span><span class="op">)</span>  <span class="co"># Adjust nfactors as needed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fa_items</span>, cut <span class="op">=</span> <span class="fl">0.3</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = item_data, nfactors = 5, rotate = "varimax")
Standardized loadings (pattern matrix) based upon correlation matrix
      item   MR1   MR2   MR5   MR3   MR4    h2    u2 com
ATT25   25  0.94                         0.903 0.097 1.0
ATT23   23  0.90                         0.865 0.135 1.1
ATT27   27  0.89                         0.804 0.196 1.0
ATT26   26  0.89                         0.810 0.190 1.0
ATT24   24  0.82                         0.767 0.233 1.3
ATT33   33  0.70                         0.622 0.378 1.5
ATT32   32  0.61                         0.424 0.576 1.3
ATT30   30  0.56        0.40             0.572 0.428 2.6
ATT31   31  0.42                         0.258 0.742 1.9
ELS08   41                               0.026 0.974 3.2
ATT10   10        0.63                   0.455 0.545 1.3
ATT15   15        0.63       -0.37       0.537 0.463 1.7
ATT09    9        0.62                   0.456 0.544 1.3
ATT14   14        0.62       -0.34       0.516 0.484 1.6
ATT06    6        0.61                   0.401 0.599 1.2
ATT07    7        0.56                   0.337 0.663 1.1
ATT08    8        0.55                   0.313 0.687 1.0
ATT13   13        0.54                   0.317 0.683 1.2
ATT03    3        0.49        0.36       0.367 0.633 1.9
ATT12   12        0.48                   0.256 0.744 1.2
ATT05    5        0.48        0.37       0.362 0.638 1.9
ATT04    4        0.47                   0.235 0.765 1.1
ATT01    1        0.42        0.31       0.275 0.725 1.9
RS01    42       -0.40                   0.248 0.752 2.0
RS02    43                               0.083 0.917 1.2
ATT11   11                               0.070 0.930 1.5
ELS01   34                               0.037 0.963 2.8
ATT20   20              0.92             0.915 0.085 1.2
ATT21   21  0.35        0.79             0.759 0.241 1.4
ATT22   22              0.73             0.610 0.390 1.3
RS03    44       -0.37        0.59       0.503 0.497 1.8
RS04    45                    0.46       0.256 0.744 1.5
RS05    46                    0.44       0.212 0.788 1.2
RS06    47                    0.38       0.158 0.842 1.2
ATT17   17                   -0.36       0.166 0.834 1.5
ELS02   35                    0.34       0.132 0.868 1.2
ATT18   18                               0.139 0.861 2.6
ELS03   36                               0.073 0.927 1.4
ATT02    2                               0.111 0.889 2.2
ELS04   37                               0.038 0.962 1.3
ELS07   40                               0.039 0.961 1.9
ATT19   19                               0.028 0.972 1.1
ELS05   38                               0.022 0.978 1.4
ATT28   28                          0.94 0.888 0.112 1.0
ATT29   29                          0.90 0.827 0.173 1.0
ATT16   16                               0.024 0.976 1.1
ELS06   39                               0.027 0.973 4.0

                       MR1  MR2  MR5  MR3  MR4
SS loadings           5.69 4.67 2.52 2.38 1.98
Proportion Var        0.12 0.10 0.05 0.05 0.04
Cumulative Var        0.12 0.22 0.27 0.32 0.37
Proportion Explained  0.33 0.27 0.15 0.14 0.11
Cumulative Proportion 0.33 0.60 0.75 0.89 1.00

Mean item complexity =  1.6
Test of the hypothesis that 5 factors are sufficient.

df null model =  1081  with the objective function =  27 with Chi Square =  15130
df of  the model are 856  and the objective function was  8.8 

The root mean square of the residuals (RMSR) is  0.05 
The df corrected root mean square of the residuals is  0.06 

The harmonic n.obs is  586 with the empirical chi square  3813  with prob &lt;  0 
The total n.obs was  586  with Likelihood Chi Square =  4950  with prob &lt;  0 

Tucker Lewis Index of factoring reliability =  0.63
RMSEA index =  0.09  and the 90 % confidence intervals are  0.088 0.093
BIC =  -506
Fit based upon off diagonal values = 0.91
Measures of factor score adequacy             
                                                   MR1  MR2  MR5  MR3  MR4
Correlation of (regression) scores with factors   0.98 0.93 0.97 0.87 0.97
Multiple R square of scores with factors          0.97 0.87 0.94 0.76 0.93
Minimum correlation of possible factor scores     0.94 0.75 0.88 0.52 0.87</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example SEM model (using lavaan)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  # Measurement model</span></span>
<span><span class="st">  Knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span><span class="st">  Motivation =~ env_attitude_z + perceived_difficulty</span></span>
<span><span class="st"></span></span>
<span><span class="st">  # Structural model</span></span>
<span><span class="st">  Knowledge ~ Motivation</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 32 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        13

  Number of observations                           586

Model Test User Model:
                                                      
  Test statistic                                23.012
  Degrees of freedom                                 8
  P-value (Chi-square)                           0.003

Model Test Baseline Model:

  Test statistic                               680.231
  Degrees of freedom                                15
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.977
  Tucker-Lewis Index (TLI)                       0.958

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -4657.376
  Loglikelihood unrestricted model (H1)      -4645.870
                                                      
  Akaike (AIC)                                9340.753
  Bayesian (BIC)                              9397.606
  Sample-size adjusted Bayesian (SABIC)       9356.335

Root Mean Square Error of Approximation:

  RMSEA                                          0.057
  90 Percent confidence interval - lower         0.030
  90 Percent confidence interval - upper         0.084
  P-value H_0: RMSEA &lt;= 0.050                    0.305
  P-value H_0: RMSEA &gt;= 0.080                    0.086

Standardized Root Mean Square Residual:

  SRMR                                           0.032

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Knowledge =~                                                          
    numeracy          1.000                               0.527    0.527
    energy_use        1.469    0.136   10.825    0.000    0.774    0.774
    energy_save       1.352    0.127   10.662    0.000    0.712    0.713
    els_score         1.029    0.111    9.263    0.000    0.542    0.543
  Motivation =~                                                         
    env_attitude_z    1.000                               0.618    0.619
    percvd_dffclty   -1.006    0.160   -6.283    0.000   -0.622   -0.623

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Knowledge ~                                                           
    Motivation        0.450    0.076    5.903    0.000    0.529    0.529

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .numeracy          0.721    0.047   15.176    0.000    0.721    0.722
   .energy_use        0.400    0.043    9.282    0.000    0.400    0.400
   .energy_save       0.491    0.043   11.489    0.000    0.491    0.492
   .els_score         0.704    0.047   15.004    0.000    0.704    0.705
   .env_attitude_z    0.616    0.070    8.860    0.000    0.616    0.617
   .percvd_dffclty    0.611    0.070    8.726    0.000    0.611    0.612
   .Knowledge         0.200    0.036    5.586    0.000    0.721    0.721
    Motivation        0.382    0.075    5.087    0.000    1.000    1.000</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example LPA (using tidyLPA)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://data-edu.github.io/tidyLPA/">tidyLPA</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">lpa_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>, <span class="va">env_attitude_z</span>, <span class="va">perceived_difficulty</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># convert all to numeric</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="va">as.numeric</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lpa_results</span> <span class="op">&lt;-</span> <span class="va">lpa_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://data-edu.github.io/tidyLPA/reference/estimate_profiles.html">estimate_profiles</a></span><span class="op">(</span>n_profiles <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># Estimate models with 1-5 profiles</span></span>
<span>  <span class="fu"><a href="https://data-edu.github.io/tidyLPA/reference/compare_solutions.html">compare_solutions</a></span><span class="op">(</span>statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lpa_results</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Determine optimal k using silhouette method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"silhouette"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Silhouette Method for Optimal k"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example of cluster stability assessment (using fpc package)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.unibo.it/sitoweb/christian.hennig/en/">fpc</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">clusterboot_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fpc/man/clusterboot.html">clusterboot</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, B <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                                  bootmethod <span class="op">=</span> <span class="st">"boot"</span>, clustermethod <span class="op">=</span> <span class="va">kmeansCBI</span>,</span>
<span>                                  krange <span class="op">=</span> <span class="fl">3</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>boot 1 
boot 2 
boot 3 
boot 4 
boot 5 
boot 6 
boot 7 
boot 8 
boot 9 
boot 10 
boot 11 
boot 12 
boot 13 
boot 14 
boot 15 
boot 16 
boot 17 
boot 18 
boot 19 
boot 20 
boot 21 
boot 22 
boot 23 
boot 24 
boot 25 
boot 26 
boot 27 
boot 28 
boot 29 
boot 30 
boot 31 
boot 32 
boot 33 
boot 34 
boot 35 
boot 36 
boot 37 
boot 38 
boot 39 
boot 40 
boot 41 
boot 42 
boot 43 
boot 44 
boot 45 
boot 46 
boot 47 
boot 48 
boot 49 
boot 50 
boot 51 
boot 52 
boot 53 
boot 54 
boot 55 
boot 56 
boot 57 
boot 58 
boot 59 
boot 60 
boot 61 
boot 62 
boot 63 
boot 64 
boot 65 
boot 66 
boot 67 
boot 68 
boot 69 
boot 70 
boot 71 
boot 72 
boot 73 
boot 74 
boot 75 
boot 76 
boot 77 
boot 78 
boot 79 
boot 80 
boot 81 
boot 82 
boot 83 
boot 84 
boot 85 
boot 86 
boot 87 
boot 88 
boot 89 
boot 90 
boot 91 
boot 92 
boot 93 
boot 94 
boot 95 
boot 96 
boot 97 
boot 98 
boot 99 
boot 100 </code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">clusterboot_result</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>* Cluster stability assessment *
Cluster method:  kmeans 
Full clustering results are given as parameter result
of the clusterboot object, which also provides further statistics
of the resampling results.
Number of resampling runs:  100 

Number of clusters found in data:  3 

 Clusterwise Jaccard bootstrap (omitting multiple points) mean:
[1] 0.82 0.68 0.74
dissolved:
[1]  0 26 16
recovered:
[1] 68 45 57</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1) Create a correlation matrix of the key knowledge &amp; motivation subscales</span></span>
<span><span class="co">#    ensuring no duplicates (e.g., pick either 'env_attitude' or 'env_attitude_z').</span></span>
<span></span>
<span><span class="va">cor_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>         <span class="va">perceived_difficulty</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2) Compute correlations</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">cor_vars</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3) Visualize</span></span>
<span><span class="fu">corrplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">cor_matrix</span>, method <span class="op">=</span> <span class="st">"color"</span>, type<span class="op">=</span><span class="st">"upper"</span>, </span>
<span>                   tl.col<span class="op">=</span><span class="st">"black"</span>, addCoef.col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fa_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>         <span class="va">perceived_difficulty</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fa_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html">fa</a></span><span class="op">(</span><span class="va">fa_data</span>, nfactors <span class="op">=</span> <span class="fl">2</span>, rotate <span class="op">=</span> <span class="st">"varimax"</span>, fm <span class="op">=</span> <span class="st">"ml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fa_result</span>, cut<span class="op">=</span><span class="fl">0.3</span>, sort<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  ml
Call: fa(r = fa_data, nfactors = 2, rotate = "varimax", fm = "ml")
Standardized loadings (pattern matrix) based upon correlation matrix
                     item   ML2   ML1   h2    u2 com
energy_use              2  0.78       0.63 0.374 1.1
energy_save             3  0.69       0.50 0.497 1.1
numeracy                1  0.51       0.28 0.720 1.2
els_score               4  0.49       0.29 0.709 1.4
pol_conservatism        7             0.14 0.860 2.0
env_attitude            6        0.99 1.00 0.005 1.0
perceived_difficulty    5       -0.37 0.19 0.807 1.7

                       ML2  ML1
SS loadings           1.71 1.31
Proportion Var        0.24 0.19
Cumulative Var        0.24 0.43
Proportion Explained  0.57 0.43
Cumulative Proportion 0.57 1.00

Mean item complexity =  1.4
Test of the hypothesis that 2 factors are sufficient.

df null model =  21  with the objective function =  1.3 with Chi Square =  760
df of  the model are 8  and the objective function was  0.03 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.04 

The harmonic n.obs is  586 with the empirical chi square  18  with prob &lt;  0.025 
The total n.obs was  586  with Likelihood Chi Square =  16  with prob &lt;  0.036 

Tucker Lewis Index of factoring reliability =  0.97
RMSEA index =  0.042  and the 90 % confidence intervals are  0.01 0.072
BIC =  -35
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   ML2  ML1
Correlation of (regression) scores with factors   0.87 1.00
Multiple R square of scores with factors          0.77 0.99
Minimum correlation of possible factor scores     0.53 0.99</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_motivation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">env_attitude</span> <span class="op">~</span> <span class="va">els_score</span> <span class="op">+</span> <span class="va">numeracy</span> <span class="op">+</span> <span class="va">pol_conservatism</span>,</span>
<span>                       data<span class="op">=</span><span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_motivation</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = env_attitude ~ els_score + numeracy + pol_conservatism, 
    data = combined_scores)

Residuals:
   Min     1Q Median     3Q    Max 
-2.320 -0.486  0.020  0.514  1.944 

Coefficients:
                 Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)        3.9098     0.0646   60.48 &lt; 0.0000000000000002 ***
els_score          0.1575     0.0318    4.95           0.00000098 ***
numeracy           0.0555     0.0323    1.72                0.086 .  
pol_conservatism  -0.1239     0.0218   -5.69           0.00000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.72 on 582 degrees of freedom
Multiple R-squared:  0.135, Adjusted R-squared:  0.131 
F-statistic: 30.3 on 3 and 582 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_knowledge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els_score</span> <span class="op">~</span> <span class="va">perceived_difficulty</span> <span class="op">+</span> <span class="va">env_attitude</span> <span class="op">+</span> <span class="va">pol_conservatism</span>,</span>
<span>                      data<span class="op">=</span><span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_knowledge</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els_score ~ perceived_difficulty + env_attitude + 
    pol_conservatism, data = combined_scores)

Residuals:
   Min     1Q Median     3Q    Max 
-3.171 -0.646 -0.004  0.716  2.333 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           -0.6422     0.2390   -2.69   0.0074 ** 
perceived_difficulty  -0.1338     0.0425   -3.15   0.0017 ** 
env_attitude           0.2421     0.0571    4.24 0.000026 ***
pol_conservatism      -0.0854     0.0289   -2.96   0.0032 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.95 on 582 degrees of freedom
Multiple R-squared:  0.104, Adjusted R-squared:  0.0992 
F-statistic: 22.5 on 3 and 582 DF,  p-value: 0.0000000000000872</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">knowledge_only</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="co"># Decide k with elbow or silhouette</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">knowledge_only</span>, <span class="va">kmeans</span>, method<span class="op">=</span><span class="st">"wss"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">km_knowl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">knowledge_only</span>, centers<span class="op">=</span><span class="fl">3</span>, nstart<span class="op">=</span><span class="fl">25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_knowl</span>, data <span class="op">=</span> <span class="va">knowledge_only</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>         <span class="va">perceived_difficulty</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">all_vars</span>, <span class="va">kmeans</span>, method<span class="op">=</span><span class="st">"wss"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">km_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">all_vars</span>, centers<span class="op">=</span><span class="fl">3</span>, nstart<span class="op">=</span><span class="fl">25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_all</span>, data<span class="op">=</span><span class="va">all_vars</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-12-5.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1. Summarize clusters on an extra measure</span></span>
<span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    mean_recycling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">env_attitude_z</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_recycling   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">env_attitude_z</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 4
  cluster mean_recycling sd_recycling     n
  &lt;fct&gt;            &lt;dbl&gt;        &lt;dbl&gt; &lt;int&gt;
1 1            -0.679           0.890   179
2 2             0.000799        0.869   176
3 3             0.525           0.848   231</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. ANOVA to test whether clusters differ significantly </span></span>
<span><span class="va">anova_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">env_attitude_z</span> <span class="op">~</span> <span class="va">cluster</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value              Pr(&gt;F)    
cluster       2    146    73.1    97.1 &lt;0.0000000000000002 ***
Residuals   583    439     0.8                                
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Pairwise comparisons if ANOVA is significant</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = env_attitude_z ~ cluster, data = combined_scores)

$cluster
    diff  lwr  upr p adj
2-1 0.68 0.46 0.90     0
3-1 1.20 1.00 1.41     0
3-2 0.52 0.32 0.73     0</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mclust-org.github.io/mclust/">mclust</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Subset data to knowledge &amp; motivation variables</span></span>
<span><span class="va">lpa_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>, </span>
<span>         <span class="va">perceived_difficulty</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model-based clustering</span></span>
<span><span class="va">lpa_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">lpa_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lpa_model</span><span class="op">)</span>  <span class="co"># Tells you how many clusters &amp; the type of covariance structure</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>---------------------------------------------------- 
Gaussian finite mixture model fitted by EM algorithm 
---------------------------------------------------- 

Mclust VEE (ellipsoidal, equal shape and orientation) model with 8 components: 

 log-likelihood   n df    BIC    ICL
          -4869 586 98 -10362 -10419

Clustering table:
  1   2   3   4   5   6   7   8 
 54 123 115  30  81  68  83  32 </code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract membership</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">LPA_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">lpa_model</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">$</span><span class="va">LPA_cluster</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3   4   5   6   7   8 
 54 123 115  30  81  68  83  32 </code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compare means across the new LPA-based clusters</span></span>
<span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">LPA_cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="va">numeracy</span><span class="op">:</span><span class="va">pol_conservatism</span>, <span class="va">mean</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 Ã— 9
  LPA_cluster numeracy energy_use energy_save els_accuracy els_score
  &lt;fct&gt;          &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;
1 1             1.45       0.453      0.258           5.04    0.222 
2 2             0.106      0.0661     0.146           4.84    0.116 
3 3            -1.50      -0.687     -0.671           3.17   -0.774 
4 4            -1.17       0.146      0.239           4.37   -0.136 
5 5             0.117     -0.130     -0.193           4.79    0.0903
6 6             1.43       0.785      0.659           5.18    0.297 
7 7             0.0666    -0.0178     0.00612         4.67    0.0286
8 8             0.133      0.0197     0.261           6.78    1.16  
# â„¹ 3 more variables: env_attitude &lt;dbl&gt;, env_attitude_z &lt;dbl&gt;,
#   pol_conservatism &lt;dbl&gt;</code></pre>
</div>
</div>
<hr>
<p>#1c</p>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combine all individual survey items from each instrument</span></span>
<span><span class="va">all_items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">aes_combined</span>, <span class="va">att2_combined</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">els</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">rs</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select only item columns for analysis</span></span>
<span><span class="va">item_data</span> <span class="op">&lt;-</span> <span class="va">all_items</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">subscale_cors</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">perceived_difficulty</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>,</span>
<span>         <span class="va">els_score</span>, <span class="va">env_attitude_z</span>, <span class="va">pol_conservatism_z</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># 3. Knowledge-Motivation Relationship Analyses</span></span>
<span><span class="co"># Create composite scores with explicit content alignment</span></span>
<span><span class="va">knowledge_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"numeracy"</span>, <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, <span class="st">"els_score"</span><span class="op">)</span></span>
<span><span class="va">motivation_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"env_attitude_z"</span>, <span class="st">"perceived_difficulty"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">knowledge_vars</span><span class="op">)</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">motivation_vars</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># 3a. Bivariate Correlation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">combined_scores</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">knowledge</span>, <span class="va">motivation</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  knowledge and motivation
t = -0.4, df = 584, p-value = 0.7
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.099  0.063
sample estimates:
   cor 
-0.018 </code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3b. Hierarchical Regression</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">knowledge</span> <span class="op">~</span> <span class="va">motivation</span> <span class="op">+</span> <span class="va">pol_conservatism_z</span> <span class="op">+</span> <span class="va">cluster</span>, </span>
<span>            data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = knowledge ~ motivation + pol_conservatism_z + cluster, 
    data = combined_scores)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.2080 -0.4889 -0.0304  0.4339  2.2729 

Coefficients:
                   Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)         -1.0897     0.0546  -19.96 &lt;0.0000000000000002 ***
motivation          -0.0437     0.0284   -1.54                0.12    
pol_conservatism_z   0.0339     0.0464    0.73                0.46    
cluster2             1.3164     0.0753   17.47 &lt;0.0000000000000002 ***
cluster3             1.7613     0.0933   18.88 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.68 on 581 degrees of freedom
Multiple R-squared:  0.535, Adjusted R-squared:  0.532 
F-statistic:  167 on 4 and 581 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3c. Path Analysis</span></span>
<span><span class="va">path_model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  motivation ~ a * knowledge</span></span>
<span><span class="st">  els_score ~ b * motivation + c * knowledge</span></span>
<span><span class="st">  indirect := a * b</span></span>
<span><span class="st">  total := c + indirect</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">path_model</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 5 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                           586

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  motivation ~                                                          
    knowledge  (a)   -0.018    0.041   -0.439    0.660   -0.018   -0.018
  els_score ~                                                           
    motivation (b)    0.036    0.029    1.229    0.219    0.036    0.036
    knowledge  (c)    0.707    0.029   24.181    0.000    0.707    0.707

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .motivation        0.998    0.058   17.117    0.000    0.998    1.000
   .els_score         0.499    0.029   17.117    0.000    0.499    0.500

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    indirect         -0.001    0.002   -0.414    0.679   -0.001   -0.001
    total             0.706    0.029   24.132    0.000    0.706    0.706</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 4. Cluster Validation by Motivation-Knowledge Profiles</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">combined_scores</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">knowledge</span>, y <span class="op">=</span> <span class="va">motivation</span>, color <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ellipse.html">stat_ellipse</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Knowledge-Motivation Profiles by Cluster"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Standardized Knowledge Composite"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Standardized Motivation Composite"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combine key measures into correlation matrix</span></span>
<span><span class="va">key_measures</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="co"># Knowledge measures</span></span>
<span>    <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>    <span class="co"># Motivation/attitude measures </span></span>
<span>    <span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span>, <span class="va">pol_conservatism</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute and visualize correlation matrix</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">key_measures</span>, use<span class="op">=</span><span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">cor_matrix</span>, </span>
<span>         method<span class="op">=</span><span class="st">"color"</span>,</span>
<span>         type<span class="op">=</span><span class="st">"upper"</span>,</span>
<span>         addCoef.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>         tl.col<span class="op">=</span><span class="st">"black"</span>,</span>
<span>         tl.srt<span class="op">=</span><span class="fl">45</span>,</span>
<span>         diag<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>         col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Factor Analysis to examine underlying structure</span></span>
<span><span class="va">fa_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html">fa</a></span><span class="op">(</span><span class="va">key_measures</span>, nfactors<span class="op">=</span><span class="fl">2</span>, rotate<span class="op">=</span><span class="st">"varimax"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fa_results</span>, cut<span class="op">=</span><span class="fl">0.3</span>, sort<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = key_measures, nfactors = 2, rotate = "varimax")
Standardized loadings (pattern matrix) based upon correlation matrix
                     item   MR1   MR2   h2     u2 com
energy_use              2  0.77       0.61 0.3856 1.1
energy_save             3  0.68       0.49 0.5146 1.1
numeracy                1  0.52       0.29 0.7067 1.2
els_score               4  0.50       0.30 0.6954 1.4
pol_conservatism        7             0.14 0.8570 2.0
env_attitude            5        0.99 1.00 0.0035 1.0
perceived_difficulty    6       -0.36 0.19 0.8120 1.7

                       MR1  MR2
SS loadings           1.72 1.31
Proportion Var        0.25 0.19
Cumulative Var        0.25 0.43
Proportion Explained  0.57 0.43
Cumulative Proportion 0.57 1.00

Mean item complexity =  1.4
Test of the hypothesis that 2 factors are sufficient.

df null model =  21  with the objective function =  1.3 with Chi Square =  760
df of  the model are 8  and the objective function was  0.03 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.04 

The harmonic n.obs is  586 with the empirical chi square  17  with prob &lt;  0.035 
The total n.obs was  586  with Likelihood Chi Square =  17  with prob &lt;  0.029 

Tucker Lewis Index of factoring reliability =  0.97
RMSEA index =  0.044  and the 90 % confidence intervals are  0.014 0.073
BIC =  -34
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   MR1  MR2
Correlation of (regression) scores with factors   0.87 1.00
Multiple R square of scores with factors          0.76 0.99
Minimum correlation of possible factor scores     0.52 0.99</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Create composite scores and analyze relationships</span></span>
<span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Knowledge composite (z-score mean)</span></span>
<span>    knowledge_composite <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">numeracy</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">energy_use</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">energy_save</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">els_score</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co"># Motivation composite</span></span>
<span>    motivation_composite <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">env_attitude</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">perceived_difficulty</span><span class="op">)</span>, </span>
<span>            <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">pol_conservatism</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># 4. Profile Analysis using cluster analysis</span></span>
<span><span class="co"># Standardize variables for clustering</span></span>
<span><span class="va">cluster_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">knowledge_composite</span>, <span class="va">motivation_composite</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Determine optimal number of clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_vars</span>, <span class="va">kmeans</span>, method<span class="op">=</span><span class="st">"silhouette"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform k-means clustering</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">3</span>  <span class="co"># Based on silhouette plot</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_vars</span>, centers<span class="op">=</span><span class="va">k</span>, nstart<span class="op">=</span><span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">clusters</span>, data<span class="op">=</span><span class="va">cluster_vars</span>,</span>
<span>             geom<span class="op">=</span><span class="st">"point"</span>,</span>
<span>             ellipse.type<span class="op">=</span><span class="st">"convex"</span>,</span>
<span>             ggtheme<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Knowledge-Motivation Profiles"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 5. Regression Analysis</span></span>
<span><span class="co"># Model 1: Knowledge predicting motivation</span></span>
<span><span class="va">model_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">motivation_composite</span> <span class="op">~</span> <span class="va">knowledge_composite</span>, data<span class="op">=</span><span class="va">combined_scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model 2: Controlling for demographics if available</span></span>
<span><span class="va">model_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">motivation_composite</span> <span class="op">~</span> <span class="va">knowledge_composite</span> <span class="op">+</span> <span class="va">pol_conservatism</span>, </span>
<span>              data<span class="op">=</span><span class="va">combined_scores</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = motivation_composite ~ knowledge_composite, data = combined_scores)

Residuals:
   Min     1Q Median     3Q    Max 
-3.506 -0.616  0.004  0.651  2.623 

Coefficients:
                                 Estimate            Std. Error t value
(Intercept)         -0.000000000000000109  0.037634207769266410       0
knowledge_composite  0.414061913664111936  0.037666360024399721      11
                               Pr(&gt;|t|)    
(Intercept)                           1    
knowledge_composite &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.91 on 584 degrees of freedom
Multiple R-squared:  0.171, Adjusted R-squared:  0.17 
F-statistic:  121 on 1 and 584 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = motivation_composite ~ knowledge_composite + pol_conservatism, 
    data = combined_scores)

Residuals:
   Min     1Q Median     3Q    Max 
-2.273 -0.465  0.018  0.482  2.119 

Coefficients:
                    Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)           1.0955     0.0649   16.89 &lt; 0.0000000000000002 ***
knowledge_composite   0.2377     0.0311    7.65    0.000000000000081 ***
pol_conservatism     -0.4154     0.0219  -18.99 &lt; 0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.72 on 583 degrees of freedom
Multiple R-squared:  0.488, Adjusted R-squared:  0.486 
F-statistic:  278 on 2 and 583 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 6. Examine cluster profiles</span></span>
<span><span class="va">cluster_profiles</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    mean_knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">knowledge_composite</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">knowledge_composite</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">motivation_composite</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">motivation_composite</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cluster_profiles</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 6
  cluster     n mean_knowledge sd_knowledge mean_motivation sd_motivation
  &lt;fct&gt;   &lt;int&gt;          &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;
1 1         194          0.649        0.787           1.08          0.487
2 2         125         -1.32         0.632          -1.07          0.676
3 3         267          0.145        0.649          -0.285         0.582</code></pre>
</div>
</div>
<p>#3c</p>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Merge them into one "long" dataframe with all items.</span></span>
<span><span class="va">all_items</span> <span class="op">&lt;-</span> <span class="va">aes_combined</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">att2_combined</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">els</span>,           by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">rs</span>,            by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect how many rows (should match total unique respondents if IDs match)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">all_items</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 586  48</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">all_items</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 48
     id ATT01    ATT02   ATT03   ATT04   ATT05   ATT06   ATT07   ATT08   ATT09  
  &lt;int&gt; &lt;dbl+lb&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
1     1 6 [Someâ€¦ 3 [Verâ€¦ 5 [Neiâ€¦ 6 [Somâ€¦ 6 [Somâ€¦ 5 [Neiâ€¦ 5 [Neiâ€¦ 5 [Neiâ€¦ 4 [Somâ€¦
2     2 7 [Veryâ€¦ 2 [Extâ€¦ 5 [Neiâ€¦ 1 [Do â€¦ 7 [Verâ€¦ 1 [Do â€¦ 1 [Do â€¦ 4 [Somâ€¦ 4 [Somâ€¦
3     3 7 [Veryâ€¦ 6 [Somâ€¦ 8 [Extâ€¦ 6 [Somâ€¦ 8 [Extâ€¦ 6 [Somâ€¦ 8 [Extâ€¦ 6 [Somâ€¦ 5 [Neiâ€¦
4     4 6 [Someâ€¦ 5 [Neiâ€¦ 7 [Verâ€¦ 3 [Verâ€¦ 6 [Somâ€¦ 1 [Do â€¦ 1 [Do â€¦ 5 [Neiâ€¦ 1 [Do â€¦
5     5 5 [Neitâ€¦ 6 [Somâ€¦ 4 [Somâ€¦ 5 [Neiâ€¦ 4 [Somâ€¦ 5 [Neiâ€¦ 6 [Somâ€¦ 6 [Somâ€¦ 5 [Neiâ€¦
6     6 6 [Someâ€¦ 4 [Somâ€¦ 6 [Somâ€¦ 2 [Extâ€¦ 8 [Extâ€¦ 1 [Do â€¦ 1 [Do â€¦ 3 [Verâ€¦ 1 [Do â€¦
# â„¹ 38 more variables: ATT10 &lt;dbl+lbl&gt;, ATT11 &lt;dbl+lbl&gt;, ATT12 &lt;dbl+lbl&gt;,
#   ATT13 &lt;dbl+lbl&gt;, ATT14 &lt;dbl+lbl&gt;, ATT15 &lt;dbl+lbl&gt;, ATT16 &lt;dbl&gt;,
#   ATT17 &lt;dbl&gt;, ATT18 &lt;dbl&gt;, ATT19 &lt;dbl&gt;, ATT20 &lt;dbl&gt;, ATT21 &lt;dbl&gt;,
#   ATT22 &lt;dbl&gt;, ATT23 &lt;dbl&gt;, ATT24 &lt;dbl&gt;, ATT25 &lt;dbl&gt;, ATT26 &lt;dbl&gt;,
#   ATT27 &lt;dbl&gt;, ATT28 &lt;dbl&gt;, ATT29 &lt;dbl&gt;, ATT30 &lt;dbl&gt;, ATT31 &lt;dbl&gt;,
#   ATT32 &lt;dbl&gt;, ATT33 &lt;dbl&gt;, ELS01 &lt;dbl+lbl&gt;, ELS02 &lt;dbl+lbl&gt;,
#   ELS03 &lt;dbl+lbl&gt;, ELS04 &lt;dbl+lbl&gt;, ELS05 &lt;dbl+lbl&gt;, ELS06 &lt;dbl+lbl&gt;, â€¦</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Alternatively, if you want only the *summarized scale scores* </span></span>
<span><span class="co"># for each instrument (as in your existing code):</span></span>
<span><span class="co">#   - attari1, attari2_scores, els_scores, rs_scores </span></span>
<span><span class="co"># we can merge those:</span></span>
<span></span>
<span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">attari1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">attari2_scores</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">els_scores</span>,     by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">rs_scores</span>,      by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rename columns for clarity (optional)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"id"</span>, </span>
<span>  <span class="st">"perceived_difficulty"</span>,  <span class="co"># from Attari Part 1</span></span>
<span>  <span class="st">"numeracy"</span>,</span>
<span>  <span class="st">"energy_use"</span>,</span>
<span>  <span class="st">"energy_save"</span>,</span>
<span>  <span class="st">"els_accuracy"</span>,</span>
<span>  <span class="st">"els_score"</span>,</span>
<span>  <span class="st">"env_attitude"</span>,</span>
<span>  <span class="st">"env_attitude_z"</span>,</span>
<span>  <span class="st">"pol_conservatism"</span>,</span>
<span>  <span class="st">"pol_conservatism_z"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># ============================================================</span></span>
<span><span class="co"># 2. Examine correlations and underlying structure</span></span>
<span><span class="co"># ============================================================</span></span>
<span></span>
<span><span class="co"># A. Correlation plot among the *scale-level* variables</span></span>
<span><span class="va">cor_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>         <span class="va">perceived_difficulty</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">cor_vars</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize correlation matrix</span></span>
<span><span class="fu">corrplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span></span>
<span>  <span class="va">cor_matrix</span>, </span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, </span>
<span>  addCoef.col <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>  type <span class="op">=</span> <span class="st">"upper"</span>,</span>
<span>  tl.col  <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  tl.srt  <span class="op">=</span> <span class="fl">45</span>,</span>
<span>  diag    <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># B. Factor Analysis (to see if knowledge &amp; motivation load differently)</span></span>
<span><span class="co">#    Using, e.g., 2-factor solution as a demonstration:</span></span>
<span><span class="va">fa_data</span> <span class="op">&lt;-</span> <span class="va">cor_vars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">two_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/fa.html">fa</a></span><span class="op">(</span><span class="va">fa_data</span>, nfactors <span class="op">=</span> <span class="fl">2</span>, rotate <span class="op">=</span> <span class="st">"varimax"</span>, fm <span class="op">=</span> <span class="st">"ml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">two_factor</span>, cut <span class="op">=</span> <span class="fl">0.30</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  ml
Call: fa(r = fa_data, nfactors = 2, rotate = "varimax", fm = "ml")
Standardized loadings (pattern matrix) based upon correlation matrix
                     item   ML2   ML1   h2    u2 com
energy_use              2  0.78       0.63 0.374 1.1
energy_save             3  0.69       0.50 0.497 1.1
numeracy                1  0.51       0.28 0.720 1.2
els_score               4  0.49       0.29 0.709 1.4
pol_conservatism        7             0.14 0.860 2.0
env_attitude            6        0.99 1.00 0.005 1.0
perceived_difficulty    5       -0.37 0.19 0.807 1.7

                       ML2  ML1
SS loadings           1.71 1.31
Proportion Var        0.24 0.19
Cumulative Var        0.24 0.43
Proportion Explained  0.57 0.43
Cumulative Proportion 0.57 1.00

Mean item complexity =  1.4
Test of the hypothesis that 2 factors are sufficient.

df null model =  21  with the objective function =  1.3 with Chi Square =  760
df of  the model are 8  and the objective function was  0.03 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.04 

The harmonic n.obs is  586 with the empirical chi square  18  with prob &lt;  0.025 
The total n.obs was  586  with Likelihood Chi Square =  16  with prob &lt;  0.036 

Tucker Lewis Index of factoring reliability =  0.97
RMSEA index =  0.042  and the 90 % confidence intervals are  0.01 0.072
BIC =  -35
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   ML2  ML1
Correlation of (regression) scores with factors   0.87 1.00
Multiple R square of scores with factors          0.77 0.99
Minimum correlation of possible factor scores     0.53 0.99</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ============================================================</span></span>
<span><span class="co"># 3. Inspect the relation between "motivation" and "knowledge"</span></span>
<span><span class="co"># ============================================================</span></span>
<span></span>
<span><span class="co"># -- Here are a few different approaches:</span></span>
<span></span>
<span><span class="co"># --- (a) Simple regressions</span></span>
<span><span class="co"># For example: Predict ELS knowledge (els_score) from motivation variables</span></span>
<span><span class="va">model_els</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els_score</span> <span class="op">~</span> <span class="va">env_attitude</span> <span class="op">+</span> <span class="va">perceived_difficulty</span> <span class="op">+</span> <span class="va">pol_conservatism</span>, </span>
<span>                data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_els</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els_score ~ env_attitude + perceived_difficulty + 
    pol_conservatism, data = combined_scores)

Residuals:
   Min     1Q Median     3Q    Max 
-3.171 -0.646 -0.004  0.716  2.333 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           -0.6422     0.2390   -2.69   0.0074 ** 
env_attitude           0.2421     0.0571    4.24 0.000026 ***
perceived_difficulty  -0.1338     0.0425   -3.15   0.0017 ** 
pol_conservatism      -0.0854     0.0289   -2.96   0.0032 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.95 on 582 degrees of freedom
Multiple R-squared:  0.104, Adjusted R-squared:  0.0992 
F-statistic: 22.5 on 3 and 582 DF,  p-value: 0.0000000000000872</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># --- (b) Create composites and correlate them</span></span>
<span><span class="co"># Composite for "knowledge": average of numeracy, energy_use, energy_save, els_score</span></span>
<span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    knowledge_composite <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span><span class="op">)</span>, </span>
<span>      na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># For "motivation," you might choose env_attitude and reverse-coded difficulty, </span></span>
<span>    <span class="co"># or some other conceptual combination. Example:</span></span>
<span>    motivation_composite <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">env_attitude</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">perceived_difficulty</span><span class="op">)</span>, </span>
<span>      na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">$</span><span class="va">knowledge_composite</span>, <span class="va">combined_scores</span><span class="op">$</span><span class="va">motivation_composite</span>,</span>
<span>    use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.35</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># --- (c) Cluster analysis on knowledge &amp; motivation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">knowledge_composite</span>, <span class="va">motivation_composite</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Decide the number of clusters (k). Let's try k = 3 for illustration:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">km_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_fit</span>, data <span class="op">=</span> <span class="va">cluster_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means Clustering on Knowledge vs. Motivation"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Add cluster membership back to your main dataframe</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">km_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">km_fit</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare mean knowledge &amp; motivation by cluster</span></span>
<span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">km_cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    mean_knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">knowledge_composite</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">motivation_composite</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 4
  km_cluster mean_knowledge mean_motivation     n
  &lt;fct&gt;               &lt;dbl&gt;           &lt;dbl&gt; &lt;int&gt;
1 1                  -0.794            1.22   184
2 2                   0.469            1.44   167
3 3                   0.288            2.49   235</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># --- (d) Canonical Correlation Analysis (CCA)</span></span>
<span><span class="co"># Splitting your knowledge vs. motivation sets</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CCA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">knowledge_set</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">motivation_set</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We need same rows for both sets, so do a quick align:</span></span>
<span><span class="va">cca_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">knowledge_set</span>, <span class="va">motivation_set</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="va">cca_df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="va">cca_df</span><span class="op">[</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span></span>
<span><span class="va">cca_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cancor.html">cancor</a></span><span class="op">(</span><span class="va">K</span>, <span class="va">M</span><span class="op">)</span></span>
<span><span class="va">cca_res</span><span class="op">$</span><span class="va">cor</span>  <span class="co"># canonical correlations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.418 0.117 0.088</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Inspect canonical weights and loadings</span></span>
<span><span class="va">cca_res</span><span class="op">$</span><span class="va">xcoef</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>             [,1]   [,2]   [,3]    [,4]
numeracy    0.011  0.044  0.004 -0.0076
energy_use  0.011 -0.006 -0.029  0.0432
energy_save 0.016 -0.016 -0.013 -0.0444
els_score   0.017 -0.016  0.039  0.0086</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cca_res</span><span class="op">$</span><span class="va">ycoef</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                       [,1]    [,2]  [,3]
env_attitude          0.022 -0.0009 0.056
perceived_difficulty -0.019  0.0312 0.026
pol_conservatism     -0.015 -0.0222 0.014</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># --- (e) Structural Equation Model (SEM)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Hypothetical model: </span></span>
<span><span class="co">#   - latent Knowledge from numeracy, energy_use, energy_save, els_score</span></span>
<span><span class="co">#   - latent Motivation from env_attitude, perceived_difficulty</span></span>
<span><span class="co">#   - regression: Knowledge ~ Motivation</span></span>
<span></span>
<span><span class="va">sem_model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  Knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span><span class="st">  Motivation =~ env_attitude + perceived_difficulty</span></span>
<span><span class="st">  Knowledge ~ Motivation</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_sem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">sem_model</span>, data <span class="op">=</span> <span class="va">combined_scores</span>, missing <span class="op">=</span> <span class="st">"fiml"</span><span class="op">)</span>  <span class="co"># handle missing if needed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_sem</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 36 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        19

  Number of observations                           586
  Number of missing patterns                         1

Model Test User Model:
                                                      
  Test statistic                                23.012
  Degrees of freedom                                 8
  P-value (Chi-square)                           0.003

Model Test Baseline Model:

  Test statistic                               680.231
  Degrees of freedom                                15
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.977
  Tucker-Lewis Index (TLI)                       0.958
                                                      
  Robust Comparative Fit Index (CFI)             0.977
  Robust Tucker-Lewis Index (TLI)                0.958

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -4504.774
  Loglikelihood unrestricted model (H1)      -4493.268
                                                      
  Akaike (AIC)                                9047.548
  Bayesian (BIC)                              9130.641
  Sample-size adjusted Bayesian (SABIC)       9070.323

Root Mean Square Error of Approximation:

  RMSEA                                          0.057
  90 Percent confidence interval - lower         0.030
  90 Percent confidence interval - upper         0.084
  P-value H_0: RMSEA &lt;= 0.050                    0.305
  P-value H_0: RMSEA &gt;= 0.080                    0.086
                                                      
  Robust RMSEA                                   0.057
  90 Percent confidence interval - lower         0.030
  90 Percent confidence interval - upper         0.084
  P-value H_0: Robust RMSEA &lt;= 0.050             0.305
  P-value H_0: Robust RMSEA &gt;= 0.080             0.086

Standardized Root Mean Square Residual:

  SRMR                                           0.028

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Knowledge =~                                                          
    numeracy          1.000                               0.527    0.527
    energy_use        1.469    0.135   10.849    0.000    0.774    0.774
    energy_save       1.352    0.129   10.452    0.000    0.712    0.713
    els_score         1.029    0.110    9.400    0.000    0.542    0.543
  Motivation =~                                                         
    env_attitude      1.000                               0.477    0.619
    percvd_dffclty   -1.306    0.208   -6.269    0.000   -0.622   -0.623

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Knowledge ~                                                           
    Motivation        0.584    0.099    5.923    0.000    0.529    0.529

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .numeracy          0.000    0.041    0.000    1.000    0.000    0.000
   .energy_use       -0.000    0.041   -0.000    1.000   -0.000   -0.000
   .energy_save      -0.000    0.041   -0.000    1.000   -0.000   -0.000
   .els_score         0.000    0.041    0.000    1.000    0.000    0.000
   .env_attitude      3.583    0.032  112.638    0.000    3.583    4.653
   .percvd_dffclty    0.000    0.041    0.000    1.000    0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .numeracy          0.721    0.048   15.124    0.000    0.721    0.722
   .energy_use        0.400    0.042    9.432    0.000    0.400    0.400
   .energy_save       0.491    0.042   11.751    0.000    0.491    0.492
   .els_score         0.704    0.047   14.845    0.000    0.704    0.705
   .env_attitude      0.366    0.041    8.844    0.000    0.366    0.617
   .percvd_dffclty    0.611    0.070    8.711    0.000    0.611    0.612
   .Knowledge         0.200    0.036    5.567    0.000    0.721    0.721
    Motivation        0.227    0.045    5.079    0.000    1.000    1.000</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot the model if needed: semPaths(fit_sem)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/tegorman13\.github\.io\/Survey_Study\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="./inst.html" class="pagination-link" aria-label="Survey Items">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Survey Items</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./cors1.html" class="pagination-link" aria-label="Instrument Correlations_b">
        <span class="nav-page-text">Instrument Correlations_b</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb138" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Instrument Correlations"</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="co">    grid:</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="co">      sidebar-width: 220px</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a><span class="co">      body-width: 1200px</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="co">      margin-width: 170px</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="co">      gutter-width: 1.0rem</span></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="co">  hugo-md:</span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a><span class="co">    include: true</span></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a><span class="co">    html-math-method: mathjax</span></span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a><span class="co">    output-file: cor_hugo.md</span></span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr,purrr,tidyr,here, haven,tibble,ggplot2,ggh4x,lme4,knitr,kableExtra,gt,pander,flextable,ggh4x,psych,corrplot,factoextra)</span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">2</span>, <span class="at">scipen=</span><span class="dv">999</span>, <span class="at">dplyr.summarise.inform=</span><span class="cn">FALSE</span>)</span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>,<span class="st">"survey_functions.R"</span>))</span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a>draw <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"draw.rds"</span>))</span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a>dinst <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"dinst.rds"</span>))</span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-33"><a href="#cb138-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Attari Energy Survey (Part 1)</span></span>
<span id="cb138-34"><a href="#cb138-34" aria-hidden="true" tabindex="-1"></a>aes1 <span class="ot">&lt;-</span> draw <span class="sc">|&gt;</span> <span class="fu">select</span>(id,ATT01<span class="sc">:</span>ATT18)</span>
<span id="cb138-35"><a href="#cb138-35" aria-hidden="true" tabindex="-1"></a>aes2 <span class="ot">&lt;-</span> dinst <span class="sc">|&gt;</span> <span class="fu">select</span>(id,ATT01<span class="sc">:</span>ATT18)</span>
<span id="cb138-36"><a href="#cb138-36" aria-hidden="true" tabindex="-1"></a>aes_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(aes1, aes2)</span>
<span id="cb138-37"><a href="#cb138-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-38"><a href="#cb138-38" aria-hidden="true" tabindex="-1"></a>att_useSave <span class="ot">&lt;-</span> draw <span class="sc">|&gt;</span> <span class="fu">select</span>(id,ATT19<span class="sc">:</span>ATT33)</span>
<span id="cb138-39"><a href="#cb138-39" aria-hidden="true" tabindex="-1"></a>att_useSave2 <span class="ot">&lt;-</span> dinst <span class="sc">|&gt;</span> <span class="fu">select</span>(id,ATT19<span class="sc">:</span>ATT33)</span>
<span id="cb138-40"><a href="#cb138-40" aria-hidden="true" tabindex="-1"></a>att2_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(att_useSave, att_useSave2)</span>
<span id="cb138-41"><a href="#cb138-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-42"><a href="#cb138-42" aria-hidden="true" tabindex="-1"></a>els1 <span class="ot">&lt;-</span> draw <span class="sc">|&gt;</span> <span class="fu">select</span>(id,ELS01<span class="sc">:</span>ELS08)</span>
<span id="cb138-43"><a href="#cb138-43" aria-hidden="true" tabindex="-1"></a>els2 <span class="ot">&lt;-</span> dinst <span class="sc">|&gt;</span> <span class="fu">select</span>(id,ELS01<span class="sc">:</span>ELS08)</span>
<span id="cb138-44"><a href="#cb138-44" aria-hidden="true" tabindex="-1"></a>els <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(els1,els2)</span>
<span id="cb138-45"><a href="#cb138-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-46"><a href="#cb138-46" aria-hidden="true" tabindex="-1"></a>rs1 <span class="ot">&lt;-</span> draw <span class="sc">|&gt;</span> <span class="fu">select</span>(id,RS01<span class="sc">:</span>RS06)</span>
<span id="cb138-47"><a href="#cb138-47" aria-hidden="true" tabindex="-1"></a>rs2 <span class="ot">&lt;-</span> dinst <span class="sc">|&gt;</span> <span class="fu">select</span>(id,RS01<span class="sc">:</span>RS06)</span>
<span id="cb138-48"><a href="#cb138-48" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(rs1,rs2)</span>
<span id="cb138-49"><a href="#cb138-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-50"><a href="#cb138-50" aria-hidden="true" tabindex="-1"></a>attari1 <span class="ot">&lt;-</span> <span class="fu">analyze_attari_survey_part1</span>(aes_combined)</span>
<span id="cb138-51"><a href="#cb138-51" aria-hidden="true" tabindex="-1"></a>attari2_scores <span class="ot">&lt;-</span> <span class="fu">analyze_attari_survey</span>(att2_combined)</span>
<span id="cb138-52"><a href="#cb138-52" aria-hidden="true" tabindex="-1"></a>els_scores <span class="ot">&lt;-</span> <span class="fu">analyze_els_survey</span>(els)</span>
<span id="cb138-53"><a href="#cb138-53" aria-hidden="true" tabindex="-1"></a>rs_scores <span class="ot">&lt;-</span> <span class="fu">analyze_recycling_survey</span>(rs)</span>
<span id="cb138-54"><a href="#cb138-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-55"><a href="#cb138-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all scores into one dataframe</span></span>
<span id="cb138-56"><a href="#cb138-56" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> attari1 <span class="sc">%&gt;%</span></span>
<span id="cb138-57"><a href="#cb138-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(attari2_scores, <span class="at">by=</span><span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-58"><a href="#cb138-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(els_scores, <span class="at">by=</span><span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-59"><a href="#cb138-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(rs_scores, <span class="at">by=</span><span class="st">"id"</span>)</span>
<span id="cb138-60"><a href="#cb138-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-61"><a href="#cb138-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for clarity</span></span>
<span id="cb138-62"><a href="#cb138-62" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(combined_scores) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"perceived_difficulty"</span>, <span class="st">"numeracy"</span>, </span>
<span id="cb138-63"><a href="#cb138-63" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, </span>
<span id="cb138-64"><a href="#cb138-64" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"els_accuracy"</span>, <span class="st">"els_score"</span>,</span>
<span id="cb138-65"><a href="#cb138-65" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"env_attitude"</span>, <span class="st">"env_attitude_z"</span>,</span>
<span id="cb138-66"><a href="#cb138-66" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"pol_conservatism"</span>, <span class="st">"pol_conservatism_z"</span>)</span>
<span id="cb138-67"><a href="#cb138-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-68"><a href="#cb138-68" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Cluster Analysis</span></span>
<span id="cb138-69"><a href="#cb138-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-70"><a href="#cb138-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for clustering (select relevant variables and scale)</span></span>
<span id="cb138-71"><a href="#cb138-71" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-72"><a href="#cb138-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(perceived_difficulty, numeracy, energy_use, energy_save, els_score, env_attitude_z, pol_conservatism_z) <span class="sc">%&gt;%</span></span>
<span id="cb138-73"><a href="#cb138-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb138-74"><a href="#cb138-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb138-75"><a href="#cb138-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-76"><a href="#cb138-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine optimal number of clusters using the elbow method</span></span>
<span id="cb138-77"><a href="#cb138-77" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>) <span class="sc">+</span></span>
<span id="cb138-78"><a href="#cb138-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Elbow Method for Optimal k"</span>, <span class="at">x =</span> <span class="st">"Number of Clusters k"</span>)</span>
<span id="cb138-79"><a href="#cb138-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-80"><a href="#cb138-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-81"><a href="#cb138-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-82"><a href="#cb138-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-83"><a href="#cb138-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-84"><a href="#cb138-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-87"><a href="#cb138-87" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-88"><a href="#cb138-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform k-means clustering (e.g., with 3 clusters)</span></span>
<span id="cb138-89"><a href="#cb138-89" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb138-90"><a href="#cb138-90" aria-hidden="true" tabindex="-1"></a>km_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb138-91"><a href="#cb138-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-92"><a href="#cb138-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the clusters</span></span>
<span id="cb138-93"><a href="#cb138-93" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_result, <span class="at">data =</span> cluster_data,</span>
<span id="cb138-94"><a href="#cb138-94" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb138-95"><a href="#cb138-95" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"convex"</span>,</span>
<span id="cb138-96"><a href="#cb138-96" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb138-97"><a href="#cb138-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clustering of Subjects"</span>)</span>
<span id="cb138-98"><a href="#cb138-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-99"><a href="#cb138-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-100"><a href="#cb138-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-101"><a href="#cb138-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-104"><a href="#cb138-104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-105"><a href="#cb138-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster assignments to the main dataframe</span></span>
<span id="cb138-106"><a href="#cb138-106" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(km_result<span class="sc">$</span>cluster)</span>
<span id="cb138-107"><a href="#cb138-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-108"><a href="#cb138-108" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Enhanced Factor Analysis</span></span>
<span id="cb138-109"><a href="#cb138-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-110"><a href="#cb138-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Scree plot to determine the number of factors</span></span>
<span id="cb138-111"><a href="#cb138-111" aria-hidden="true" tabindex="-1"></a>fa_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-112"><a href="#cb138-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(perceived_difficulty, numeracy, energy_use, energy_save, els_score, env_attitude_z, pol_conservatism_z) <span class="sc">%&gt;%</span></span>
<span id="cb138-113"><a href="#cb138-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb138-114"><a href="#cb138-114" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(fa_data)</span>
<span id="cb138-115"><a href="#cb138-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-116"><a href="#cb138-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-117"><a href="#cb138-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform factor analysis with, e.g., 3 factors</span></span>
<span id="cb138-118"><a href="#cb138-118" aria-hidden="true" tabindex="-1"></a>fa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(fa_data, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)</span>
<span id="cb138-119"><a href="#cb138-119" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result, <span class="at">cut =</span> <span class="fl">0.3</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-120"><a href="#cb138-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-121"><a href="#cb138-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-122"><a href="#cb138-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-123"><a href="#cb138-123" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Enhanced Regression Models</span></span>
<span id="cb138-124"><a href="#cb138-124" aria-hidden="true" tabindex="-1"></a><span class="co"># Model predicting ELS from motivation, controlling for other knowledge scores</span></span>
<span id="cb138-125"><a href="#cb138-125" aria-hidden="true" tabindex="-1"></a>model_els_enhanced <span class="ot">&lt;-</span> <span class="fu">lm</span>(els_score <span class="sc">~</span> perceived_difficulty <span class="sc">+</span> env_attitude_z <span class="sc">+</span> pol_conservatism_z <span class="sc">+</span></span>
<span id="cb138-126"><a href="#cb138-126" aria-hidden="true" tabindex="-1"></a>                           numeracy <span class="sc">+</span> energy_use <span class="sc">+</span> energy_save, <span class="at">data =</span> combined_scores)</span>
<span id="cb138-127"><a href="#cb138-127" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_els_enhanced)</span>
<span id="cb138-128"><a href="#cb138-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-129"><a href="#cb138-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-130"><a href="#cb138-130" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Interaction Effects in Regression</span></span>
<span id="cb138-131"><a href="#cb138-131" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Interaction between environmental attitude and perceived difficulty on ELS</span></span>
<span id="cb138-132"><a href="#cb138-132" aria-hidden="true" tabindex="-1"></a>model_interaction <span class="ot">&lt;-</span> <span class="fu">lm</span>(els_score <span class="sc">~</span> perceived_difficulty <span class="sc">*</span> env_attitude_z, <span class="at">data =</span> combined_scores)</span>
<span id="cb138-133"><a href="#cb138-133" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_interaction)</span>
<span id="cb138-134"><a href="#cb138-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-135"><a href="#cb138-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the interaction (example)</span></span>
<span id="cb138-136"><a href="#cb138-136" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_scores, <span class="fu">aes</span>(<span class="at">x =</span> perceived_difficulty, <span class="at">y =</span> els_score, <span class="at">color =</span> env_attitude_z)) <span class="sc">+</span></span>
<span id="cb138-137"><a href="#cb138-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb138-138"><a href="#cb138-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb138-139"><a href="#cb138-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb138-140"><a href="#cb138-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interaction of Perceived Difficulty and Environmental Attitude on ELS"</span>,</span>
<span id="cb138-141"><a href="#cb138-141" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Perceived Difficulty"</span>,</span>
<span id="cb138-142"><a href="#cb138-142" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Energy Literacy Score"</span>) <span class="sc">+</span></span>
<span id="cb138-143"><a href="#cb138-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb138-144"><a href="#cb138-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-145"><a href="#cb138-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-146"><a href="#cb138-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-147"><a href="#cb138-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-148"><a href="#cb138-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-149"><a href="#cb138-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-150"><a href="#cb138-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-151"><a href="#cb138-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-154"><a href="#cb138-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-155"><a href="#cb138-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb138-156"><a href="#cb138-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb138-157"><a href="#cb138-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-158"><a href="#cb138-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-159"><a href="#cb138-159" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> attari1 <span class="sc">%&gt;%</span></span>
<span id="cb138-160"><a href="#cb138-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(attari2_scores, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-161"><a href="#cb138-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(els_scores,       <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-162"><a href="#cb138-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(rs_scores,        <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb138-163"><a href="#cb138-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-164"><a href="#cb138-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-165"><a href="#cb138-165" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create knowledge profiles using cluster analysis</span></span>
<span id="cb138-166"><a href="#cb138-166" aria-hidden="true" tabindex="-1"></a>knowledge_vars <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span> </span>
<span id="cb138-167"><a href="#cb138-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy_score, relative_energy_use_score, </span>
<span id="cb138-168"><a href="#cb138-168" aria-hidden="true" tabindex="-1"></a>         relative_energy_save_score, els)</span>
<span id="cb138-169"><a href="#cb138-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-170"><a href="#cb138-170" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb138-171"><a href="#cb138-171" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(<span class="fu">scale</span>(knowledge_vars), <span class="at">centers=</span><span class="dv">3</span>)</span>
<span id="cb138-172"><a href="#cb138-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-173"><a href="#cb138-173" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster membership to data</span></span>
<span id="cb138-174"><a href="#cb138-174" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>knowledge_cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(clusters<span class="sc">$</span>cluster)</span>
<span id="cb138-175"><a href="#cb138-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-176"><a href="#cb138-176" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare motivation scores across clusters</span></span>
<span id="cb138-177"><a href="#cb138-177" aria-hidden="true" tabindex="-1"></a>cluster_comparison <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb138-178"><a href="#cb138-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(knowledge_cluster) <span class="sc">%&gt;%</span></span>
<span id="cb138-179"><a href="#cb138-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb138-180"><a href="#cb138-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_env_attitude =</span> <span class="fu">mean</span>(env_attitude, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-181"><a href="#cb138-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_difficulty =</span> <span class="fu">mean</span>(perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-182"><a href="#cb138-182" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-183"><a href="#cb138-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-184"><a href="#cb138-184" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Test for non-linear relationships</span></span>
<span id="cb138-185"><a href="#cb138-185" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb138-186"><a href="#cb138-186" aria-hidden="true" tabindex="-1"></a>gam_model <span class="ot">&lt;-</span> <span class="fu">gam</span>(els <span class="sc">~</span> <span class="fu">s</span>(env_attitude) <span class="sc">+</span> <span class="fu">s</span>(perceived_difficulty_score), </span>
<span id="cb138-187"><a href="#cb138-187" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>combined_df)</span>
<span id="cb138-188"><a href="#cb138-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-189"><a href="#cb138-189" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Create interaction model between knowledge and motivation</span></span>
<span id="cb138-190"><a href="#cb138-190" aria-hidden="true" tabindex="-1"></a>interaction_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(els <span class="sc">~</span> env_attitude <span class="sc">*</span> perceived_difficulty_score <span class="sc">+</span> </span>
<span id="cb138-191"><a href="#cb138-191" aria-hidden="true" tabindex="-1"></a>                         numeracy_score, <span class="at">data=</span>combined_df)</span>
<span id="cb138-192"><a href="#cb138-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-193"><a href="#cb138-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-194"><a href="#cb138-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-195"><a href="#cb138-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-196"><a href="#cb138-196" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb138-197"><a href="#cb138-197" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb138-198"><a href="#cb138-198" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb138-199"><a href="#cb138-199" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb138-200"><a href="#cb138-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-201"><a href="#cb138-201" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Enhanced Correlation Plot</span></span>
<span id="cb138-202"><a href="#cb138-202" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb138-203"><a href="#cb138-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy_score, relative_energy_use_score, </span>
<span id="cb138-204"><a href="#cb138-204" aria-hidden="true" tabindex="-1"></a>         relative_energy_save_score, els, </span>
<span id="cb138-205"><a href="#cb138-205" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty_score, env_attitude, </span>
<span id="cb138-206"><a href="#cb138-206" aria-hidden="true" tabindex="-1"></a>         pol_conservatism_z) <span class="sc">%&gt;%</span></span>
<span id="cb138-207"><a href="#cb138-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb138-208"><a href="#cb138-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-209"><a href="#cb138-209" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, </span>
<span id="cb138-210"><a href="#cb138-210" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> <span class="st">"color"</span>,</span>
<span id="cb138-211"><a href="#cb138-211" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb138-212"><a href="#cb138-212" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">"black"</span>,</span>
<span id="cb138-213"><a href="#cb138-213" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb138-214"><a href="#cb138-214" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb138-215"><a href="#cb138-215" aria-hidden="true" tabindex="-1"></a>         <span class="at">diag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb138-216"><a href="#cb138-216" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span>))(<span class="dv">200</span>))</span>
<span id="cb138-217"><a href="#cb138-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-218"><a href="#cb138-218" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Knowledge Profile Clustering</span></span>
<span id="cb138-219"><a href="#cb138-219" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize knowledge variables</span></span>
<span id="cb138-220"><a href="#cb138-220" aria-hidden="true" tabindex="-1"></a>knowledge_vars <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb138-221"><a href="#cb138-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy_score, relative_energy_use_score, </span>
<span id="cb138-222"><a href="#cb138-222" aria-hidden="true" tabindex="-1"></a>         relative_energy_save_score, els) <span class="sc">%&gt;%</span></span>
<span id="cb138-223"><a href="#cb138-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb138-224"><a href="#cb138-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-225"><a href="#cb138-225" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine optimal number of clusters</span></span>
<span id="cb138-226"><a href="#cb138-226" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb138-227"><a href="#cb138-227" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(k) {</span>
<span id="cb138-228"><a href="#cb138-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kmeans</span>(knowledge_vars, <span class="at">centers=</span>k)<span class="sc">$</span>tot.withinss</span>
<span id="cb138-229"><a href="#cb138-229" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb138-230"><a href="#cb138-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-231"><a href="#cb138-231" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform k-means clustering</span></span>
<span id="cb138-232"><a href="#cb138-232" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># Based on elbow plot inspection</span></span>
<span id="cb138-233"><a href="#cb138-233" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(knowledge_vars, <span class="at">centers=</span>k)</span>
<span id="cb138-234"><a href="#cb138-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-235"><a href="#cb138-235" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster membership to data</span></span>
<span id="cb138-236"><a href="#cb138-236" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>knowledge_cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(clusters<span class="sc">$</span>cluster)</span>
<span id="cb138-237"><a href="#cb138-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-238"><a href="#cb138-238" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize clusters</span></span>
<span id="cb138-239"><a href="#cb138-239" aria-hidden="true" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(knowledge_vars)</span>
<span id="cb138-240"><a href="#cb138-240" aria-hidden="true" tabindex="-1"></a>cluster_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb138-241"><a href="#cb138-241" aria-hidden="true" tabindex="-1"></a>  <span class="at">PC1 =</span> pca_result<span class="sc">$</span>x[,<span class="dv">1</span>],</span>
<span id="cb138-242"><a href="#cb138-242" aria-hidden="true" tabindex="-1"></a>  <span class="at">PC2 =</span> pca_result<span class="sc">$</span>x[,<span class="dv">2</span>],</span>
<span id="cb138-243"><a href="#cb138-243" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cluster =</span> combined_df<span class="sc">$</span>knowledge_cluster</span>
<span id="cb138-244"><a href="#cb138-244" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb138-245"><a href="#cb138-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-246"><a href="#cb138-246" aria-hidden="true" tabindex="-1"></a><span class="co"># Create cluster visualization</span></span>
<span id="cb138-247"><a href="#cb138-247" aria-hidden="true" tabindex="-1"></a>p_clusters <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cluster_df, <span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2, <span class="at">color=</span>Cluster)) <span class="sc">+</span></span>
<span id="cb138-248"><a href="#cb138-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb138-249"><a href="#cb138-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb138-250"><a href="#cb138-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Knowledge Profiles Clustering"</span>,</span>
<span id="cb138-251"><a href="#cb138-251" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"First Principal Component"</span>,</span>
<span id="cb138-252"><a href="#cb138-252" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Second Principal Component"</span>)</span>
<span id="cb138-253"><a href="#cb138-253" aria-hidden="true" tabindex="-1"></a>p_clusters</span>
<span id="cb138-254"><a href="#cb138-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-255"><a href="#cb138-255" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Non-linear GAM Analysis</span></span>
<span id="cb138-256"><a href="#cb138-256" aria-hidden="true" tabindex="-1"></a>gam_model <span class="ot">&lt;-</span> <span class="fu">gam</span>(els <span class="sc">~</span> <span class="fu">s</span>(env_attitude) <span class="sc">+</span> <span class="fu">s</span>(perceived_difficulty_score), </span>
<span id="cb138-257"><a href="#cb138-257" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>combined_df)</span>
<span id="cb138-258"><a href="#cb138-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-259"><a href="#cb138-259" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction grid for GAM visualization</span></span>
<span id="cb138-260"><a href="#cb138-260" aria-hidden="true" tabindex="-1"></a>env_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(combined_df<span class="sc">$</span>env_attitude, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-261"><a href="#cb138-261" aria-hidden="true" tabindex="-1"></a>                <span class="fu">max</span>(combined_df<span class="sc">$</span>env_attitude, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-262"><a href="#cb138-262" aria-hidden="true" tabindex="-1"></a>                <span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb138-263"><a href="#cb138-263" aria-hidden="true" tabindex="-1"></a>diff_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(combined_df<span class="sc">$</span>perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-264"><a href="#cb138-264" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">max</span>(combined_df<span class="sc">$</span>perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-265"><a href="#cb138-265" aria-hidden="true" tabindex="-1"></a>                 <span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb138-266"><a href="#cb138-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-267"><a href="#cb138-267" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict ELS scores</span></span>
<span id="cb138-268"><a href="#cb138-268" aria-hidden="true" tabindex="-1"></a>pred_env <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_model, </span>
<span id="cb138-269"><a href="#cb138-269" aria-hidden="true" tabindex="-1"></a>                   <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">env_attitude=</span>env_grid,</span>
<span id="cb138-270"><a href="#cb138-270" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">perceived_difficulty_score=</span><span class="fu">mean</span>(combined_df<span class="sc">$</span>perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span>
<span id="cb138-271"><a href="#cb138-271" aria-hidden="true" tabindex="-1"></a>pred_diff <span class="ot">&lt;-</span> <span class="fu">predict</span>(gam_model,</span>
<span id="cb138-272"><a href="#cb138-272" aria-hidden="true" tabindex="-1"></a>                    <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">perceived_difficulty_score=</span>diff_grid,</span>
<span id="cb138-273"><a href="#cb138-273" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">env_attitude=</span><span class="fu">mean</span>(combined_df<span class="sc">$</span>env_attitude, <span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span>
<span id="cb138-274"><a href="#cb138-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-275"><a href="#cb138-275" aria-hidden="true" tabindex="-1"></a><span class="co"># Create GAM plots</span></span>
<span id="cb138-276"><a href="#cb138-276" aria-hidden="true" tabindex="-1"></a>p_gam_env <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb138-277"><a href="#cb138-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>env_grid, <span class="at">y=</span>pred_env), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb138-278"><a href="#cb138-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>combined_df, <span class="fu">aes</span>(<span class="at">x=</span>env_attitude, <span class="at">y=</span>els), <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb138-279"><a href="#cb138-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb138-280"><a href="#cb138-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Non-linear Relationship: Environmental Attitude and Energy Literacy"</span>,</span>
<span id="cb138-281"><a href="#cb138-281" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Environmental Attitude"</span>,</span>
<span id="cb138-282"><a href="#cb138-282" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Energy Literacy Score"</span>)</span>
<span id="cb138-283"><a href="#cb138-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-284"><a href="#cb138-284" aria-hidden="true" tabindex="-1"></a>p_gam_diff <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb138-285"><a href="#cb138-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>diff_grid, <span class="at">y=</span>pred_diff), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb138-286"><a href="#cb138-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>combined_df, <span class="fu">aes</span>(<span class="at">x=</span>perceived_difficulty_score, <span class="at">y=</span>els), <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb138-287"><a href="#cb138-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb138-288"><a href="#cb138-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Non-linear Relationship: Perceived Difficulty and Energy Literacy"</span>,</span>
<span id="cb138-289"><a href="#cb138-289" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Perceived Difficulty Score"</span>,</span>
<span id="cb138-290"><a href="#cb138-290" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Energy Literacy Score"</span>)</span>
<span id="cb138-291"><a href="#cb138-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-292"><a href="#cb138-292" aria-hidden="true" tabindex="-1"></a><span class="co">#p_gam_diff</span></span>
<span id="cb138-293"><a href="#cb138-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-294"><a href="#cb138-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-295"><a href="#cb138-295" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Knowledge-Motivation Interaction Analysis</span></span>
<span id="cb138-296"><a href="#cb138-296" aria-hidden="true" tabindex="-1"></a>interaction_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(els <span class="sc">~</span> env_attitude <span class="sc">*</span> perceived_difficulty_score <span class="sc">+</span> </span>
<span id="cb138-297"><a href="#cb138-297" aria-hidden="true" tabindex="-1"></a>                         numeracy_score, <span class="at">data=</span>combined_df)</span>
<span id="cb138-298"><a href="#cb138-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-299"><a href="#cb138-299" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interaction_model)</span>
<span id="cb138-300"><a href="#cb138-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-301"><a href="#cb138-301" aria-hidden="true" tabindex="-1"></a><span class="co"># Create interaction plot data</span></span>
<span id="cb138-302"><a href="#cb138-302" aria-hidden="true" tabindex="-1"></a>env_levels <span class="ot">&lt;-</span> <span class="fu">quantile</span>(combined_df<span class="sc">$</span>env_attitude, <span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-303"><a href="#cb138-303" aria-hidden="true" tabindex="-1"></a>diff_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(combined_df<span class="sc">$</span>perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-304"><a href="#cb138-304" aria-hidden="true" tabindex="-1"></a>                <span class="fu">max</span>(combined_df<span class="sc">$</span>perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-305"><a href="#cb138-305" aria-hidden="true" tabindex="-1"></a>                <span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb138-306"><a href="#cb138-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-307"><a href="#cb138-307" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_data &lt;- expand.grid(</span></span>
<span id="cb138-308"><a href="#cb138-308" aria-hidden="true" tabindex="-1"></a><span class="co">#   perceived_difficulty_score = diff_seq,</span></span>
<span id="cb138-309"><a href="#cb138-309" aria-hidden="true" tabindex="-1"></a><span class="co">#   env_attitude = levels(factor(combined_df$env_attitude)),</span></span>
<span id="cb138-310"><a href="#cb138-310" aria-hidden="true" tabindex="-1"></a><span class="co">#   numeracy_score = mean(combined_df$numeracy_score, na.rm=TRUE)</span></span>
<span id="cb138-311"><a href="#cb138-311" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb138-312"><a href="#cb138-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-313"><a href="#cb138-313" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_data$predicted_els &lt;- predict(interaction_model, newdata=pred_data)</span></span>
<span id="cb138-314"><a href="#cb138-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-315"><a href="#cb138-315" aria-hidden="true" tabindex="-1"></a><span class="co"># p_interaction &lt;- ggplot(pred_data, aes(x=perceived_difficulty_score, y=predicted_els, </span></span>
<span id="cb138-316"><a href="#cb138-316" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       color=factor(env_attitude))) +</span></span>
<span id="cb138-317"><a href="#cb138-317" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb138-318"><a href="#cb138-318" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb138-319"><a href="#cb138-319" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title="Interaction between Environmental Attitude and Perceived Difficulty",</span></span>
<span id="cb138-320"><a href="#cb138-320" aria-hidden="true" tabindex="-1"></a><span class="co">#        x="Perceived Difficulty Score",</span></span>
<span id="cb138-321"><a href="#cb138-321" aria-hidden="true" tabindex="-1"></a><span class="co">#        y="Predicted Energy Literacy Score",</span></span>
<span id="cb138-322"><a href="#cb138-322" aria-hidden="true" tabindex="-1"></a><span class="co">#        color="Environmental\nAttitude Level")</span></span>
<span id="cb138-323"><a href="#cb138-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-324"><a href="#cb138-324" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange all plots</span></span>
<span id="cb138-325"><a href="#cb138-325" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p_clusters, p_gam_env, p_gam_diff, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb138-326"><a href="#cb138-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-327"><a href="#cb138-327" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical summaries</span></span>
<span id="cb138-328"><a href="#cb138-328" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gam_model)</span>
<span id="cb138-329"><a href="#cb138-329" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interaction_model)</span>
<span id="cb138-330"><a href="#cb138-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-331"><a href="#cb138-331" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster profile analysis</span></span>
<span id="cb138-332"><a href="#cb138-332" aria-hidden="true" tabindex="-1"></a>cluster_profiles <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb138-333"><a href="#cb138-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(knowledge_cluster) <span class="sc">%&gt;%</span></span>
<span id="cb138-334"><a href="#cb138-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb138-335"><a href="#cb138-335" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_numeracy =</span> <span class="fu">mean</span>(numeracy_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-336"><a href="#cb138-336" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_energy_use =</span> <span class="fu">mean</span>(relative_energy_use_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-337"><a href="#cb138-337" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_energy_save =</span> <span class="fu">mean</span>(relative_energy_save_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-338"><a href="#cb138-338" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_els =</span> <span class="fu">mean</span>(els, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-339"><a href="#cb138-339" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_env_attitude =</span> <span class="fu">mean</span>(env_attitude, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-340"><a href="#cb138-340" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_difficulty =</span> <span class="fu">mean</span>(perceived_difficulty_score, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-341"><a href="#cb138-341" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb138-342"><a href="#cb138-342" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-343"><a href="#cb138-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-344"><a href="#cb138-344" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cluster_profiles)</span>
<span id="cb138-345"><a href="#cb138-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-346"><a href="#cb138-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-347"><a href="#cb138-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-348"><a href="#cb138-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-349"><a href="#cb138-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-350"><a href="#cb138-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-351"><a href="#cb138-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-354"><a href="#cb138-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-355"><a href="#cb138-355" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: K-means clustering on knowledge + motivation</span></span>
<span id="cb138-356"><a href="#cb138-356" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb138-357"><a href="#cb138-357" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)   <span class="co"># for visualization of clusters</span></span>
<span id="cb138-358"><a href="#cb138-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-359"><a href="#cb138-359" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset your knowledge &amp; motivation columns</span></span>
<span id="cb138-360"><a href="#cb138-360" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb138-361"><a href="#cb138-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy_score, relative_energy_use_score, relative_energy_save_score,</span>
<span id="cb138-362"><a href="#cb138-362" aria-hidden="true" tabindex="-1"></a>         els, perceived_difficulty_score, env_attitude, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb138-363"><a href="#cb138-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb138-364"><a href="#cb138-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-365"><a href="#cb138-365" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale them</span></span>
<span id="cb138-366"><a href="#cb138-366" aria-hidden="true" tabindex="-1"></a>cluster_data_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(cluster_data)</span>
<span id="cb138-367"><a href="#cb138-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-368"><a href="#cb138-368" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide on number of clusters (e.g. 2â€“5) â€“ use e.g. Elbow method</span></span>
<span id="cb138-369"><a href="#cb138-369" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data_scaled, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>)</span>
<span id="cb138-370"><a href="#cb138-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-371"><a href="#cb138-371" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose we choose 3 clusters as a demonstration</span></span>
<span id="cb138-372"><a href="#cb138-372" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb138-373"><a href="#cb138-373" aria-hidden="true" tabindex="-1"></a>km_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data_scaled, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb138-374"><a href="#cb138-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-375"><a href="#cb138-375" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster membership back into the original data</span></span>
<span id="cb138-376"><a href="#cb138-376" aria-hidden="true" tabindex="-1"></a>cluster_data<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(km_result<span class="sc">$</span>cluster)</span>
<span id="cb138-377"><a href="#cb138-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-378"><a href="#cb138-378" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize clusters in 2D (using PCA behind the scenes)</span></span>
<span id="cb138-379"><a href="#cb138-379" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_result, <span class="at">data =</span> cluster_data_scaled,</span>
<span id="cb138-380"><a href="#cb138-380" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">ellipse.type =</span> <span class="st">"convex"</span>) <span class="sc">+</span></span>
<span id="cb138-381"><a href="#cb138-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb138-382"><a href="#cb138-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clusters of Knowledge &amp; Motivation Variables"</span>)</span>
<span id="cb138-383"><a href="#cb138-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-384"><a href="#cb138-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-385"><a href="#cb138-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-386"><a href="#cb138-386" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Grab relevant variables</span></span>
<span id="cb138-387"><a href="#cb138-387" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb138-388"><a href="#cb138-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy_score, relative_energy_use_score, relative_energy_save_score,</span>
<span id="cb138-389"><a href="#cb138-389" aria-hidden="true" tabindex="-1"></a>         els, perceived_difficulty_score, env_attitude, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb138-390"><a href="#cb138-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb138-391"><a href="#cb138-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-392"><a href="#cb138-392" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Standardize/scale them</span></span>
<span id="cb138-393"><a href="#cb138-393" aria-hidden="true" tabindex="-1"></a>cluster_data_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(cluster_data)</span>
<span id="cb138-394"><a href="#cb138-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-395"><a href="#cb138-395" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Determine the optimal number of clusters (Elbow or Silhouette methods)</span></span>
<span id="cb138-396"><a href="#cb138-396" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data_scaled, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>) <span class="sc">+</span></span>
<span id="cb138-397"><a href="#cb138-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb138-398"><a href="#cb138-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-399"><a href="#cb138-399" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Run k-means with your chosen number of clusters (say k = 3)</span></span>
<span id="cb138-400"><a href="#cb138-400" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb138-401"><a href="#cb138-401" aria-hidden="true" tabindex="-1"></a>km_res <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data_scaled, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb138-402"><a href="#cb138-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-403"><a href="#cb138-403" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Visualize</span></span>
<span id="cb138-404"><a href="#cb138-404" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_res, <span class="at">data =</span> cluster_data_scaled,</span>
<span id="cb138-405"><a href="#cb138-405" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">ellipse.type =</span> <span class="st">"convex"</span>) <span class="sc">+</span></span>
<span id="cb138-406"><a href="#cb138-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb138-407"><a href="#cb138-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clusters of Knowledge &amp; Motivation Variables"</span>)</span>
<span id="cb138-408"><a href="#cb138-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-409"><a href="#cb138-409" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Inspect cluster means</span></span>
<span id="cb138-410"><a href="#cb138-410" aria-hidden="true" tabindex="-1"></a>cluster_centers <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(km_res<span class="sc">$</span>centers)</span>
<span id="cb138-411"><a href="#cb138-411" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cluster_centers) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(cluster_data)</span>
<span id="cb138-412"><a href="#cb138-412" aria-hidden="true" tabindex="-1"></a>cluster_centers</span>
<span id="cb138-413"><a href="#cb138-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-414"><a href="#cb138-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-415"><a href="#cb138-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-416"><a href="#cb138-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-419"><a href="#cb138-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-420"><a href="#cb138-420" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb138-421"><a href="#cb138-421" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb138-422"><a href="#cb138-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-423"><a href="#cb138-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-424"><a href="#cb138-424" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of hierarchical clustering if that is preferred</span></span>
<span id="cb138-425"><a href="#cb138-425" aria-hidden="true" tabindex="-1"></a>dist_mat <span class="ot">&lt;-</span> <span class="fu">dist</span>(cluster_data_scaled, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb138-426"><a href="#cb138-426" aria-hidden="true" tabindex="-1"></a>hc_res <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist_mat, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb138-427"><a href="#cb138-427" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc_res, <span class="at">main =</span> <span class="st">"Dendrogram of Hierarchical Clustering"</span>)</span>
<span id="cb138-428"><a href="#cb138-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-429"><a href="#cb138-429" aria-hidden="true" tabindex="-1"></a><span class="co"># Cut tree at chosen k</span></span>
<span id="cb138-430"><a href="#cb138-430" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc_res, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb138-431"><a href="#cb138-431" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clusters)</span>
<span id="cb138-432"><a href="#cb138-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-433"><a href="#cb138-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-434"><a href="#cb138-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-435"><a href="#cb138-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-438"><a href="#cb138-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-439"><a href="#cb138-439" aria-hidden="true" tabindex="-1"></a><span class="co"># Example mediation: knowledge -&gt; perceived_difficulty -&gt; env_attitude</span></span>
<span id="cb138-440"><a href="#cb138-440" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb138-441"><a href="#cb138-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-442"><a href="#cb138-442" aria-hidden="true" tabindex="-1"></a>model_mediation <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb138-443"><a href="#cb138-443" aria-hidden="true" tabindex="-1"></a><span class="st">  # direct effect</span></span>
<span id="cb138-444"><a href="#cb138-444" aria-hidden="true" tabindex="-1"></a><span class="st">  env_attitude ~ c*els</span></span>
<span id="cb138-445"><a href="#cb138-445" aria-hidden="true" tabindex="-1"></a><span class="st">  # mediator</span></span>
<span id="cb138-446"><a href="#cb138-446" aria-hidden="true" tabindex="-1"></a><span class="st">  perceived_difficulty_score ~ a*els</span></span>
<span id="cb138-447"><a href="#cb138-447" aria-hidden="true" tabindex="-1"></a><span class="st">  env_attitude ~ b*perceived_difficulty_score</span></span>
<span id="cb138-448"><a href="#cb138-448" aria-hidden="true" tabindex="-1"></a><span class="st">  # indirect effect</span></span>
<span id="cb138-449"><a href="#cb138-449" aria-hidden="true" tabindex="-1"></a><span class="st">  ab := a*b</span></span>
<span id="cb138-450"><a href="#cb138-450" aria-hidden="true" tabindex="-1"></a><span class="st">  # total effect</span></span>
<span id="cb138-451"><a href="#cb138-451" aria-hidden="true" tabindex="-1"></a><span class="st">  total := c + (a*b)</span></span>
<span id="cb138-452"><a href="#cb138-452" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb138-453"><a href="#cb138-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-454"><a href="#cb138-454" aria-hidden="true" tabindex="-1"></a>fit_mediation <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_mediation, <span class="at">data =</span> combined_df, <span class="at">missing=</span><span class="st">"fiml"</span>)</span>
<span id="cb138-455"><a href="#cb138-455" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_mediation, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized=</span><span class="cn">TRUE</span>, <span class="at">rsquare=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-456"><a href="#cb138-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-457"><a href="#cb138-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-458"><a href="#cb138-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-459"><a href="#cb138-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-460"><a href="#cb138-460" aria-hidden="true" tabindex="-1"></a>----</span>
<span id="cb138-461"><a href="#cb138-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-462"><a href="#cb138-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-463"><a href="#cb138-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-464"><a href="#cb138-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-467"><a href="#cb138-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-468"><a href="#cb138-468" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb138-469"><a href="#cb138-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb138-470"><a href="#cb138-470" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Example composite for knowledge: average of (z-scored) numeracy, </span></span>
<span id="cb138-471"><a href="#cb138-471" aria-hidden="true" tabindex="-1"></a>    <span class="co"># energy_use, energy_save, ELS. </span></span>
<span id="cb138-472"><a href="#cb138-472" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (You can also sum them, but average is convenient.)</span></span>
<span id="cb138-473"><a href="#cb138-473" aria-hidden="true" tabindex="-1"></a>    <span class="at">composite_knowledge =</span> <span class="fu">rowMeans</span>(</span>
<span id="cb138-474"><a href="#cb138-474" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(numeracy_score, relative_energy_use_score, </span>
<span id="cb138-475"><a href="#cb138-475" aria-hidden="true" tabindex="-1"></a>            relative_energy_save_score, els),</span>
<span id="cb138-476"><a href="#cb138-476" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">FALSE</span>  <span class="co"># If a row has missing for any item, result = NA</span></span>
<span id="cb138-477"><a href="#cb138-477" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb138-478"><a href="#cb138-478" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb138-479"><a href="#cb138-479" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Example composite for motivation: </span></span>
<span id="cb138-480"><a href="#cb138-480" aria-hidden="true" tabindex="-1"></a>    <span class="co"># env_attitude might be already in a favorable direction, but if </span></span>
<span id="cb138-481"><a href="#cb138-481" aria-hidden="true" tabindex="-1"></a>    <span class="co"># perceived_difficulty is "difficulty," consider reversing so that </span></span>
<span id="cb138-482"><a href="#cb138-482" aria-hidden="true" tabindex="-1"></a>    <span class="co"># higher = "less difficulty" = "higher motivation."</span></span>
<span id="cb138-483"><a href="#cb138-483" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For example: reverse_diff = (-1)*perceived_difficulty_score</span></span>
<span id="cb138-484"><a href="#cb138-484" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Then average with env_attitude (if you want them combined).</span></span>
<span id="cb138-485"><a href="#cb138-485" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If you are including pol_conservatism as well, you must decide </span></span>
<span id="cb138-486"><a href="#cb138-486" aria-hidden="true" tabindex="-1"></a>    <span class="co"># how to handle that in the composite. Possibly reverse-coded </span></span>
<span id="cb138-487"><a href="#cb138-487" aria-hidden="true" tabindex="-1"></a>    <span class="co"># so that higher # = more liberal or more "pro-environment" stance. </span></span>
<span id="cb138-488"><a href="#cb138-488" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (It's your theoretical call.)</span></span>
<span id="cb138-489"><a href="#cb138-489" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb138-490"><a href="#cb138-490" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For now, let's do a small composite with environmental attitude </span></span>
<span id="cb138-491"><a href="#cb138-491" aria-hidden="true" tabindex="-1"></a>    <span class="co"># and reversed difficulty:</span></span>
<span id="cb138-492"><a href="#cb138-492" aria-hidden="true" tabindex="-1"></a>    <span class="at">reverse_diff =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> perceived_difficulty_score,</span>
<span id="cb138-493"><a href="#cb138-493" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb138-494"><a href="#cb138-494" aria-hidden="true" tabindex="-1"></a>    <span class="at">composite_motivation =</span> <span class="fu">rowMeans</span>(</span>
<span id="cb138-495"><a href="#cb138-495" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(env_attitude, reverse_diff), </span>
<span id="cb138-496"><a href="#cb138-496" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">FALSE</span></span>
<span id="cb138-497"><a href="#cb138-497" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb138-498"><a href="#cb138-498" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-499"><a href="#cb138-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-500"><a href="#cb138-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-501"><a href="#cb138-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-502"><a href="#cb138-502" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)  <span class="co"># for nice cluster visualizations</span></span>
<span id="cb138-503"><a href="#cb138-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-504"><a href="#cb138-504" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll create a small data frame with just the two composites, </span></span>
<span id="cb138-505"><a href="#cb138-505" aria-hidden="true" tabindex="-1"></a><span class="co"># removing any incomplete cases</span></span>
<span id="cb138-506"><a href="#cb138-506" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-507"><a href="#cb138-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(composite_knowledge, composite_motivation) <span class="sc">%&gt;%</span></span>
<span id="cb138-508"><a href="#cb138-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb138-509"><a href="#cb138-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-510"><a href="#cb138-510" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide on number of clusters "k". Letâ€™s try k = 3:</span></span>
<span id="cb138-511"><a href="#cb138-511" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb138-512"><a href="#cb138-512" aria-hidden="true" tabindex="-1"></a>km3 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb138-513"><a href="#cb138-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-514"><a href="#cb138-514" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect results</span></span>
<span id="cb138-515"><a href="#cb138-515" aria-hidden="true" tabindex="-1"></a>km3</span>
<span id="cb138-516"><a href="#cb138-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-517"><a href="#cb138-517" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb138-518"><a href="#cb138-518" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km3, <span class="at">data =</span> cluster_data,</span>
<span id="cb138-519"><a href="#cb138-519" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">ellipse.type =</span> <span class="st">"convex"</span>) <span class="sc">+</span></span>
<span id="cb138-520"><a href="#cb138-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb138-521"><a href="#cb138-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means (k=3) Clustering on Knowledge vs. Motivation"</span>)</span>
<span id="cb138-522"><a href="#cb138-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-523"><a href="#cb138-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-524"><a href="#cb138-524" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(km3<span class="sc">$</span>cluster)</span>
<span id="cb138-525"><a href="#cb138-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-526"><a href="#cb138-526" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare mean knowledge &amp; motivation by cluster</span></span>
<span id="cb138-527"><a href="#cb138-527" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-528"><a href="#cb138-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb138-529"><a href="#cb138-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb138-530"><a href="#cb138-530" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb138-531"><a href="#cb138-531" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_knowledge =</span> <span class="fu">mean</span>(composite_knowledge, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb138-532"><a href="#cb138-532" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_motivation =</span> <span class="fu">mean</span>(composite_motivation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-533"><a href="#cb138-533" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb138-534"><a href="#cb138-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-535"><a href="#cb138-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-536"><a href="#cb138-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-537"><a href="#cb138-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-538"><a href="#cb138-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-539"><a href="#cb138-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-540"><a href="#cb138-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-541"><a href="#cb138-541" aria-hidden="true" tabindex="-1"></a>-------</span>
<span id="cb138-542"><a href="#cb138-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-543"><a href="#cb138-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-544"><a href="#cb138-544" aria-hidden="true" tabindex="-1"></a>#1b</span>
<span id="cb138-545"><a href="#cb138-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-548"><a href="#cb138-548" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-549"><a href="#cb138-549" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> attari1 <span class="sc">%&gt;%</span></span>
<span id="cb138-550"><a href="#cb138-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(attari2_scores, <span class="at">by=</span><span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-551"><a href="#cb138-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(els_scores, <span class="at">by=</span><span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-552"><a href="#cb138-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(rs_scores, <span class="at">by=</span><span class="st">"id"</span>)</span>
<span id="cb138-553"><a href="#cb138-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-554"><a href="#cb138-554" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for clarity</span></span>
<span id="cb138-555"><a href="#cb138-555" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(combined_scores) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"perceived_difficulty"</span>, <span class="st">"numeracy"</span>, </span>
<span id="cb138-556"><a href="#cb138-556" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, </span>
<span id="cb138-557"><a href="#cb138-557" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"els_accuracy"</span>, <span class="st">"els_score"</span>,</span>
<span id="cb138-558"><a href="#cb138-558" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"env_attitude"</span>, <span class="st">"env_attitude_z"</span>,</span>
<span id="cb138-559"><a href="#cb138-559" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"pol_conservatism"</span>, <span class="st">"pol_conservatism_z"</span>)</span>
<span id="cb138-560"><a href="#cb138-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-561"><a href="#cb138-561" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(km_result<span class="sc">$</span>cluster)</span>
<span id="cb138-562"><a href="#cb138-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-563"><a href="#cb138-563" aria-hidden="true" tabindex="-1"></a><span class="co"># Create composite knowledge score</span></span>
<span id="cb138-564"><a href="#cb138-564" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>composite_knowledge <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(combined_scores[, <span class="fu">c</span>(<span class="st">"numeracy"</span>, <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, <span class="st">"els_score"</span>)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-565"><a href="#cb138-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-566"><a href="#cb138-566" aria-hidden="true" tabindex="-1"></a><span class="co"># Create standardized scores for profile analysis</span></span>
<span id="cb138-567"><a href="#cb138-567" aria-hidden="true" tabindex="-1"></a>profile_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-568"><a href="#cb138-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, cluster, numeracy, energy_use, energy_save, </span>
<span id="cb138-569"><a href="#cb138-569" aria-hidden="true" tabindex="-1"></a>         els_score, env_attitude, perceived_difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb138-570"><a href="#cb138-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(measure, value, <span class="sc">-</span>id, <span class="sc">-</span>cluster) <span class="sc">%&gt;%</span></span>
<span id="cb138-571"><a href="#cb138-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(measure) <span class="sc">%&gt;%</span></span>
<span id="cb138-572"><a href="#cb138-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_score =</span> <span class="fu">scale</span>(value)[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb138-573"><a href="#cb138-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb138-574"><a href="#cb138-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-575"><a href="#cb138-575" aria-hidden="true" tabindex="-1"></a><span class="co"># Create profile plot</span></span>
<span id="cb138-576"><a href="#cb138-576" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(profile_data, <span class="fu">aes</span>(<span class="at">x =</span> measure, <span class="at">y =</span> z_score, <span class="at">color =</span> cluster, <span class="at">group =</span> cluster)) <span class="sc">+</span></span>
<span id="cb138-577"><a href="#cb138-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb138-578"><a href="#cb138-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb138-579"><a href="#cb138-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb138-580"><a href="#cb138-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb138-581"><a href="#cb138-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb138-582"><a href="#cb138-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Knowledge-Motivation Profiles by Cluster"</span>,</span>
<span id="cb138-583"><a href="#cb138-583" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Measure"</span>, <span class="at">y =</span> <span class="st">"Standardized Score"</span>)</span>
<span id="cb138-584"><a href="#cb138-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-585"><a href="#cb138-585" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Canonical Correlation Analysis between Knowledge and Motivation Sets</span></span>
<span id="cb138-586"><a href="#cb138-586" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CCA)</span>
<span id="cb138-587"><a href="#cb138-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-588"><a href="#cb138-588" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb138-589"><a href="#cb138-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-590"><a href="#cb138-590" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare matrices</span></span>
<span id="cb138-591"><a href="#cb138-591" aria-hidden="true" tabindex="-1"></a>knowledge_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span> <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score) <span class="sc">%&gt;%</span></span>
<span id="cb138-592"><a href="#cb138-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb138-593"><a href="#cb138-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-594"><a href="#cb138-594" aria-hidden="true" tabindex="-1"></a>motivation_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-595"><a href="#cb138-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(env_attitude, perceived_difficulty, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb138-596"><a href="#cb138-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb138-597"><a href="#cb138-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-598"><a href="#cb138-598" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform CCA</span></span>
<span id="cb138-599"><a href="#cb138-599" aria-hidden="true" tabindex="-1"></a>cc_result <span class="ot">&lt;-</span> <span class="fu">cancor</span>(knowledge_vars, motivation_vars)</span>
<span id="cb138-600"><a href="#cb138-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-601"><a href="#cb138-601" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Network Analysis to Visualize Variable Relationships</span></span>
<span id="cb138-602"><a href="#cb138-602" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qgraph)</span>
<span id="cb138-603"><a href="#cb138-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-604"><a href="#cb138-604" aria-hidden="true" tabindex="-1"></a><span class="co"># Create correlation matrix</span></span>
<span id="cb138-605"><a href="#cb138-605" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-606"><a href="#cb138-606" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score,</span>
<span id="cb138-607"><a href="#cb138-607" aria-hidden="true" tabindex="-1"></a>                         env_attitude, perceived_difficulty, pol_conservatism),</span>
<span id="cb138-608"><a href="#cb138-608" aria-hidden="true" tabindex="-1"></a>                 <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb138-609"><a href="#cb138-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-610"><a href="#cb138-610" aria-hidden="true" tabindex="-1"></a><span class="co"># Create network plot</span></span>
<span id="cb138-611"><a href="#cb138-611" aria-hidden="true" tabindex="-1"></a><span class="fu">qgraph</span>(cor_matrix, </span>
<span id="cb138-612"><a href="#cb138-612" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"spring"</span>,</span>
<span id="cb138-613"><a href="#cb138-613" aria-hidden="true" tabindex="-1"></a>       <span class="at">groups =</span> <span class="fu">list</span>(<span class="at">Knowledge =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">Motivation =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb138-614"><a href="#cb138-614" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"lightblue"</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">"lightgreen"</span>, <span class="dv">3</span>)))</span>
<span id="cb138-615"><a href="#cb138-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-616"><a href="#cb138-616" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Mixed Effects Model to Account for Potential Group-Level Effects</span></span>
<span id="cb138-617"><a href="#cb138-617" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb138-618"><a href="#cb138-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-619"><a href="#cb138-619" aria-hidden="true" tabindex="-1"></a>mixed_model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(els_score <span class="sc">~</span> env_attitude <span class="sc">+</span> perceived_difficulty <span class="sc">+</span> </span>
<span id="cb138-620"><a href="#cb138-620" aria-hidden="true" tabindex="-1"></a>                     (<span class="dv">1</span><span class="sc">|</span>cluster), <span class="at">data =</span> combined_scores)</span>
<span id="cb138-621"><a href="#cb138-621" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mixed_model)</span>
<span id="cb138-622"><a href="#cb138-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-623"><a href="#cb138-623" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Structural Equation Model for Path Analysis</span></span>
<span id="cb138-624"><a href="#cb138-624" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb138-625"><a href="#cb138-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-626"><a href="#cb138-626" aria-hidden="true" tabindex="-1"></a><span class="co"># Define model</span></span>
<span id="cb138-627"><a href="#cb138-627" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb138-628"><a href="#cb138-628" aria-hidden="true" tabindex="-1"></a><span class="st">  # Measurement model</span></span>
<span id="cb138-629"><a href="#cb138-629" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span id="cb138-630"><a href="#cb138-630" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation =~ env_attitude + perceived_difficulty + pol_conservatism</span></span>
<span id="cb138-631"><a href="#cb138-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-632"><a href="#cb138-632" aria-hidden="true" tabindex="-1"></a><span class="st">  # Structural model</span></span>
<span id="cb138-633"><a href="#cb138-633" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge ~ motivation</span></span>
<span id="cb138-634"><a href="#cb138-634" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb138-635"><a href="#cb138-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-636"><a href="#cb138-636" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb138-637"><a href="#cb138-637" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">data =</span> combined_scores)</span>
<span id="cb138-638"><a href="#cb138-638" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-639"><a href="#cb138-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-640"><a href="#cb138-640" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Classification Tree for Predicting Knowledge Levels</span></span>
<span id="cb138-641"><a href="#cb138-641" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb138-642"><a href="#cb138-642" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb138-643"><a href="#cb138-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-644"><a href="#cb138-644" aria-hidden="true" tabindex="-1"></a><span class="co"># Create binary knowledge indicator (high/low) based on median split</span></span>
<span id="cb138-645"><a href="#cb138-645" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>knowledge_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(combined_scores<span class="sc">$</span>composite_knowledge <span class="sc">&gt;</span> </span>
<span id="cb138-646"><a href="#cb138-646" aria-hidden="true" tabindex="-1"></a>                                               <span class="fu">median</span>(combined_scores<span class="sc">$</span>composite_knowledge, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb138-647"><a href="#cb138-647" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"High"</span>, <span class="st">"Low"</span>))</span>
<span id="cb138-648"><a href="#cb138-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-649"><a href="#cb138-649" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit tree</span></span>
<span id="cb138-650"><a href="#cb138-650" aria-hidden="true" tabindex="-1"></a>tree_model <span class="ot">&lt;-</span> <span class="fu">rpart</span>(knowledge_level <span class="sc">~</span> env_attitude <span class="sc">+</span> perceived_difficulty <span class="sc">+</span> </span>
<span id="cb138-651"><a href="#cb138-651" aria-hidden="true" tabindex="-1"></a>                     pol_conservatism, <span class="at">data =</span> combined_scores)</span>
<span id="cb138-652"><a href="#cb138-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-653"><a href="#cb138-653" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot tree</span></span>
<span id="cb138-654"><a href="#cb138-654" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree_model, <span class="at">extra =</span> <span class="dv">1</span>)</span>
<span id="cb138-655"><a href="#cb138-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-656"><a href="#cb138-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-657"><a href="#cb138-657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-658"><a href="#cb138-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-659"><a href="#cb138-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-660"><a href="#cb138-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-661"><a href="#cb138-661" aria-hidden="true" tabindex="-1"></a>--------</span>
<span id="cb138-662"><a href="#cb138-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-663"><a href="#cb138-663" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2b</span></span>
<span id="cb138-664"><a href="#cb138-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-667"><a href="#cb138-667" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-668"><a href="#cb138-668" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclust)</span>
<span id="cb138-669"><a href="#cb138-669" aria-hidden="true" tabindex="-1"></a>lpa_model <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(cluster_data_scaled)</span>
<span id="cb138-670"><a href="#cb138-670" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lpa_model)</span>
<span id="cb138-671"><a href="#cb138-671" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lpa_model, <span class="st">"BIC"</span>)</span>
<span id="cb138-672"><a href="#cb138-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-673"><a href="#cb138-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-674"><a href="#cb138-674" aria-hidden="true" tabindex="-1"></a>can_cor <span class="ot">&lt;-</span> <span class="fu">cancor</span>(<span class="fu">select</span>(combined_scores, numeracy, energy_use, energy_save),</span>
<span id="cb138-675"><a href="#cb138-675" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">select</span>(combined_scores, env_attitude_z, perceived_difficulty))</span>
<span id="cb138-676"><a href="#cb138-676" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(can_cor<span class="sc">$</span>cor)</span>
<span id="cb138-677"><a href="#cb138-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-678"><a href="#cb138-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-679"><a href="#cb138-679" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data_scaled, cluster<span class="sc">::</span>pam, <span class="at">method =</span> <span class="st">"silhouette"</span>) <span class="sc">+</span></span>
<span id="cb138-680"><a href="#cb138-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Silhouette Method for Optimal k"</span>)</span>
<span id="cb138-681"><a href="#cb138-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-682"><a href="#cb138-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-683"><a href="#cb138-683" aria-hidden="true" tabindex="-1"></a>sem_model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb138-684"><a href="#cb138-684" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge =~ numeracy + energy_use + energy_save + els_accuracy</span></span>
<span id="cb138-685"><a href="#cb138-685" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation =~ env_attitude_z + perceived_difficulty</span></span>
<span id="cb138-686"><a href="#cb138-686" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge ~ motivation</span></span>
<span id="cb138-687"><a href="#cb138-687" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb138-688"><a href="#cb138-688" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(sem_model, <span class="at">data =</span> combined_scores)</span>
<span id="cb138-689"><a href="#cb138-689" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-690"><a href="#cb138-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-691"><a href="#cb138-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-692"><a href="#cb138-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-693"><a href="#cb138-693" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-694"><a href="#cb138-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb138-695"><a href="#cb138-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(numeracy, env_attitude_z), </span>
<span id="cb138-696"><a href="#cb138-696" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">sd =</span> sd)))</span>
<span id="cb138-697"><a href="#cb138-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-698"><a href="#cb138-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-699"><a href="#cb138-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-700"><a href="#cb138-700" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lpa_model, <span class="st">"BIC"</span>) <span class="co"># Visualize model selection</span></span>
<span id="cb138-701"><a href="#cb138-701" aria-hidden="true" tabindex="-1"></a>lpa_3class <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(cluster_data_scaled, <span class="at">G=</span><span class="dv">3</span>) <span class="co"># Force 3-class solution</span></span>
<span id="cb138-702"><a href="#cb138-702" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lpa_3class, <span class="at">parameters=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-703"><a href="#cb138-703" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lpa_3class, <span class="at">what=</span><span class="st">"classification"</span>) <span class="co"># Visualize classification</span></span>
<span id="cb138-704"><a href="#cb138-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-705"><a href="#cb138-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-706"><a href="#cb138-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-707"><a href="#cb138-707" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Interpret canonical variables</span></span>
<span id="cb138-708"><a href="#cb138-708" aria-hidden="true" tabindex="-1"></a>cancor_loadings <span class="ot">&lt;-</span> can_cor<span class="sc">$</span>xcoef <span class="sc">%&gt;%</span> </span>
<span id="cb138-709"><a href="#cb138-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb138-710"><a href="#cb138-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-711"><a href="#cb138-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Dimension1=</span>V1, <span class="at">Dimension2=</span>V2, <span class="at">Dimension3=</span>V3)</span>
<span id="cb138-712"><a href="#cb138-712" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cancor_loadings)</span>
<span id="cb138-713"><a href="#cb138-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-714"><a href="#cb138-714" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Improve SEM specification</span></span>
<span id="cb138-715"><a href="#cb138-715" aria-hidden="true" tabindex="-1"></a>sem_improved <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb138-716"><a href="#cb138-716" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge =~ numeracy + energy_use + energy_save + els_accuracy</span></span>
<span id="cb138-717"><a href="#cb138-717" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation =~ env_attitude_z + perceived_difficulty</span></span>
<span id="cb138-718"><a href="#cb138-718" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge ~ motivation</span></span>
<span id="cb138-719"><a href="#cb138-719" aria-hidden="true" tabindex="-1"></a><span class="st">  els_accuracy ~~ energy_use # Add residual covariance</span></span>
<span id="cb138-720"><a href="#cb138-720" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb138-721"><a href="#cb138-721" aria-hidden="true" tabindex="-1"></a>fit_improved <span class="ot">&lt;-</span> <span class="fu">sem</span>(sem_improved, <span class="at">data=</span>combined_scores)</span>
<span id="cb138-722"><a href="#cb138-722" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_improved, <span class="at">fit.measures=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-723"><a href="#cb138-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-724"><a href="#cb138-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-725"><a href="#cb138-725" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Validate clusters with outcomes</span></span>
<span id="cb138-726"><a href="#cb138-726" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-727"><a href="#cb138-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb138-728"><a href="#cb138-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">recycling_rate =</span> <span class="fu">mean</span>(env_attitude_z, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-729"><a href="#cb138-729" aria-hidden="true" tabindex="-1"></a>            <span class="at">energy_behavior =</span> <span class="fu">mean</span>(energy_save, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb138-730"><a href="#cb138-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>cluster, <span class="at">names_to=</span><span class="st">"outcome"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-731"><a href="#cb138-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>cluster, <span class="at">y=</span>value, <span class="at">fill=</span>outcome)) <span class="sc">+</span></span>
<span id="cb138-732"><a href="#cb138-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb138-733"><a href="#cb138-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Cluster Validation Through Behavioral Outcomes"</span>)</span>
<span id="cb138-734"><a href="#cb138-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-735"><a href="#cb138-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-736"><a href="#cb138-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-737"><a href="#cb138-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-738"><a href="#cb138-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-739"><a href="#cb138-739" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3b</span></span>
<span id="cb138-740"><a href="#cb138-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-741"><a href="#cb138-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-744"><a href="#cb138-744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-745"><a href="#cb138-745" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all items into a single dataframe</span></span>
<span id="cb138-746"><a href="#cb138-746" aria-hidden="true" tabindex="-1"></a>all_items <span class="ot">&lt;-</span> <span class="fu">full_join</span>(aes_combined, att2_combined, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-747"><a href="#cb138-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(els, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-748"><a href="#cb138-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(rs, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb138-749"><a href="#cb138-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-750"><a href="#cb138-750" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only item columns for factor analysis</span></span>
<span id="cb138-751"><a href="#cb138-751" aria-hidden="true" tabindex="-1"></a>item_columns <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(all_items), <span class="st">"id"</span>)</span>
<span id="cb138-752"><a href="#cb138-752" aria-hidden="true" tabindex="-1"></a>item_data <span class="ot">&lt;-</span> all_items[, item_columns]</span>
<span id="cb138-753"><a href="#cb138-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-754"><a href="#cb138-754" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform factor analysis</span></span>
<span id="cb138-755"><a href="#cb138-755" aria-hidden="true" tabindex="-1"></a>fa_items <span class="ot">&lt;-</span> <span class="fu">fa</span>(item_data, <span class="at">nfactors =</span> <span class="dv">5</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)  <span class="co"># Adjust nfactors as needed</span></span>
<span id="cb138-756"><a href="#cb138-756" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_items, <span class="at">cut =</span> <span class="fl">0.3</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-757"><a href="#cb138-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-758"><a href="#cb138-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-759"><a href="#cb138-759" aria-hidden="true" tabindex="-1"></a><span class="co"># Example SEM model (using lavaan)</span></span>
<span id="cb138-760"><a href="#cb138-760" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb138-761"><a href="#cb138-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-762"><a href="#cb138-762" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb138-763"><a href="#cb138-763" aria-hidden="true" tabindex="-1"></a><span class="st">  # Measurement model</span></span>
<span id="cb138-764"><a href="#cb138-764" aria-hidden="true" tabindex="-1"></a><span class="st">  Knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span id="cb138-765"><a href="#cb138-765" aria-hidden="true" tabindex="-1"></a><span class="st">  Motivation =~ env_attitude_z + perceived_difficulty</span></span>
<span id="cb138-766"><a href="#cb138-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-767"><a href="#cb138-767" aria-hidden="true" tabindex="-1"></a><span class="st">  # Structural model</span></span>
<span id="cb138-768"><a href="#cb138-768" aria-hidden="true" tabindex="-1"></a><span class="st">  Knowledge ~ Motivation</span></span>
<span id="cb138-769"><a href="#cb138-769" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb138-770"><a href="#cb138-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-771"><a href="#cb138-771" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">data =</span> combined_scores)</span>
<span id="cb138-772"><a href="#cb138-772" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-773"><a href="#cb138-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-774"><a href="#cb138-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-775"><a href="#cb138-775" aria-hidden="true" tabindex="-1"></a><span class="co"># Example LPA (using tidyLPA)</span></span>
<span id="cb138-776"><a href="#cb138-776" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyLPA)</span>
<span id="cb138-777"><a href="#cb138-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-778"><a href="#cb138-778" aria-hidden="true" tabindex="-1"></a>lpa_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-779"><a href="#cb138-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score, env_attitude_z, perceived_difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb138-780"><a href="#cb138-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb138-781"><a href="#cb138-781" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert all to numeric</span></span>
<span id="cb138-782"><a href="#cb138-782" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(as.numeric)</span>
<span id="cb138-783"><a href="#cb138-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-784"><a href="#cb138-784" aria-hidden="true" tabindex="-1"></a>lpa_results <span class="ot">&lt;-</span> lpa_data <span class="sc">%&gt;%</span></span>
<span id="cb138-785"><a href="#cb138-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">estimate_profiles</span>(<span class="at">n_profiles =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="co"># Estimate models with 1-5 profiles</span></span>
<span id="cb138-786"><a href="#cb138-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compare_solutions</span>(<span class="at">statistics =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>))</span>
<span id="cb138-787"><a href="#cb138-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-788"><a href="#cb138-788" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lpa_results)</span>
<span id="cb138-789"><a href="#cb138-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-790"><a href="#cb138-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-791"><a href="#cb138-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-792"><a href="#cb138-792" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine optimal k using silhouette method</span></span>
<span id="cb138-793"><a href="#cb138-793" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data_scaled, kmeans, <span class="at">method =</span> <span class="st">"silhouette"</span>) <span class="sc">+</span></span>
<span id="cb138-794"><a href="#cb138-794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Silhouette Method for Optimal k"</span>)</span>
<span id="cb138-795"><a href="#cb138-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-796"><a href="#cb138-796" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of cluster stability assessment (using fpc package)</span></span>
<span id="cb138-797"><a href="#cb138-797" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpc)</span>
<span id="cb138-798"><a href="#cb138-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-799"><a href="#cb138-799" aria-hidden="true" tabindex="-1"></a>clusterboot_result <span class="ot">&lt;-</span> <span class="fu">clusterboot</span>(cluster_data_scaled, <span class="at">B =</span> <span class="dv">100</span>, </span>
<span id="cb138-800"><a href="#cb138-800" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">bootmethod =</span> <span class="st">"boot"</span>, <span class="at">clustermethod =</span> kmeansCBI,</span>
<span id="cb138-801"><a href="#cb138-801" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">krange =</span> <span class="dv">3</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb138-802"><a href="#cb138-802" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(clusterboot_result)</span>
<span id="cb138-803"><a href="#cb138-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-804"><a href="#cb138-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-805"><a href="#cb138-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-806"><a href="#cb138-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-807"><a href="#cb138-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-808"><a href="#cb138-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-809"><a href="#cb138-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-810"><a href="#cb138-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-811"><a href="#cb138-811" aria-hidden="true" tabindex="-1"></a>-----</span>
<span id="cb138-812"><a href="#cb138-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-813"><a href="#cb138-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-814"><a href="#cb138-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-815"><a href="#cb138-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-816"><a href="#cb138-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-819"><a href="#cb138-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-820"><a href="#cb138-820" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 11</span></span>
<span id="cb138-821"><a href="#cb138-821" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb138-822"><a href="#cb138-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-823"><a href="#cb138-823" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Create a correlation matrix of the key knowledge &amp; motivation subscales</span></span>
<span id="cb138-824"><a href="#cb138-824" aria-hidden="true" tabindex="-1"></a><span class="co">#    ensuring no duplicates (e.g., pick either 'env_attitude' or 'env_attitude_z').</span></span>
<span id="cb138-825"><a href="#cb138-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-826"><a href="#cb138-826" aria-hidden="true" tabindex="-1"></a>cor_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-827"><a href="#cb138-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score,</span>
<span id="cb138-828"><a href="#cb138-828" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty, env_attitude, pol_conservatism)</span>
<span id="cb138-829"><a href="#cb138-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-830"><a href="#cb138-830" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Compute correlations</span></span>
<span id="cb138-831"><a href="#cb138-831" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(cor_vars, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb138-832"><a href="#cb138-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-833"><a href="#cb138-833" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Visualize</span></span>
<span id="cb138-834"><a href="#cb138-834" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">type=</span><span class="st">"upper"</span>, </span>
<span id="cb138-835"><a href="#cb138-835" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.col=</span><span class="st">"black"</span>, <span class="at">addCoef.col=</span><span class="st">"black"</span>)</span>
<span id="cb138-836"><a href="#cb138-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-837"><a href="#cb138-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-838"><a href="#cb138-838" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb138-839"><a href="#cb138-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-840"><a href="#cb138-840" aria-hidden="true" tabindex="-1"></a>fa_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-841"><a href="#cb138-841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score,</span>
<span id="cb138-842"><a href="#cb138-842" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty, env_attitude, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb138-843"><a href="#cb138-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb138-844"><a href="#cb138-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-845"><a href="#cb138-845" aria-hidden="true" tabindex="-1"></a>fa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(fa_data, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"ml"</span>)</span>
<span id="cb138-846"><a href="#cb138-846" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result, <span class="at">cut=</span><span class="fl">0.3</span>, <span class="at">sort=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-847"><a href="#cb138-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-848"><a href="#cb138-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-849"><a href="#cb138-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-850"><a href="#cb138-850" aria-hidden="true" tabindex="-1"></a>model_motivation <span class="ot">&lt;-</span> <span class="fu">lm</span>(env_attitude <span class="sc">~</span> els_score <span class="sc">+</span> numeracy <span class="sc">+</span> pol_conservatism,</span>
<span id="cb138-851"><a href="#cb138-851" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data=</span>combined_scores)</span>
<span id="cb138-852"><a href="#cb138-852" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_motivation)</span>
<span id="cb138-853"><a href="#cb138-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-854"><a href="#cb138-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-855"><a href="#cb138-855" aria-hidden="true" tabindex="-1"></a>model_knowledge <span class="ot">&lt;-</span> <span class="fu">lm</span>(els_score <span class="sc">~</span> perceived_difficulty <span class="sc">+</span> env_attitude <span class="sc">+</span> pol_conservatism,</span>
<span id="cb138-856"><a href="#cb138-856" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data=</span>combined_scores)</span>
<span id="cb138-857"><a href="#cb138-857" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_knowledge)</span>
<span id="cb138-858"><a href="#cb138-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-859"><a href="#cb138-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-860"><a href="#cb138-860" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb138-861"><a href="#cb138-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-862"><a href="#cb138-862" aria-hidden="true" tabindex="-1"></a>knowledge_only <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-863"><a href="#cb138-863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score) <span class="sc">%&gt;%</span></span>
<span id="cb138-864"><a href="#cb138-864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb138-865"><a href="#cb138-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb138-866"><a href="#cb138-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-867"><a href="#cb138-867" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb138-868"><a href="#cb138-868" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide k with elbow or silhouette</span></span>
<span id="cb138-869"><a href="#cb138-869" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(knowledge_only, kmeans, <span class="at">method=</span><span class="st">"wss"</span>)</span>
<span id="cb138-870"><a href="#cb138-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-871"><a href="#cb138-871" aria-hidden="true" tabindex="-1"></a>km_knowl <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(knowledge_only, <span class="at">centers=</span><span class="dv">3</span>, <span class="at">nstart=</span><span class="dv">25</span>)</span>
<span id="cb138-872"><a href="#cb138-872" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_knowl, <span class="at">data =</span> knowledge_only)</span>
<span id="cb138-873"><a href="#cb138-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-874"><a href="#cb138-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-875"><a href="#cb138-875" aria-hidden="true" tabindex="-1"></a>all_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-876"><a href="#cb138-876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score,</span>
<span id="cb138-877"><a href="#cb138-877" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty, env_attitude, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb138-878"><a href="#cb138-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb138-879"><a href="#cb138-879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb138-880"><a href="#cb138-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-881"><a href="#cb138-881" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb138-882"><a href="#cb138-882" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(all_vars, kmeans, <span class="at">method=</span><span class="st">"wss"</span>)</span>
<span id="cb138-883"><a href="#cb138-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-884"><a href="#cb138-884" aria-hidden="true" tabindex="-1"></a>km_all <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(all_vars, <span class="at">centers=</span><span class="dv">3</span>, <span class="at">nstart=</span><span class="dv">25</span>)</span>
<span id="cb138-885"><a href="#cb138-885" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_all, <span class="at">data=</span>all_vars)</span>
<span id="cb138-886"><a href="#cb138-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-887"><a href="#cb138-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-888"><a href="#cb138-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-889"><a href="#cb138-889" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-890"><a href="#cb138-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-891"><a href="#cb138-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-892"><a href="#cb138-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-893"><a href="#cb138-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-896"><a href="#cb138-896" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-897"><a href="#cb138-897" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Summarize clusters on an extra measure</span></span>
<span id="cb138-898"><a href="#cb138-898" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-899"><a href="#cb138-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb138-900"><a href="#cb138-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb138-901"><a href="#cb138-901" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_recycling =</span> <span class="fu">mean</span>(env_attitude_z, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-902"><a href="#cb138-902" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_recycling   =</span> <span class="fu">sd</span>(env_attitude_z, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-903"><a href="#cb138-903" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb138-904"><a href="#cb138-904" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb138-905"><a href="#cb138-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(cluster)</span>
<span id="cb138-906"><a href="#cb138-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-907"><a href="#cb138-907" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. ANOVA to test whether clusters differ significantly </span></span>
<span id="cb138-908"><a href="#cb138-908" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(env_attitude_z <span class="sc">~</span> cluster, <span class="at">data =</span> combined_scores)</span>
<span id="cb138-909"><a href="#cb138-909" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span>
<span id="cb138-910"><a href="#cb138-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-911"><a href="#cb138-911" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Pairwise comparisons if ANOVA is significant</span></span>
<span id="cb138-912"><a href="#cb138-912" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb138-913"><a href="#cb138-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-914"><a href="#cb138-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-915"><a href="#cb138-915" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclust)</span>
<span id="cb138-916"><a href="#cb138-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-917"><a href="#cb138-917" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data to knowledge &amp; motivation variables</span></span>
<span id="cb138-918"><a href="#cb138-918" aria-hidden="true" tabindex="-1"></a>lpa_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-919"><a href="#cb138-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score, </span>
<span id="cb138-920"><a href="#cb138-920" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty, env_attitude, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb138-921"><a href="#cb138-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb138-922"><a href="#cb138-922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb138-923"><a href="#cb138-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-924"><a href="#cb138-924" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-based clustering</span></span>
<span id="cb138-925"><a href="#cb138-925" aria-hidden="true" tabindex="-1"></a>lpa_model <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(lpa_data)</span>
<span id="cb138-926"><a href="#cb138-926" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lpa_model)  <span class="co"># Tells you how many clusters &amp; the type of covariance structure</span></span>
<span id="cb138-927"><a href="#cb138-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-928"><a href="#cb138-928" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract membership</span></span>
<span id="cb138-929"><a href="#cb138-929" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>LPA_cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(lpa_model<span class="sc">$</span>classification)</span>
<span id="cb138-930"><a href="#cb138-930" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(combined_scores<span class="sc">$</span>LPA_cluster)</span>
<span id="cb138-931"><a href="#cb138-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-932"><a href="#cb138-932" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare means across the new LPA-based clusters</span></span>
<span id="cb138-933"><a href="#cb138-933" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-934"><a href="#cb138-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LPA_cluster) <span class="sc">%&gt;%</span></span>
<span id="cb138-935"><a href="#cb138-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb138-936"><a href="#cb138-936" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(numeracy<span class="sc">:</span>pol_conservatism, mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-937"><a href="#cb138-937" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-938"><a href="#cb138-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-939"><a href="#cb138-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-940"><a href="#cb138-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-941"><a href="#cb138-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-942"><a href="#cb138-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-943"><a href="#cb138-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-944"><a href="#cb138-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-945"><a href="#cb138-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-946"><a href="#cb138-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-947"><a href="#cb138-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-948"><a href="#cb138-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-949"><a href="#cb138-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-950"><a href="#cb138-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-951"><a href="#cb138-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-952"><a href="#cb138-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-953"><a href="#cb138-953" aria-hidden="true" tabindex="-1"></a>--------</span>
<span id="cb138-954"><a href="#cb138-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-955"><a href="#cb138-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-956"><a href="#cb138-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-957"><a href="#cb138-957" aria-hidden="true" tabindex="-1"></a>#1c</span>
<span id="cb138-958"><a href="#cb138-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-961"><a href="#cb138-961" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-962"><a href="#cb138-962" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all individual survey items from each instrument</span></span>
<span id="cb138-963"><a href="#cb138-963" aria-hidden="true" tabindex="-1"></a>all_items <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(aes_combined, att2_combined) <span class="sc">%&gt;%</span></span>
<span id="cb138-964"><a href="#cb138-964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(els, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-965"><a href="#cb138-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(rs, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb138-966"><a href="#cb138-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-967"><a href="#cb138-967" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only item columns for analysis</span></span>
<span id="cb138-968"><a href="#cb138-968" aria-hidden="true" tabindex="-1"></a>item_data <span class="ot">&lt;-</span> all_items <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>id)</span>
<span id="cb138-969"><a href="#cb138-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-970"><a href="#cb138-970" aria-hidden="true" tabindex="-1"></a>subscale_cors <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-971"><a href="#cb138-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(perceived_difficulty, numeracy, energy_use, energy_save,</span>
<span id="cb138-972"><a href="#cb138-972" aria-hidden="true" tabindex="-1"></a>         els_score, env_attitude_z, pol_conservatism_z) <span class="sc">%&gt;%</span></span>
<span id="cb138-973"><a href="#cb138-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb138-974"><a href="#cb138-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-975"><a href="#cb138-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-976"><a href="#cb138-976" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Knowledge-Motivation Relationship Analyses</span></span>
<span id="cb138-977"><a href="#cb138-977" aria-hidden="true" tabindex="-1"></a><span class="co"># Create composite scores with explicit content alignment</span></span>
<span id="cb138-978"><a href="#cb138-978" aria-hidden="true" tabindex="-1"></a>knowledge_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"numeracy"</span>, <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, <span class="st">"els_score"</span>)</span>
<span id="cb138-979"><a href="#cb138-979" aria-hidden="true" tabindex="-1"></a>motivation_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"env_attitude_z"</span>, <span class="st">"perceived_difficulty"</span>)</span>
<span id="cb138-980"><a href="#cb138-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-981"><a href="#cb138-981" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-982"><a href="#cb138-982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb138-983"><a href="#cb138-983" aria-hidden="true" tabindex="-1"></a>    <span class="at">knowledge =</span> <span class="fu">scale</span>(<span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">all_of</span>(knowledge_vars)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb138-984"><a href="#cb138-984" aria-hidden="true" tabindex="-1"></a>    <span class="at">motivation =</span> <span class="fu">scale</span>(<span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">all_of</span>(motivation_vars)) <span class="sc">*</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb138-985"><a href="#cb138-985" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-986"><a href="#cb138-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-987"><a href="#cb138-987" aria-hidden="true" tabindex="-1"></a><span class="co"># 3a. Bivariate Correlation</span></span>
<span id="cb138-988"><a href="#cb138-988" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(combined_scores, <span class="fu">cor.test</span>(knowledge, motivation))</span>
<span id="cb138-989"><a href="#cb138-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-990"><a href="#cb138-990" aria-hidden="true" tabindex="-1"></a><span class="co"># 3b. Hierarchical Regression</span></span>
<span id="cb138-991"><a href="#cb138-991" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(knowledge <span class="sc">~</span> motivation <span class="sc">+</span> pol_conservatism_z <span class="sc">+</span> cluster, </span>
<span id="cb138-992"><a href="#cb138-992" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> combined_scores)</span>
<span id="cb138-993"><a href="#cb138-993" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb138-994"><a href="#cb138-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-995"><a href="#cb138-995" aria-hidden="true" tabindex="-1"></a><span class="co"># 3c. Path Analysis</span></span>
<span id="cb138-996"><a href="#cb138-996" aria-hidden="true" tabindex="-1"></a>path_model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb138-997"><a href="#cb138-997" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation ~ a * knowledge</span></span>
<span id="cb138-998"><a href="#cb138-998" aria-hidden="true" tabindex="-1"></a><span class="st">  els_score ~ b * motivation + c * knowledge</span></span>
<span id="cb138-999"><a href="#cb138-999" aria-hidden="true" tabindex="-1"></a><span class="st">  indirect := a * b</span></span>
<span id="cb138-1000"><a href="#cb138-1000" aria-hidden="true" tabindex="-1"></a><span class="st">  total := c + indirect</span></span>
<span id="cb138-1001"><a href="#cb138-1001" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb138-1002"><a href="#cb138-1002" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(path_model, <span class="at">data =</span> combined_scores)</span>
<span id="cb138-1003"><a href="#cb138-1003" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-1004"><a href="#cb138-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1005"><a href="#cb138-1005" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Cluster Validation by Motivation-Knowledge Profiles</span></span>
<span id="cb138-1006"><a href="#cb138-1006" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_scores, <span class="fu">aes</span>(<span class="at">x =</span> knowledge, <span class="at">y =</span> motivation, <span class="at">color =</span> cluster)) <span class="sc">+</span></span>
<span id="cb138-1007"><a href="#cb138-1007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb138-1008"><a href="#cb138-1008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">level =</span> <span class="fl">0.95</span>) <span class="sc">+</span></span>
<span id="cb138-1009"><a href="#cb138-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Knowledge-Motivation Profiles by Cluster"</span>,</span>
<span id="cb138-1010"><a href="#cb138-1010" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Standardized Knowledge Composite"</span>,</span>
<span id="cb138-1011"><a href="#cb138-1011" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Standardized Motivation Composite"</span>) <span class="sc">+</span></span>
<span id="cb138-1012"><a href="#cb138-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb138-1013"><a href="#cb138-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-1014"><a href="#cb138-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1015"><a href="#cb138-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1016"><a href="#cb138-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1019"><a href="#cb138-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-1020"><a href="#cb138-1020" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine key measures into correlation matrix</span></span>
<span id="cb138-1021"><a href="#cb138-1021" aria-hidden="true" tabindex="-1"></a>key_measures <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-1022"><a href="#cb138-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb138-1023"><a href="#cb138-1023" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Knowledge measures</span></span>
<span id="cb138-1024"><a href="#cb138-1024" aria-hidden="true" tabindex="-1"></a>    numeracy, energy_use, energy_save, els_score,</span>
<span id="cb138-1025"><a href="#cb138-1025" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Motivation/attitude measures </span></span>
<span id="cb138-1026"><a href="#cb138-1026" aria-hidden="true" tabindex="-1"></a>    env_attitude, perceived_difficulty, pol_conservatism</span>
<span id="cb138-1027"><a href="#cb138-1027" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb138-1028"><a href="#cb138-1028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb138-1029"><a href="#cb138-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1030"><a href="#cb138-1030" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and visualize correlation matrix</span></span>
<span id="cb138-1031"><a href="#cb138-1031" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(key_measures, <span class="at">use=</span><span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb138-1032"><a href="#cb138-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, </span>
<span id="cb138-1033"><a href="#cb138-1033" aria-hidden="true" tabindex="-1"></a>         <span class="at">method=</span><span class="st">"color"</span>,</span>
<span id="cb138-1034"><a href="#cb138-1034" aria-hidden="true" tabindex="-1"></a>         <span class="at">type=</span><span class="st">"upper"</span>,</span>
<span id="cb138-1035"><a href="#cb138-1035" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">"black"</span>,</span>
<span id="cb138-1036"><a href="#cb138-1036" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col=</span><span class="st">"black"</span>,</span>
<span id="cb138-1037"><a href="#cb138-1037" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.srt=</span><span class="dv">45</span>,</span>
<span id="cb138-1038"><a href="#cb138-1038" aria-hidden="true" tabindex="-1"></a>         <span class="at">diag=</span><span class="cn">FALSE</span>,</span>
<span id="cb138-1039"><a href="#cb138-1039" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span>))(<span class="dv">200</span>))</span>
<span id="cb138-1040"><a href="#cb138-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1041"><a href="#cb138-1041" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Factor Analysis to examine underlying structure</span></span>
<span id="cb138-1042"><a href="#cb138-1042" aria-hidden="true" tabindex="-1"></a>fa_results <span class="ot">&lt;-</span> <span class="fu">fa</span>(key_measures, <span class="at">nfactors=</span><span class="dv">2</span>, <span class="at">rotate=</span><span class="st">"varimax"</span>)</span>
<span id="cb138-1043"><a href="#cb138-1043" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_results, <span class="at">cut=</span><span class="fl">0.3</span>, <span class="at">sort=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-1044"><a href="#cb138-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1045"><a href="#cb138-1045" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Create composite scores and analyze relationships</span></span>
<span id="cb138-1046"><a href="#cb138-1046" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-1047"><a href="#cb138-1047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb138-1048"><a href="#cb138-1048" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Knowledge composite (z-score mean)</span></span>
<span id="cb138-1049"><a href="#cb138-1049" aria-hidden="true" tabindex="-1"></a>    <span class="at">knowledge_composite =</span> <span class="fu">scale</span>(<span class="fu">rowMeans</span>(</span>
<span id="cb138-1050"><a href="#cb138-1050" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(<span class="fu">scale</span>(numeracy), <span class="fu">scale</span>(energy_use), </span>
<span id="cb138-1051"><a href="#cb138-1051" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale</span>(energy_save), <span class="fu">scale</span>(els_score)))),</span>
<span id="cb138-1052"><a href="#cb138-1052" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Motivation composite</span></span>
<span id="cb138-1053"><a href="#cb138-1053" aria-hidden="true" tabindex="-1"></a>    <span class="at">motivation_composite =</span> <span class="fu">scale</span>(<span class="fu">rowMeans</span>(</span>
<span id="cb138-1054"><a href="#cb138-1054" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(<span class="fu">scale</span>(env_attitude), <span class="sc">-</span><span class="fu">scale</span>(perceived_difficulty), </span>
<span id="cb138-1055"><a href="#cb138-1055" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span><span class="fu">scale</span>(pol_conservatism))))</span>
<span id="cb138-1056"><a href="#cb138-1056" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-1057"><a href="#cb138-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1058"><a href="#cb138-1058" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Profile Analysis using cluster analysis</span></span>
<span id="cb138-1059"><a href="#cb138-1059" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize variables for clustering</span></span>
<span id="cb138-1060"><a href="#cb138-1060" aria-hidden="true" tabindex="-1"></a>cluster_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-1061"><a href="#cb138-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(knowledge_composite, motivation_composite) <span class="sc">%&gt;%</span></span>
<span id="cb138-1062"><a href="#cb138-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb138-1063"><a href="#cb138-1063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb138-1064"><a href="#cb138-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1065"><a href="#cb138-1065" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine optimal number of clusters</span></span>
<span id="cb138-1066"><a href="#cb138-1066" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_vars, kmeans, <span class="at">method=</span><span class="st">"silhouette"</span>)</span>
<span id="cb138-1067"><a href="#cb138-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1068"><a href="#cb138-1068" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform k-means clustering</span></span>
<span id="cb138-1069"><a href="#cb138-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb138-1070"><a href="#cb138-1070" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># Based on silhouette plot</span></span>
<span id="cb138-1071"><a href="#cb138-1071" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_vars, <span class="at">centers=</span>k, <span class="at">nstart=</span><span class="dv">25</span>)</span>
<span id="cb138-1072"><a href="#cb138-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1073"><a href="#cb138-1073" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize clusters</span></span>
<span id="cb138-1074"><a href="#cb138-1074" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(clusters, <span class="at">data=</span>cluster_vars,</span>
<span id="cb138-1075"><a href="#cb138-1075" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom=</span><span class="st">"point"</span>,</span>
<span id="cb138-1076"><a href="#cb138-1076" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type=</span><span class="st">"convex"</span>,</span>
<span id="cb138-1077"><a href="#cb138-1077" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme=</span><span class="fu">theme_minimal</span>()) <span class="sc">+</span></span>
<span id="cb138-1078"><a href="#cb138-1078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Knowledge-Motivation Profiles"</span>)</span>
<span id="cb138-1079"><a href="#cb138-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1080"><a href="#cb138-1080" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Regression Analysis</span></span>
<span id="cb138-1081"><a href="#cb138-1081" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1: Knowledge predicting motivation</span></span>
<span id="cb138-1082"><a href="#cb138-1082" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(motivation_composite <span class="sc">~</span> knowledge_composite, <span class="at">data=</span>combined_scores)</span>
<span id="cb138-1083"><a href="#cb138-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1084"><a href="#cb138-1084" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2: Controlling for demographics if available</span></span>
<span id="cb138-1085"><a href="#cb138-1085" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(motivation_composite <span class="sc">~</span> knowledge_composite <span class="sc">+</span> pol_conservatism, </span>
<span id="cb138-1086"><a href="#cb138-1086" aria-hidden="true" tabindex="-1"></a>              <span class="at">data=</span>combined_scores)</span>
<span id="cb138-1087"><a href="#cb138-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1088"><a href="#cb138-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_1)</span>
<span id="cb138-1089"><a href="#cb138-1089" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_2)</span>
<span id="cb138-1090"><a href="#cb138-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1091"><a href="#cb138-1091" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Examine cluster profiles</span></span>
<span id="cb138-1092"><a href="#cb138-1092" aria-hidden="true" tabindex="-1"></a>cluster_profiles <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-1093"><a href="#cb138-1093" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cluster =</span> <span class="fu">factor</span>(clusters<span class="sc">$</span>cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb138-1094"><a href="#cb138-1094" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb138-1095"><a href="#cb138-1095" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb138-1096"><a href="#cb138-1096" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb138-1097"><a href="#cb138-1097" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_knowledge =</span> <span class="fu">mean</span>(knowledge_composite, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-1098"><a href="#cb138-1098" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_knowledge =</span> <span class="fu">sd</span>(knowledge_composite, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-1099"><a href="#cb138-1099" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_motivation =</span> <span class="fu">mean</span>(motivation_composite, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb138-1100"><a href="#cb138-1100" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_motivation =</span> <span class="fu">sd</span>(motivation_composite, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb138-1101"><a href="#cb138-1101" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-1102"><a href="#cb138-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1103"><a href="#cb138-1103" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cluster_profiles)</span>
<span id="cb138-1104"><a href="#cb138-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1105"><a href="#cb138-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1106"><a href="#cb138-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1107"><a href="#cb138-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1108"><a href="#cb138-1108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-1109"><a href="#cb138-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1110"><a href="#cb138-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1111"><a href="#cb138-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1112"><a href="#cb138-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1113"><a href="#cb138-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1114"><a href="#cb138-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1115"><a href="#cb138-1115" aria-hidden="true" tabindex="-1"></a>#3c</span>
<span id="cb138-1116"><a href="#cb138-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1119"><a href="#cb138-1119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-1120"><a href="#cb138-1120" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge them into one "long" dataframe with all items.</span></span>
<span id="cb138-1121"><a href="#cb138-1121" aria-hidden="true" tabindex="-1"></a>all_items <span class="ot">&lt;-</span> aes_combined <span class="sc">%&gt;%</span></span>
<span id="cb138-1122"><a href="#cb138-1122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(att2_combined, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-1123"><a href="#cb138-1123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(els,           <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-1124"><a href="#cb138-1124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(rs,            <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb138-1125"><a href="#cb138-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1126"><a href="#cb138-1126" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect how many rows (should match total unique respondents if IDs match)</span></span>
<span id="cb138-1127"><a href="#cb138-1127" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(all_items)</span>
<span id="cb138-1128"><a href="#cb138-1128" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_items)</span>
<span id="cb138-1129"><a href="#cb138-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1130"><a href="#cb138-1130" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively, if you want only the *summarized scale scores* </span></span>
<span id="cb138-1131"><a href="#cb138-1131" aria-hidden="true" tabindex="-1"></a><span class="co"># for each instrument (as in your existing code):</span></span>
<span id="cb138-1132"><a href="#cb138-1132" aria-hidden="true" tabindex="-1"></a><span class="co">#   - attari1, attari2_scores, els_scores, rs_scores </span></span>
<span id="cb138-1133"><a href="#cb138-1133" aria-hidden="true" tabindex="-1"></a><span class="co"># we can merge those:</span></span>
<span id="cb138-1134"><a href="#cb138-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1135"><a href="#cb138-1135" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> attari1 <span class="sc">%&gt;%</span></span>
<span id="cb138-1136"><a href="#cb138-1136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(attari2_scores, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-1137"><a href="#cb138-1137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(els_scores,     <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-1138"><a href="#cb138-1138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(rs_scores,      <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb138-1139"><a href="#cb138-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1140"><a href="#cb138-1140" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for clarity (optional)</span></span>
<span id="cb138-1141"><a href="#cb138-1141" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(combined_scores) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb138-1142"><a href="#cb138-1142" aria-hidden="true" tabindex="-1"></a>  <span class="st">"id"</span>, </span>
<span id="cb138-1143"><a href="#cb138-1143" aria-hidden="true" tabindex="-1"></a>  <span class="st">"perceived_difficulty"</span>,  <span class="co"># from Attari Part 1</span></span>
<span id="cb138-1144"><a href="#cb138-1144" aria-hidden="true" tabindex="-1"></a>  <span class="st">"numeracy"</span>,</span>
<span id="cb138-1145"><a href="#cb138-1145" aria-hidden="true" tabindex="-1"></a>  <span class="st">"energy_use"</span>,</span>
<span id="cb138-1146"><a href="#cb138-1146" aria-hidden="true" tabindex="-1"></a>  <span class="st">"energy_save"</span>,</span>
<span id="cb138-1147"><a href="#cb138-1147" aria-hidden="true" tabindex="-1"></a>  <span class="st">"els_accuracy"</span>,</span>
<span id="cb138-1148"><a href="#cb138-1148" aria-hidden="true" tabindex="-1"></a>  <span class="st">"els_score"</span>,</span>
<span id="cb138-1149"><a href="#cb138-1149" aria-hidden="true" tabindex="-1"></a>  <span class="st">"env_attitude"</span>,</span>
<span id="cb138-1150"><a href="#cb138-1150" aria-hidden="true" tabindex="-1"></a>  <span class="st">"env_attitude_z"</span>,</span>
<span id="cb138-1151"><a href="#cb138-1151" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pol_conservatism"</span>,</span>
<span id="cb138-1152"><a href="#cb138-1152" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pol_conservatism_z"</span></span>
<span id="cb138-1153"><a href="#cb138-1153" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb138-1154"><a href="#cb138-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1155"><a href="#cb138-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1156"><a href="#cb138-1156" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb138-1157"><a href="#cb138-1157" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Examine correlations and underlying structure</span></span>
<span id="cb138-1158"><a href="#cb138-1158" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb138-1159"><a href="#cb138-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1160"><a href="#cb138-1160" aria-hidden="true" tabindex="-1"></a><span class="co"># A. Correlation plot among the *scale-level* variables</span></span>
<span id="cb138-1161"><a href="#cb138-1161" aria-hidden="true" tabindex="-1"></a>cor_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-1162"><a href="#cb138-1162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score,</span>
<span id="cb138-1163"><a href="#cb138-1163" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty, env_attitude, pol_conservatism)</span>
<span id="cb138-1164"><a href="#cb138-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1165"><a href="#cb138-1165" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(cor_vars, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb138-1166"><a href="#cb138-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1167"><a href="#cb138-1167" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize correlation matrix</span></span>
<span id="cb138-1168"><a href="#cb138-1168" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(</span>
<span id="cb138-1169"><a href="#cb138-1169" aria-hidden="true" tabindex="-1"></a>  cor_matrix, </span>
<span id="cb138-1170"><a href="#cb138-1170" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"color"</span>, </span>
<span id="cb138-1171"><a href="#cb138-1171" aria-hidden="true" tabindex="-1"></a>  <span class="at">addCoef.col =</span> <span class="st">"black"</span>, </span>
<span id="cb138-1172"><a href="#cb138-1172" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb138-1173"><a href="#cb138-1173" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col  =</span> <span class="st">"black"</span>,</span>
<span id="cb138-1174"><a href="#cb138-1174" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.srt  =</span> <span class="dv">45</span>,</span>
<span id="cb138-1175"><a href="#cb138-1175" aria-hidden="true" tabindex="-1"></a>  <span class="at">diag    =</span> <span class="cn">FALSE</span></span>
<span id="cb138-1176"><a href="#cb138-1176" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb138-1177"><a href="#cb138-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1178"><a href="#cb138-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1179"><a href="#cb138-1179" aria-hidden="true" tabindex="-1"></a><span class="co"># B. Factor Analysis (to see if knowledge &amp; motivation load differently)</span></span>
<span id="cb138-1180"><a href="#cb138-1180" aria-hidden="true" tabindex="-1"></a><span class="co">#    Using, e.g., 2-factor solution as a demonstration:</span></span>
<span id="cb138-1181"><a href="#cb138-1181" aria-hidden="true" tabindex="-1"></a>fa_data <span class="ot">&lt;-</span> cor_vars <span class="sc">%&gt;%</span></span>
<span id="cb138-1182"><a href="#cb138-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb138-1183"><a href="#cb138-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1184"><a href="#cb138-1184" aria-hidden="true" tabindex="-1"></a>two_factor <span class="ot">&lt;-</span> <span class="fu">fa</span>(fa_data, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">fm =</span> <span class="st">"ml"</span>)</span>
<span id="cb138-1185"><a href="#cb138-1185" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(two_factor, <span class="at">cut =</span> <span class="fl">0.30</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-1186"><a href="#cb138-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1187"><a href="#cb138-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1188"><a href="#cb138-1188" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb138-1189"><a href="#cb138-1189" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Inspect the relation between "motivation" and "knowledge"</span></span>
<span id="cb138-1190"><a href="#cb138-1190" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================</span></span>
<span id="cb138-1191"><a href="#cb138-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1192"><a href="#cb138-1192" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Here are a few different approaches:</span></span>
<span id="cb138-1193"><a href="#cb138-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1194"><a href="#cb138-1194" aria-hidden="true" tabindex="-1"></a><span class="co"># --- (a) Simple regressions</span></span>
<span id="cb138-1195"><a href="#cb138-1195" aria-hidden="true" tabindex="-1"></a><span class="co"># For example: Predict ELS knowledge (els_score) from motivation variables</span></span>
<span id="cb138-1196"><a href="#cb138-1196" aria-hidden="true" tabindex="-1"></a>model_els <span class="ot">&lt;-</span> <span class="fu">lm</span>(els_score <span class="sc">~</span> env_attitude <span class="sc">+</span> perceived_difficulty <span class="sc">+</span> pol_conservatism, </span>
<span id="cb138-1197"><a href="#cb138-1197" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> combined_scores)</span>
<span id="cb138-1198"><a href="#cb138-1198" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_els)</span>
<span id="cb138-1199"><a href="#cb138-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1200"><a href="#cb138-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1201"><a href="#cb138-1201" aria-hidden="true" tabindex="-1"></a><span class="co"># --- (b) Create composites and correlate them</span></span>
<span id="cb138-1202"><a href="#cb138-1202" aria-hidden="true" tabindex="-1"></a><span class="co"># Composite for "knowledge": average of numeracy, energy_use, energy_save, els_score</span></span>
<span id="cb138-1203"><a href="#cb138-1203" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-1204"><a href="#cb138-1204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb138-1205"><a href="#cb138-1205" aria-hidden="true" tabindex="-1"></a>    <span class="at">knowledge_composite =</span> <span class="fu">rowMeans</span>(</span>
<span id="cb138-1206"><a href="#cb138-1206" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(numeracy, energy_use, energy_save, els_score), </span>
<span id="cb138-1207"><a href="#cb138-1207" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb138-1208"><a href="#cb138-1208" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb138-1209"><a href="#cb138-1209" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For "motivation," you might choose env_attitude and reverse-coded difficulty, </span></span>
<span id="cb138-1210"><a href="#cb138-1210" aria-hidden="true" tabindex="-1"></a>    <span class="co"># or some other conceptual combination. Example:</span></span>
<span id="cb138-1211"><a href="#cb138-1211" aria-hidden="true" tabindex="-1"></a>    <span class="at">motivation_composite =</span> <span class="fu">rowMeans</span>(</span>
<span id="cb138-1212"><a href="#cb138-1212" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(env_attitude, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> perceived_difficulty), </span>
<span id="cb138-1213"><a href="#cb138-1213" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb138-1214"><a href="#cb138-1214" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb138-1215"><a href="#cb138-1215" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-1216"><a href="#cb138-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1217"><a href="#cb138-1217" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(combined_scores<span class="sc">$</span>knowledge_composite, combined_scores<span class="sc">$</span>motivation_composite,</span>
<span id="cb138-1218"><a href="#cb138-1218" aria-hidden="true" tabindex="-1"></a>    <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb138-1219"><a href="#cb138-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1220"><a href="#cb138-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1221"><a href="#cb138-1221" aria-hidden="true" tabindex="-1"></a><span class="co"># --- (c) Cluster analysis on knowledge &amp; motivation</span></span>
<span id="cb138-1222"><a href="#cb138-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb138-1223"><a href="#cb138-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1224"><a href="#cb138-1224" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-1225"><a href="#cb138-1225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(knowledge_composite, motivation_composite) <span class="sc">%&gt;%</span></span>
<span id="cb138-1226"><a href="#cb138-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb138-1227"><a href="#cb138-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb138-1228"><a href="#cb138-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1229"><a href="#cb138-1229" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide the number of clusters (k). Let's try k = 3 for illustration:</span></span>
<span id="cb138-1230"><a href="#cb138-1230" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb138-1231"><a href="#cb138-1231" aria-hidden="true" tabindex="-1"></a>km_fit <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb138-1232"><a href="#cb138-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1233"><a href="#cb138-1233" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize clusters</span></span>
<span id="cb138-1234"><a href="#cb138-1234" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_fit, <span class="at">data =</span> cluster_data) <span class="sc">+</span></span>
<span id="cb138-1235"><a href="#cb138-1235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clustering on Knowledge vs. Motivation"</span>) <span class="sc">+</span></span>
<span id="cb138-1236"><a href="#cb138-1236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb138-1237"><a href="#cb138-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1238"><a href="#cb138-1238" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster membership back to your main dataframe</span></span>
<span id="cb138-1239"><a href="#cb138-1239" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>km_cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(km_fit<span class="sc">$</span>cluster)</span>
<span id="cb138-1240"><a href="#cb138-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1241"><a href="#cb138-1241" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare mean knowledge &amp; motivation by cluster</span></span>
<span id="cb138-1242"><a href="#cb138-1242" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-1243"><a href="#cb138-1243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(km_cluster) <span class="sc">%&gt;%</span></span>
<span id="cb138-1244"><a href="#cb138-1244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb138-1245"><a href="#cb138-1245" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_knowledge =</span> <span class="fu">mean</span>(knowledge_composite, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb138-1246"><a href="#cb138-1246" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_motivation =</span> <span class="fu">mean</span>(motivation_composite, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb138-1247"><a href="#cb138-1247" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb138-1248"><a href="#cb138-1248" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb138-1249"><a href="#cb138-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1250"><a href="#cb138-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1251"><a href="#cb138-1251" aria-hidden="true" tabindex="-1"></a><span class="co"># --- (d) Canonical Correlation Analysis (CCA)</span></span>
<span id="cb138-1252"><a href="#cb138-1252" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting your knowledge vs. motivation sets</span></span>
<span id="cb138-1253"><a href="#cb138-1253" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CCA)</span>
<span id="cb138-1254"><a href="#cb138-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1255"><a href="#cb138-1255" aria-hidden="true" tabindex="-1"></a>knowledge_set <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-1256"><a href="#cb138-1256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score) <span class="sc">%&gt;%</span></span>
<span id="cb138-1257"><a href="#cb138-1257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb138-1258"><a href="#cb138-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1259"><a href="#cb138-1259" aria-hidden="true" tabindex="-1"></a>motivation_set <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb138-1260"><a href="#cb138-1260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(env_attitude, perceived_difficulty, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb138-1261"><a href="#cb138-1261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb138-1262"><a href="#cb138-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1263"><a href="#cb138-1263" aria-hidden="true" tabindex="-1"></a><span class="co"># We need same rows for both sets, so do a quick align:</span></span>
<span id="cb138-1264"><a href="#cb138-1264" aria-hidden="true" tabindex="-1"></a>cca_df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">data.frame</span>(knowledge_set, motivation_set))</span>
<span id="cb138-1265"><a href="#cb138-1265" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> cca_df[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb138-1266"><a href="#cb138-1266" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> cca_df[, <span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb138-1267"><a href="#cb138-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1268"><a href="#cb138-1268" aria-hidden="true" tabindex="-1"></a>cca_res <span class="ot">&lt;-</span> <span class="fu">cancor</span>(K, M)</span>
<span id="cb138-1269"><a href="#cb138-1269" aria-hidden="true" tabindex="-1"></a>cca_res<span class="sc">$</span>cor  <span class="co"># canonical correlations</span></span>
<span id="cb138-1270"><a href="#cb138-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1271"><a href="#cb138-1271" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect canonical weights and loadings</span></span>
<span id="cb138-1272"><a href="#cb138-1272" aria-hidden="true" tabindex="-1"></a>cca_res<span class="sc">$</span>xcoef</span>
<span id="cb138-1273"><a href="#cb138-1273" aria-hidden="true" tabindex="-1"></a>cca_res<span class="sc">$</span>ycoef</span>
<span id="cb138-1274"><a href="#cb138-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1275"><a href="#cb138-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1276"><a href="#cb138-1276" aria-hidden="true" tabindex="-1"></a><span class="co"># --- (e) Structural Equation Model (SEM)</span></span>
<span id="cb138-1277"><a href="#cb138-1277" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb138-1278"><a href="#cb138-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1279"><a href="#cb138-1279" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothetical model: </span></span>
<span id="cb138-1280"><a href="#cb138-1280" aria-hidden="true" tabindex="-1"></a><span class="co">#   - latent Knowledge from numeracy, energy_use, energy_save, els_score</span></span>
<span id="cb138-1281"><a href="#cb138-1281" aria-hidden="true" tabindex="-1"></a><span class="co">#   - latent Motivation from env_attitude, perceived_difficulty</span></span>
<span id="cb138-1282"><a href="#cb138-1282" aria-hidden="true" tabindex="-1"></a><span class="co">#   - regression: Knowledge ~ Motivation</span></span>
<span id="cb138-1283"><a href="#cb138-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1284"><a href="#cb138-1284" aria-hidden="true" tabindex="-1"></a>sem_model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb138-1285"><a href="#cb138-1285" aria-hidden="true" tabindex="-1"></a><span class="st">  Knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span id="cb138-1286"><a href="#cb138-1286" aria-hidden="true" tabindex="-1"></a><span class="st">  Motivation =~ env_attitude + perceived_difficulty</span></span>
<span id="cb138-1287"><a href="#cb138-1287" aria-hidden="true" tabindex="-1"></a><span class="st">  Knowledge ~ Motivation</span></span>
<span id="cb138-1288"><a href="#cb138-1288" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb138-1289"><a href="#cb138-1289" aria-hidden="true" tabindex="-1"></a>fit_sem <span class="ot">&lt;-</span> <span class="fu">sem</span>(sem_model, <span class="at">data =</span> combined_scores, <span class="at">missing =</span> <span class="st">"fiml"</span>)  <span class="co"># handle missing if needed</span></span>
<span id="cb138-1290"><a href="#cb138-1290" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_sem, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-1291"><a href="#cb138-1291" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the model if needed: semPaths(fit_sem)</span></span>
<span id="cb138-1292"><a href="#cb138-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1293"><a href="#cb138-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1294"><a href="#cb138-1294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-1295"><a href="#cb138-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-1298"><a href="#cb138-1298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb138-1299"><a href="#cb138-1299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Â© 2025 <a href="https://tegorman13.github.io">Thomas Gorman</a></p>
</div>   
    <div class="nav-footer-center">
<p>site made with <a href="https://cran.r-project.org/"><i class="fa-brands fa-r-project" aria-label="r-project"></i></a> and <a href="https://quarto.org/">Quarto</a></p>
<div class="toc-actions"><ul><li><a href="https://github.com/tegorman13/Survey_Study/blob/main/cors.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://github.com/tegorman13/Survey_Study" target="_blank">
<p><i class="fa-brands fa-github fa-2.0x" aria-label="github"></i></p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>