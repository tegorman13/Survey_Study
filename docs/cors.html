<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.13">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Knowledge &amp; Motivation Instrument Correlations – CCL Survey Study</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./cors1.html" rel="next">
<link href="./inst.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-66ab7fd5e73b7f0a764e0d49b3e29ab1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8ebe664a20a329468a5069a44ff81306.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<!-- academic icons --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
<!-- fontawesome icons --><script src="https://kit.fontawesome.com/1392a7030f.js" crossorigin="anonymous"></script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">CCL Survey Study</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="./org.html" aria-current="page"> 
<span class="menu-text">Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./cors.html"> 
<span class="menu-text">Correlations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./inspect.html"> 
<span class="menu-text">items</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/tegorman13/Survey_Study"> <i class="bi bi-github" role="img" aria-label="github">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./inst.html"><strong>Analyses</strong></a></li><li class="breadcrumb-item"><a href="./cors.html">Correlations</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Analyses</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inst.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">Survey Items</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cors.html" class="sidebar-item-text sidebar-link active"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cors1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instrument Correlations_1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cors2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Knowledge &amp; Motivation Correlations-2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./org.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">Organization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inspect.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-text-fill" role="img">
</i> 
 <span class="menu-text">Inspect</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Background</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/1_JP_summaries_know_mot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Knowledge and motivation - searched by JP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/barber_annotated_bib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Energy Conservation Behavior</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/EnergySurveyInstruments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EnergySurveyInstruments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/nca_draft.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/nsf_instrument_codebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nsf Instrument Codebook</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/overview_files_instruments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instrument study</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bg/survey_codebook_outline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Survey Codebook Outline</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="cor_hugo.md"><i class="bi bi-file-code"></i>CommonMark (hugo)</a></li><li><a href="cors.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./inst.html"><strong>Analyses</strong></a></li><li class="breadcrumb-item"><a href="./cors.html">Correlations</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Knowledge &amp; Motivation Instrument Correlations</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header><section id="knowledge-motivation-instrument-correlations" class="level1"><h1>Knowledge &amp; Motivation Instrument Correlations</h1>
<p>This notebook explores data from a multi-survey study investigating the relationships between sustainable behaviors, knowledge, and attitudes. The study involved participants completing five different surveys, each designed to measure different aspects of these constructs. This analysis focuses on understanding these relationships, with a particular emphasis on the connection between knowledge and motivation.</p>
<section id="data-and-survey-instruments" class="level2"><h2 class="anchored" data-anchor-id="data-and-survey-instruments">Data and Survey Instruments</h2>
<p>The dataset combines responses from five different surveys into a single data frame, structured such that each row represents a participant, and each column represents a response, or a derived score. The five underlying surveys are:</p>
<ul>
<li>
<strong>Energy Literacy Survey (ELS01-ELS08):</strong> Assesses participants’ knowledge of energy concepts through multiple-choice questions.</li>
<li>
<strong>Attari Energy Survey - Part 1:</strong>
<ul>
<li>
<strong>Perceived Difficulty Items (ATT01-ATT15):</strong> Measures how easy or hard participants would find it to adopt energy-saving behaviors, using a rating scale.</li>
<li>
<strong>Numeracy Questions (ATT16-ATT18):</strong> Assesses numerical literacy through probability questions requiring numeric answers.</li>
</ul>
</li>
<li>
<strong>Attari Energy Survey - Part 2:</strong>
<ul>
<li>
<strong>Relative Energy Usage (ATT19-ATT27):</strong> Asks participants to estimate the relative energy usage of various devices compared to a 100-Watt bulb, using a numeric response format.</li>
<li>
<strong>Relative Energy Savings (ATT28-ATT33):</strong> Asks participants to estimate the relative energy savings of various actions compared to turning off a 100-Watt bulb, using a numeric response format.</li>
</ul>
</li>
<li>
<strong>Recycling Study Questions (RS01-RS06):</strong> Assesses participants’ attitudes towards the environment and politics.</li>
</ul></section></section><section id="exploratory-analysis-of-multi-survey-study-on-sustainable-behaviors" class="level1"><h1>Exploratory Analysis of Multi-Survey Study on Sustainable Behaviors</h1>
<p>This notebook presents an exploratory analysis of response data from a multi-survey study focused on understanding the relationships between sustainable behaviors, knowledge, and attitudes. The study involved participants completing five different surveys, each designed to measure different aspects of these constructs. This analysis aims to examine the relationships between the different survey instruments, with a particular focus on the connection between knowledge and motivation.</p>
<section id="data-loading-and-preparation" class="level2"><h2 class="anchored" data-anchor-id="data-loading-and-preparation">Data Loading and Preparation</h2>
<p>This code block loads the required R libraries for data analysis and visualization. It then reads the survey response data from two RDS files, <code>draw.rds</code> and <code>dinst.rds</code>, which presumably contain responses from different groups or conditions. Finally, it combines subsets of the data corresponding to different surveys (Attari Energy Survey Part 1 and Part 2, Energy Literacy Survey, and Recycling Study) into separate data frames.</p>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">dplyr</span>,<span class="va">purrr</span>,<span class="va">tidyr</span>,<span class="va">here</span>, <span class="va">haven</span>,<span class="va">tibble</span>,<span class="va">ggplot2</span>,<span class="va">ggh4x</span>,<span class="va">lme4</span>,<span class="va">knitr</span>,<span class="va">kableExtra</span>,<span class="va">gt</span>,<span class="va">pander</span>,<span class="va">flextable</span>,<span class="va">ggh4x</span>,<span class="va">psych</span>,<span class="va">corrplot</span>,<span class="va">factoextra</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">2</span>, scipen<span class="op">=</span><span class="fl">999</span>, dplyr.summarise.inform<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CCA</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">qgraph</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bethatkinson/rpart">rpart</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.milbo.org/rpart-plot/index.html">rpart.plot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mclust-org.github.io/mclust/">mclust</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://data-edu.github.io/tidyLPA/">tidyLPA</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">select</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"scripts"</span>,<span class="st">"survey_functions.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load data from RDS files</span></span>
<span><span class="va">draw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"draw.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dinst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"dinst.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine data from different sources</span></span>
<span><span class="va">aes1</span> <span class="op">&lt;-</span> <span class="va">draw</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">ATT01</span><span class="op">:</span><span class="va">ATT18</span><span class="op">)</span></span>
<span><span class="va">aes2</span> <span class="op">&lt;-</span> <span class="va">dinst</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">ATT01</span><span class="op">:</span><span class="va">ATT18</span><span class="op">)</span></span>
<span><span class="va">aes_combined</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">aes1</span>, <span class="va">aes2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">att_useSave</span> <span class="op">&lt;-</span> <span class="va">draw</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">ATT19</span><span class="op">:</span><span class="va">ATT33</span><span class="op">)</span></span>
<span><span class="va">att_useSave2</span> <span class="op">&lt;-</span> <span class="va">dinst</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">ATT19</span><span class="op">:</span><span class="va">ATT33</span><span class="op">)</span></span>
<span><span class="va">att2_combined</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">att_useSave</span>, <span class="va">att_useSave2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">els1</span> <span class="op">&lt;-</span> <span class="va">draw</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">ELS01</span><span class="op">:</span><span class="va">ELS08</span><span class="op">)</span></span>
<span><span class="va">els2</span> <span class="op">&lt;-</span> <span class="va">dinst</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">ELS01</span><span class="op">:</span><span class="va">ELS08</span><span class="op">)</span></span>
<span><span class="va">els</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">els1</span>, <span class="va">els2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rs1</span> <span class="op">&lt;-</span> <span class="va">draw</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">RS01</span><span class="op">:</span><span class="va">RS06</span><span class="op">)</span></span>
<span><span class="va">rs2</span> <span class="op">&lt;-</span> <span class="va">dinst</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">RS01</span><span class="op">:</span><span class="va">RS06</span><span class="op">)</span></span>
<span><span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">rs1</span>, <span class="va">rs2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This code block processes the raw survey responses to generate meaningful scores for each participant. It utilizes custom functions (<code>analyze_attari_survey_part1</code>, <code>analyze_attari_survey</code>, <code>analyze_els_survey</code>, <code>analyze_recycling_survey</code>) to calculate scores based on the specific coding schemes of each survey. These individual scores are then combined into a single data frame <code>combined_scores</code>, where each row represents a participant and each column represents a score from one of the surveys. Finally, the columns are renamed for better readability.</p>
</section><section id="data-summarization-and-scoring" class="level2"><h2 class="anchored" data-anchor-id="data-summarization-and-scoring">Data Summarization and Scoring</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Analyze and score each survey</span></span>
<span><span class="va">attari1</span> <span class="op">&lt;-</span> <span class="fu">analyze_attari_survey_part1</span><span class="op">(</span><span class="va">aes_combined</span><span class="op">)</span></span>
<span><span class="va">attari2_scores</span> <span class="op">&lt;-</span> <span class="fu">analyze_attari_survey</span><span class="op">(</span><span class="va">att2_combined</span><span class="op">)</span></span>
<span><span class="va">els_scores</span> <span class="op">&lt;-</span> <span class="fu">analyze_els_survey</span><span class="op">(</span><span class="va">els</span><span class="op">)</span></span>
<span><span class="va">rs_scores</span> <span class="op">&lt;-</span> <span class="fu">analyze_recycling_survey</span><span class="op">(</span><span class="va">rs</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine all scores into one dataframe</span></span>
<span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">attari1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">attari2_scores</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">els_scores</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">rs_scores</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rename columns for clarity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"id"</span>, <span class="st">"perceived_difficulty"</span>, <span class="st">"numeracy"</span>,</span>
<span>  <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>,</span>
<span>  <span class="st">"els_accuracy"</span>, <span class="st">"els_score"</span>,</span>
<span>  <span class="st">"env_attitude"</span>, <span class="st">"env_attitude_z"</span>,</span>
<span>  <span class="st">"pol_conservatism"</span>, <span class="st">"pol_conservatism_z"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="preliminary-data-exploration" class="level2"><h2 class="anchored" data-anchor-id="preliminary-data-exploration">Preliminary Data Exploration</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Preview the combined scores data</span></span>
<span><span class="va">combined_scores</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable_styling</span><span class="op">(</span><span class="st">"striped"</span>, full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">perceived_difficulty</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">numeracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">energy_use</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">energy_save</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">els_accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">els_score</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">env_attitude</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">env_attitude_z</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pol_conservatism</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pol_conservatism_z</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1.101</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">-0.43</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">-0.45</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">-0.45</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">-0.46</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">-1.15</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2.09</td>
<td style="text-align: right;">-2.0</td>
<td style="text-align: right;">-1.440</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-0.33</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">-0.76</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">0.26</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">-0.69</td>
<td style="text-align: right;">-1.3</td>
<td style="text-align: right;">1.346</td>
<td style="text-align: right;">2.16</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1.40</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">-1.15</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">-0.52</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-0.87</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">0.61</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This code provides a glimpse into the structure and content of the <code>combined_scores</code> data frame.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 2%">
<col style="width: 19%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">id</th>
<th style="text-align: left;">perceived_difficulty</th>
<th style="text-align: left;">numeracy</th>
<th style="text-align: left;">energy_use</th>
<th style="text-align: left;">energy_save</th>
<th style="text-align: left;">els_accuracy</th>
<th style="text-align: left;">els_score</th>
<th style="text-align: left;">env_attitude</th>
<th style="text-align: left;">env_attitude_z</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">0.61</td>
<td style="text-align: left;">1.5</td>
<td style="text-align: left;">1.101</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0.74</td>
<td style="text-align: left;">3.2</td>
<td style="text-align: left;">-0.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">-0.45</td>
<td style="text-align: left;">1.5</td>
<td style="text-align: left;">0.137</td>
<td style="text-align: left;">-0.46</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">0.20</td>
<td style="text-align: left;">3.5</td>
<td style="text-align: left;">-0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">2.09</td>
<td style="text-align: left;">-2.0</td>
<td style="text-align: left;">-1.440</td>
<td style="text-align: left;">0.70</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">-0.33</td>
<td style="text-align: left;">3.0</td>
<td style="text-align: left;">-0.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">-0.69</td>
<td style="text-align: left;">-1.3</td>
<td style="text-align: left;">1.346</td>
<td style="text-align: left;">2.16</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">-1.40</td>
<td style="text-align: left;">3.8</td>
<td style="text-align: left;">0.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">0.91</td>
<td style="text-align: left;">1.5</td>
<td style="text-align: left;">0.075</td>
<td style="text-align: left;">-0.52</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">-0.87</td>
<td style="text-align: left;">3.8</td>
<td style="text-align: left;">0.22</td>
</tr>
</tbody>
</table>
<p>This table shows the first five rows of the <code>combined_scores</code> data frame, providing a snapshot of the calculated scores for each participant across the different measures. The scores include perceived difficulty, numeracy, energy use, energy save, ELS accuracy, ELS score, environmental attitude, and the z-score of environmental attitude.</p>
</section><section id="descriptive-statistics" class="level2"><h2 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Histograms of key variables</span></span>
<span><span class="va">key_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">perceived_difficulty</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Melt the data for plotting</span></span>
<span><span class="va">melted_vars</span> <span class="op">&lt;-</span> <span class="va">key_vars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">gather</span><span class="op">(</span>key <span class="op">=</span> <span class="st">"variable"</span>, value <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot histograms</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">melted_vars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Key Variables"</span>, x <span class="op">=</span> <span class="st">"Value"</span>, y <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section><section id="correlation-analysis" class="level2"><h2 class="anchored" data-anchor-id="correlation-analysis">Correlation Analysis</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Select relevant variables</span></span>
<span><span class="va">cor_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>         <span class="va">perceived_difficulty</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute correlation matrix</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">cor_vars</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize correlation matrix</span></span>
<span><span class="fu">corrplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">cor_matrix</span>, </span>
<span>                   method <span class="op">=</span> <span class="st">"color"</span>, </span>
<span>                   addCoef.col <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>                   type <span class="op">=</span> <span class="st">"upper"</span>,</span>
<span>                   tl.col  <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                   tl.srt  <span class="op">=</span> <span class="fl">45</span>,</span>
<span>                   diag    <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="cluster-analysis" class="level2"><h2 class="anchored" data-anchor-id="cluster-analysis">Cluster Analysis</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Prepare data for clustering (select relevant variables and scale)</span></span>
<span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">perceived_difficulty</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>, <span class="va">env_attitude_z</span>, <span class="va">pol_conservatism_z</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Determine optimal number of clusters using the elbow method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_data</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"wss"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Elbow Method for Optimal k"</span>, x <span class="op">=</span> <span class="st">"Number of Clusters k"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code performs a cluster analysis to identify groups of participants with similar profiles across the measured variables. It first prepares the data by selecting the relevant variables, removing rows with missing values, and scaling the data. Then, it uses the elbow method to determine the optimal number of clusters.</p>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform k-means clustering (e.g., with 3 clusters)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">km_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_result</span>,</span>
<span>  data <span class="op">=</span> <span class="va">cluster_data</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>  ellipse.type <span class="op">=</span> <span class="st">"convex"</span>,</span>
<span>  ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means Clustering of Subjects"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code performs k-means clustering with 3 clusters (as suggested by the elbow method) and visualizes the clusters using a scatter plot.</p>
<section id="elbow-method-for-optimal-k" class="level3"><h3 class="anchored" data-anchor-id="elbow-method-for-optimal-k">Elbow Method for Optimal k</h3>
<p>The elbow method suggests that the optimal number of clusters is where the decrease in the within-cluster sum of squares starts to slow down, forming an “elbow”. In the generated plot, the elbow appears to be around 3 or 4 clusters. We will proceed with 3 clusters for this analysis, but further investigation with 4 clusters might be warranted.</p>
</section><section id="k-means-clustering-of-subjects" class="level3"><h3 class="anchored" data-anchor-id="k-means-clustering-of-subjects">K-means Clustering of Subjects</h3>
<p>The scatter plot shows the results of the k-means clustering with 3 clusters. Each point represents a participant, and the color indicates their assigned cluster. The ellipses represent the convex hulls of each cluster. The plot suggests some degree of separation between the clusters, although there is also some overlap.</p>
</section></section><section id="factor-analysis" class="level2"><h2 class="anchored" data-anchor-id="factor-analysis">Factor Analysis</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Scree plot to determine the number of factors</span></span>
<span><span class="va">fa_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">perceived_difficulty</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>, <span class="va">env_attitude_z</span>, <span class="va">pol_conservatism_z</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">scree</span><span class="op">(</span><span class="va">fa_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code performs a factor analysis to explore the underlying structure of the measured variables. It first prepares the data by selecting the relevant variables and removing rows with missing values. Then, it generates a scree plot to help determine the number of factors to extract.</p>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Perform factor analysis with, e.g., 2 factors</span></span>
<span><span class="va">fa_result</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="va">fa_data</span>, nfactors <span class="op">=</span> <span class="fl">2</span>, rotate <span class="op">=</span> <span class="st">"varimax"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fa_result</span>, cut <span class="op">=</span> <span class="fl">0.3</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = fa_data, nfactors = 2, rotate = "varimax")
Standardized loadings (pattern matrix) based upon correlation matrix
                     item   MR1   MR2   h2     u2 com
energy_use              3  0.77       0.61 0.3856 1.1
energy_save             4  0.68       0.49 0.5146 1.1
numeracy                2  0.52       0.29 0.7067 1.2
els_score               5  0.50       0.30 0.6954 1.4
pol_conservatism_z      7             0.14 0.8570 2.0
env_attitude_z          6        0.99 1.00 0.0035 1.0
perceived_difficulty    1       -0.36 0.19 0.8120 1.7

                       MR1  MR2
SS loadings           1.72 1.31
Proportion Var        0.25 0.19
Cumulative Var        0.25 0.43
Proportion Explained  0.57 0.43
Cumulative Proportion 0.57 1.00

Mean item complexity =  1.4
Test of the hypothesis that 2 factors are sufficient.

df null model =  21  with the objective function =  1.3 with Chi Square =  760
df of  the model are 8  and the objective function was  0.03 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.04 

The harmonic n.obs is  586 with the empirical chi square  17  with prob &lt;  0.035 
The total n.obs was  586  with Likelihood Chi Square =  17  with prob &lt;  0.029 

Tucker Lewis Index of factoring reliability =  0.97
RMSEA index =  0.044  and the 90 % confidence intervals are  0.014 0.073
BIC =  -34
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   MR1  MR2
Correlation of (regression) scores with factors   0.87 1.00
Multiple R square of scores with factors          0.76 0.99
Minimum correlation of possible factor scores     0.52 0.99</code></pre>
</div>
</div>
<p>This code performs the factor analysis with 2 factors and prints the results, showing the factor loadings for each variable.</p>
<section id="scree-plot" class="level3"><h3 class="anchored" data-anchor-id="scree-plot">Scree Plot</h3>
<p>The scree plot suggests that 2 or 3 factors might be appropriate, as the eigenvalues drop substantially after the second and third factors.</p>
</section><section id="factor-analysis-results" class="level3"><h3 class="anchored" data-anchor-id="factor-analysis-results">Factor Analysis Results</h3>
<p>The factor analysis results with 2 factors show that:</p>
<ul>
<li>
<strong>Factor 1</strong> is primarily associated with <code>env_attitude_z</code> and <code>pol_conservatism_z</code>, suggesting a factor related to environmental and political attitudes.</li>
<li>
<strong>Factor 2</strong> is primarily associated with <code>energy_use</code>, <code>energy_save</code>, <code>numeracy</code>, and <code>els_score</code>, suggesting a factor related to energy knowledge and behavior.</li>
<li>
<code>perceived_difficulty</code> loads negatively on Factor 2, indicating that individuals with higher energy knowledge and better energy-saving behaviors tend to perceive these behaviors as less difficult.</li>
</ul></section></section><section id="regression-analysis" class="level2"><h2 class="anchored" data-anchor-id="regression-analysis">Regression Analysis</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Model predicting ELS from motivation, controlling for other knowledge scores</span></span>
<span><span class="va">model_els_enhanced</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els_score</span> <span class="op">~</span> <span class="va">perceived_difficulty</span> <span class="op">+</span> <span class="va">env_attitude_z</span> <span class="op">+</span> <span class="va">pol_conservatism_z</span> <span class="op">+</span></span>
<span>  <span class="va">numeracy</span> <span class="op">+</span> <span class="va">energy_use</span> <span class="op">+</span> <span class="va">energy_save</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_els_enhanced</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els_score ~ perceived_difficulty + env_attitude_z + 
    pol_conservatism_z + numeracy + energy_use + energy_save, 
    data = combined_scores)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.8527 -0.5932 -0.0299  0.6199  1.8308 

Coefficients:
                                 Estimate           Std. Error t value Pr(&gt;|t|)
(Intercept)          -0.00000000000000163  0.03613218269822796    0.00   1.0000
perceived_difficulty -0.06114449214752567  0.04004735896976241   -1.53   0.1274
env_attitude_z        0.13430310791561964  0.04088654156087833    3.28   0.0011
pol_conservatism_z   -0.02729118081676693  0.03888339472559318   -0.70   0.4830
numeracy              0.16978503215872956  0.04078151886943691    4.16 0.000036
energy_use            0.19904507771344263  0.04637687030463776    4.29 0.000021
energy_save           0.13859460176947813  0.04521755406911262    3.07   0.0023
                        
(Intercept)             
perceived_difficulty    
env_attitude_z       ** 
pol_conservatism_z      
numeracy             ***
energy_use           ***
energy_save          ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.88 on 579 degrees of freedom
Multiple R-squared:  0.243, Adjusted R-squared:  0.235 
F-statistic: 30.9 on 6 and 579 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
</div>
<p>This code performs a linear regression analysis to examine the relationship between energy literacy (ELS) and motivation, while controlling for other knowledge scores.</p>
<section id="regression-results" class="level3"><h3 class="anchored" data-anchor-id="regression-results">Regression Results</h3>
<p>The regression results show that:</p>
<ul>
<li>
<code>env_attitude_z</code> is a significant positive predictor of ELS, indicating that individuals with more pro-environmental attitudes tend to have higher energy literacy.</li>
<li>
<code>numeracy</code>, <code>energy_use</code>, and <code>energy_save</code> are also significant positive predictors of ELS, suggesting that individuals with higher numeracy skills and those who are more accurate in their estimations of energy use and savings tend to have higher energy literacy.</li>
</ul>
<section id="mixed-effects-regression" class="level4"><h4 class="anchored" data-anchor-id="mixed-effects-regression">Mixed Effects Regression</h4>
<p>Finally, we can examine a regression where a clustering variable is treated as a random effect.</p>
</section></section></section><section id="interaction-effects-in-regression" class="level2"><h2 class="anchored" data-anchor-id="interaction-effects-in-regression">Interaction Effects in Regression</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example: Interaction between environmental attitude and perceived difficulty on ELS</span></span>
<span><span class="va">model_interaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els_score</span> <span class="op">~</span> <span class="va">perceived_difficulty</span> <span class="op">*</span> <span class="va">env_attitude_z</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_interaction</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els_score ~ perceived_difficulty * env_attitude_z, 
    data = combined_scores)

Residuals:
   Min     1Q Median     3Q    Max 
-3.169 -0.678  0.026  0.689  2.285 

Coefficients:
                                    Estimate Std. Error t value   Pr(&gt;|t|)    
(Intercept)                          -0.0130     0.0423   -0.31     0.7592    
perceived_difficulty                 -0.1383     0.0428   -3.23     0.0013 ** 
env_attitude_z                        0.2187     0.0428    5.11 0.00000045 ***
perceived_difficulty:env_attitude_z  -0.0337     0.0393   -0.86     0.3915    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.96 on 582 degrees of freedom
Multiple R-squared:  0.0915,    Adjusted R-squared:  0.0868 
F-statistic: 19.5 on 3 and 582 DF,  p-value: 0.00000000000438</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize the interaction (example)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">combined_scores</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">perceived_difficulty</span>, y <span class="op">=</span> <span class="va">els_score</span>, color <span class="op">=</span> <span class="va">env_attitude_z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_color_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Interaction of Perceived Difficulty and Environmental Attitude on ELS"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Perceived Difficulty"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Energy Literacy Score"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code explores the potential interaction effect between environmental attitude and perceived difficulty on ELS using a linear regression model. It also visualizes the interaction using a scatter plot with a regression line for each level of environmental attitude.</p>
<section id="interaction-results" class="level3"><h3 class="anchored" data-anchor-id="interaction-results">Interaction Results</h3>
<p>The regression results do not show a significant interaction effect between perceived difficulty and environmental attitude on ELS. The visualization also suggests that the relationship between perceived difficulty and ELS does not vary substantially across different levels of environmental attitude.</p>
</section></section><section id="enhanced-correlation-plot" class="level2"><h2 class="anchored" data-anchor-id="enhanced-correlation-plot">Enhanced Correlation Plot</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">combined_df</span> <span class="op">&lt;-</span> <span class="va">attari1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">attari2_scores</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">els_scores</span>,       by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">rs_scores</span>,        by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1. Enhanced Correlation Plot</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>,</span>
<span>         <span class="va">relative_energy_save_score</span>, <span class="va">els</span>,</span>
<span>         <span class="va">perceived_difficulty_score</span>, <span class="va">env_attitude</span>,</span>
<span>         <span class="va">pol_conservatism_z</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span><span class="fu">corrplot</span><span class="op">(</span><span class="va">cor_matrix</span>, method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"upper"</span>, addCoef.col <span class="op">=</span> <span class="st">"black"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">45</span>, diag <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This generates a visually informative correlation plot.</p>
<section id="correlation-plot-interpretation" class="level3"><h3 class="anchored" data-anchor-id="correlation-plot-interpretation">Correlation Plot Interpretation</h3>
<p>The correlation plot reveals several interesting patterns:</p>
<ul>
<li>
<strong>Positive correlations</strong> among knowledge measures (numeracy, energy use, energy save, and ELS).</li>
<li>
<strong>Negative correlations</strong> between perceived difficulty and knowledge measures.</li>
<li>
<strong>Positive correlation</strong> between environmental attitude and ELS.</li>
<li>
<strong>Negative correlation</strong> between political conservatism and environmental attitude.</li>
</ul></section></section><section id="knowledge-profile-clustering" class="level2"><h2 class="anchored" data-anchor-id="knowledge-profile-clustering">Knowledge Profile Clustering</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Knowledge Profile Clustering</span></span>
<span><span class="co"># Standardize knowledge variables</span></span>
<span><span class="va">knowledge_vars</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>,</span>
<span>         <span class="va">relative_energy_save_score</span>, <span class="va">els</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Determine optimal number of clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">wss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">knowledge_vars</span>, centers <span class="op">=</span> <span class="va">k</span><span class="op">)</span><span class="op">$</span><span class="va">tot.withinss</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform k-means clustering</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># Based on elbow plot inspection</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">knowledge_vars</span>, centers <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add cluster membership to data</span></span>
<span><span class="va">combined_df</span><span class="op">$</span><span class="va">knowledge_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize clusters</span></span>
<span><span class="va">pca_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">knowledge_vars</span><span class="op">)</span></span>
<span><span class="va">cluster_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  PC1 <span class="op">=</span> <span class="va">pca_result</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>  PC2 <span class="op">=</span> <span class="va">pca_result</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>  Cluster <span class="op">=</span> <span class="va">combined_df</span><span class="op">$</span><span class="va">knowledge_cluster</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create cluster visualization</span></span>
<span><span class="va">p_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">cluster_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC1</span>, y <span class="op">=</span> <span class="va">PC2</span>, color <span class="op">=</span> <span class="va">Cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ellipse.html">stat_ellipse</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Knowledge Profiles Clustering"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"First Principal Component"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Second Principal Component"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">p_clusters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The regression results do not show a significant interaction effect between perceived difficulty and environmental attitude on ELS. The visualization also suggests that the relationship between perceived difficulty and ELS does not vary substantially across different levels of environmental attitude.</p>
</section><section id="knowledge-motivation-interaction-analysis" class="level2"><h2 class="anchored" data-anchor-id="knowledge-motivation-interaction-analysis">Knowledge-Motivation Interaction Analysis</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 4. Knowledge-Motivation Interaction Analysis</span></span>
<span><span class="va">interaction_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">els</span> <span class="op">~</span> <span class="va">env_attitude</span> <span class="op">*</span> <span class="va">perceived_difficulty_score</span> <span class="op">+</span></span>
<span>  <span class="va">numeracy_score</span>, data <span class="op">=</span> <span class="va">combined_df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">interaction_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = els ~ env_attitude * perceived_difficulty_score + 
    numeracy_score, data = combined_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.0152 -0.6285  0.0088  0.6599  2.2174 

Coefficients:
                                        Estimate Std. Error t value
(Intercept)                              -0.7906     0.1966   -4.02
env_attitude                              0.2192     0.0538    4.07
perceived_difficulty_score               -0.0550     0.1782   -0.31
numeracy_score                            0.2909     0.0387    7.52
env_attitude:perceived_difficulty_score  -0.0177     0.0488   -0.36
                                                Pr(&gt;|t|)    
(Intercept)                             0.00006570557947 ***
env_attitude                            0.00005257587373 ***
perceived_difficulty_score                          0.76    
numeracy_score                          0.00000000000021 ***
env_attitude:perceived_difficulty_score             0.72    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.91 on 581 degrees of freedom
Multiple R-squared:  0.172, Adjusted R-squared:  0.166 
F-statistic: 30.2 on 4 and 581 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
</div>
<p>The regression results do not show a significant interaction effect between environmental attitude and perceived difficulty in predicting ELS.</p>
<section id="interaction-analysis-results" class="level3"><h3 class="anchored" data-anchor-id="interaction-analysis-results">Interaction Analysis Results</h3>
<p>The regression results do not show a significant interaction effect between environmental attitude and perceived difficulty in predicting ELS.</p>
</section></section><section id="cluster-profile-analysis" class="level2"><h2 class="anchored" data-anchor-id="cluster-profile-analysis">Cluster Profile Analysis</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Cluster profile analysis</span></span>
<span><span class="va">cluster_profiles</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">knowledge_cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean_numeracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">numeracy_score</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_energy_use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">relative_energy_use_score</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_energy_save <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">relative_energy_save_score</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_els <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">els</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_env_attitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">env_attitude</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_difficulty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">perceived_difficulty_score</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cluster_profiles</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 8
  knowledge_cluster mean_numeracy mean_energy_use mean_energy_save mean_els
  &lt;fct&gt;                     &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;    &lt;dbl&gt;
1 1                        -1.43           -0.670           -0.679   -0.790
2 2                         0.361          -0.386           -0.470   -0.463
3 3                         0.459           0.635            0.705    0.756
# ℹ 3 more variables: mean_env_attitude &lt;dbl&gt;, mean_difficulty &lt;dbl&gt;, n &lt;int&gt;</code></pre>
</div>
</div>
<p>This code calculates the mean scores on each variable for each of the three knowledge clusters identified earlier.</p>
<section id="cluster-profile-analysis-results" class="level3"><h3 class="anchored" data-anchor-id="cluster-profile-analysis-results">Cluster Profile Analysis Results</h3>
<p>The table shows the mean scores for each cluster on the knowledge and motivation variables. This allows for a detailed comparison of the profiles of each cluster. For example, Cluster 1 has below average scores on all knowledge and motivation measures, while Cluster 3 has above average scores on those same measures.</p>
</section></section><section id="k-means-clustering-on-knowledge-and-motivation-variables" class="level2"><h2 class="anchored" data-anchor-id="k-means-clustering-on-knowledge-and-motivation-variables">K-means Clustering on Knowledge and Motivation Variables</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example: K-means clustering on knowledge + motivation</span></span>
<span><span class="co"># Subset your knowledge &amp; motivation columns</span></span>
<span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">combined_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy_score</span>, <span class="va">relative_energy_use_score</span>, <span class="va">relative_energy_save_score</span>,</span>
<span>         <span class="va">els</span>, <span class="va">perceived_difficulty_score</span>, <span class="va">env_attitude</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Scale them</span></span>
<span><span class="va">cluster_data_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">cluster_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Decide on number of clusters (e.g. 2-5) use e.g. Elbow method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"wss"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The elbow method plot suggests 3 clusters is a reasonable choice.</p>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Suppose we choose 3 clusters as a demonstration</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">km_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data_scaled</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add cluster membership back into the original data</span></span>
<span><span class="va">cluster_data</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">km_result</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize clusters in 2D (using PCA behind the scenes)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_result</span>,</span>
<span>             data <span class="op">=</span> <span class="va">cluster_data_scaled</span>,</span>
<span>             geom <span class="op">=</span> <span class="st">"point"</span>, ellipse.type <span class="op">=</span> <span class="st">"convex"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means Clusters of Knowledge &amp; Motivation Variables"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code performs the k-means clustering with 3 clusters and visualizes the results using a scatter plot.</p>
<section id="clustering-results" class="level3"><h3 class="anchored" data-anchor-id="clustering-results">Clustering Results</h3>
<p>The elbow method suggests that 3 clusters might be appropriate. The scatter plot shows the three clusters based on the combined knowledge and motivation variables.</p>
</section></section><section id="mediation-analysis" class="level2"><h2 class="anchored" data-anchor-id="mediation-analysis">Mediation Analysis</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example mediation: knowledge -&gt; perceived_difficulty -&gt; env_attitude</span></span>
<span><span class="va">model_mediation</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  # direct effect</span></span>
<span><span class="st">  env_attitude ~ c*els</span></span>
<span><span class="st">  # mediator</span></span>
<span><span class="st">  perceived_difficulty_score ~ a*els</span></span>
<span><span class="st">  env_attitude ~ b*perceived_difficulty_score</span></span>
<span><span class="st">  # indirect effect</span></span>
<span><span class="st">  ab := a*b</span></span>
<span><span class="st">  # total effect</span></span>
<span><span class="st">  total := c + (a*b)</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_mediation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model_mediation</span>, data <span class="op">=</span> <span class="va">combined_df</span>, missing <span class="op">=</span> <span class="st">"fiml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_mediation</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span>, rsquare <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         7

  Number of observations                           586
  Number of missing patterns                         1

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Model Test Baseline Model:

  Test statistic                               149.690
  Degrees of freedom                                 3
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000
  Tucker-Lewis Index (TLI)                       1.000
                                                      
  Robust Comparative Fit Index (CFI)             1.000
  Robust Tucker-Lewis Index (TLI)                1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1434.548
  Loglikelihood unrestricted model (H1)      -1434.548
                                                      
  Akaike (AIC)                                2883.095
  Bayesian (BIC)                              2913.709
  Sample-size adjusted Bayesian (SABIC)       2891.486

Root Mean Square Error of Approximation:

  RMSEA                                          0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.000
  P-value H_0: RMSEA &lt;= 0.050                       NA
  P-value H_0: RMSEA &gt;= 0.080                       NA
                                                      
  Robust RMSEA                                   0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.000
  P-value H_0: Robust RMSEA &lt;= 0.050                NA
  P-value H_0: Robust RMSEA &gt;= 0.080                NA

Standardized Root Mean Square Residual:

  SRMR                                           0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Regressions:
                               Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
  env_attitude ~                                                           
    els        (c)                0.152    0.029    5.151    0.000    0.152
  perceived_difficulty_score ~                                             
    els        (a)               -0.222    0.040   -5.506    0.000   -0.222
  env_attitude ~                                                           
    prcvd_dff_ (b)               -0.263    0.029   -8.934    0.000   -0.263
  Std.all
         
    0.197
         
   -0.222
         
   -0.342

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .env_attitude      3.583    0.029  124.796    0.000    3.583    4.653
   .prcvd_dffclty_    0.000    0.040    0.000    1.000    0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .env_attitude      0.483    0.028   17.117    0.000    0.483    0.815
   .prcvd_dffclty_    0.949    0.055   17.117    0.000    0.949    0.951

R-Square:
                   Estimate
    env_attitude      0.185
    prcvd_dffclty_    0.049

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    ab                0.058    0.012    4.687    0.000    0.058    0.076
    total             0.210    0.031    6.862    0.000    0.210    0.273</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tidySEM</span><span class="fu">::</span><span class="fu"><a href="https://cjvanlissa.github.io/tidySEM/reference/graph_sem.html">graph_sem</a></span><span class="op">(</span><span class="va">fit_mediation</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">semPlot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html">semPaths</a></span><span class="op">(</span><span class="va">fit_mediation</span>,layout<span class="op">=</span><span class="st">"tree2"</span>,residual<span class="op">=</span><span class="cn">TRUE</span>,whatLabels<span class="op">=</span><span class="st">"est"</span>, nCharNodes <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code performs a mediation analysis to test whether perceived difficulty mediates the relationship between knowledge (ELS) and environmental attitude.</p>
</section></section><section id="modeling-the-relationship-between-knowledge-and-motivation-using-structural-equation-modeling" class="level1"><h1>Modeling the Relationship between Knowledge and Motivation using Structural Equation Modeling</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Hypothetical model:</span></span>
<span><span class="co">#   - latent Knowledge from numeracy, energy_use, energy_save, els_score</span></span>
<span><span class="co">#   - latent Motivation from env_attitude, perceived_difficulty</span></span>
<span><span class="co">#   - regression: Knowledge ~ Motivation</span></span>
<span></span>
<span><span class="va">sem_model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  Knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span><span class="st">  Motivation =~ env_attitude + perceived_difficulty</span></span>
<span><span class="st">  Knowledge ~ Motivation</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_sem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">sem_model</span>, data <span class="op">=</span> <span class="va">combined_scores</span>, missing <span class="op">=</span> <span class="st">"fiml"</span><span class="op">)</span>  <span class="co"># handle missing if needed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_sem</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 36 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        19

  Number of observations                           586
  Number of missing patterns                         1

Model Test User Model:
                                                      
  Test statistic                                23.012
  Degrees of freedom                                 8
  P-value (Chi-square)                           0.003

Model Test Baseline Model:

  Test statistic                               680.231
  Degrees of freedom                                15
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.977
  Tucker-Lewis Index (TLI)                       0.958
                                                      
  Robust Comparative Fit Index (CFI)             0.977
  Robust Tucker-Lewis Index (TLI)                0.958

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -4504.774
  Loglikelihood unrestricted model (H1)      -4493.268
                                                      
  Akaike (AIC)                                9047.548
  Bayesian (BIC)                              9130.641
  Sample-size adjusted Bayesian (SABIC)       9070.323

Root Mean Square Error of Approximation:

  RMSEA                                          0.057
  90 Percent confidence interval - lower         0.030
  90 Percent confidence interval - upper         0.084
  P-value H_0: RMSEA &lt;= 0.050                    0.305
  P-value H_0: RMSEA &gt;= 0.080                    0.086
                                                      
  Robust RMSEA                                   0.057
  90 Percent confidence interval - lower         0.030
  90 Percent confidence interval - upper         0.084
  P-value H_0: Robust RMSEA &lt;= 0.050             0.305
  P-value H_0: Robust RMSEA &gt;= 0.080             0.086

Standardized Root Mean Square Residual:

  SRMR                                           0.028

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Knowledge =~                                                          
    numeracy          1.000                               0.527    0.527
    energy_use        1.469    0.135   10.849    0.000    0.774    0.774
    energy_save       1.352    0.129   10.452    0.000    0.712    0.713
    els_score         1.029    0.110    9.400    0.000    0.542    0.543
  Motivation =~                                                         
    env_attitude      1.000                               0.477    0.619
    percvd_dffclty   -1.306    0.208   -6.269    0.000   -0.622   -0.623

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Knowledge ~                                                           
    Motivation        0.584    0.099    5.923    0.000    0.529    0.529

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .numeracy          0.000    0.041    0.000    1.000    0.000    0.000
   .energy_use       -0.000    0.041   -0.000    1.000   -0.000   -0.000
   .energy_save      -0.000    0.041   -0.000    1.000   -0.000   -0.000
   .els_score         0.000    0.041    0.000    1.000    0.000    0.000
   .env_attitude      3.583    0.032  112.638    0.000    3.583    4.653
   .percvd_dffclty    0.000    0.041    0.000    1.000    0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .numeracy          0.721    0.048   15.124    0.000    0.721    0.722
   .energy_use        0.400    0.042    9.432    0.000    0.400    0.400
   .energy_save       0.491    0.042   11.751    0.000    0.491    0.492
   .els_score         0.704    0.047   14.845    0.000    0.704    0.705
   .env_attitude      0.366    0.041    8.844    0.000    0.366    0.617
   .percvd_dffclty    0.611    0.070    8.711    0.000    0.611    0.612
   .Knowledge         0.200    0.036    5.567    0.000    0.721    0.721
    Motivation        0.227    0.045    5.079    0.000    1.000    1.000</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tidySEM</span><span class="fu">::</span><span class="fu"><a href="https://cjvanlissa.github.io/tidySEM/reference/graph_sem.html">graph_sem</a></span><span class="op">(</span><span class="va">fit_sem</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">semPlot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html">semPaths</a></span><span class="op">(</span><span class="va">fit_sem</span>,layout<span class="op">=</span><span class="st">"tree2"</span>,residual<span class="op">=</span><span class="cn">TRUE</span>,whatLabels<span class="op">=</span><span class="st">"est"</span>, nCharNodes <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="mediation-analysis-results" class="level3"><h3 class="anchored" data-anchor-id="mediation-analysis-results">Mediation Analysis Results</h3>
<p>The mediation analysis results suggest that perceived difficulty partially mediates the relationship between ELS and environmental attitude. The indirect effect is significant, indicating that higher ELS is associated with lower perceived difficulty, which in turn is associated with a more positive environmental attitude.</p>
</section><section id="knowledge-motivation-profiles-by-cluster" class="level2"><h2 class="anchored" data-anchor-id="knowledge-motivation-profiles-by-cluster">Knowledge-Motivation Profiles by Cluster</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create composite knowledge score</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">composite_knowledge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"numeracy"</span>, <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, <span class="st">"els_score"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensure cluster column exists</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">cluster_data</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create standardized scores for profile analysis</span></span>
<span><span class="va">profile_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">cluster</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>,</span>
<span>         <span class="va">els_score</span>, <span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">gather</span><span class="op">(</span><span class="va">measure</span>, <span class="va">value</span>, <span class="op">-</span><span class="va">id</span>, <span class="op">-</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">measure</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>z_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create profile plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">profile_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">measure</span>, y <span class="op">=</span> <span class="va">z_score</span>, color <span class="op">=</span> <span class="va">cluster</span>, group <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"line"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Knowledge-Motivation Profiles by Cluster"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Measure"</span>, y <span class="op">=</span> <span class="st">"Standardized Score"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The profile plot shows distinct patterns for each cluster:</p>
<ul>
<li>
<strong>Cluster 1:</strong> Below average on all knowledge measures, above average on perceived difficulty, and average on environmental attitude.</li>
<li>
<strong>Cluster 2:</strong> Above average on knowledge measures, below average on perceived difficulty, and average on environmental attitude.</li>
<li>
<strong>Cluster 3:</strong> Average on knowledge measures, below average on perceived difficulty, and above average on environmental attitude.</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combine key measures into correlation matrix</span></span>
<span><span class="va">key_measures</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span></span>
<span>    <span class="co"># Knowledge measures</span></span>
<span>    <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>    <span class="co"># Motivation/attitude measures</span></span>
<span>    <span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span>, <span class="va">pol_conservatism</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute and visualize correlation matrix</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">key_measures</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span><span class="fu">corrplot</span><span class="op">(</span><span class="va">cor_matrix</span>,</span>
<span>         method <span class="op">=</span> <span class="st">"color"</span>,</span>
<span>         type <span class="op">=</span> <span class="st">"upper"</span>,</span>
<span>         addCoef.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>         tl.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>         tl.srt <span class="op">=</span> <span class="fl">45</span>,</span>
<span>         diag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>         col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">200</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Factor Analysis to examine underlying structure</span></span>
<span><span class="va">fa_results</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="va">key_measures</span>, nfactors <span class="op">=</span> <span class="fl">2</span>, rotate <span class="op">=</span> <span class="st">"varimax"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span> <span class="op">(</span><span class="va">fa_results</span>, cut <span class="op">=</span> <span class="fl">0.3</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = key_measures, nfactors = 2, rotate = "varimax")
Standardized loadings (pattern matrix) based upon correlation matrix
                     item   MR1   MR2   h2     u2 com
energy_use              2  0.77       0.61 0.3856 1.1
energy_save             3  0.68       0.49 0.5146 1.1
numeracy                1  0.52       0.29 0.7067 1.2
els_score               4  0.50       0.30 0.6954 1.4
pol_conservatism        7             0.14 0.8570 2.0
env_attitude            5        0.99 1.00 0.0035 1.0
perceived_difficulty    6       -0.36 0.19 0.8120 1.7

                       MR1  MR2
SS loadings           1.72 1.31
Proportion Var        0.25 0.19
Cumulative Var        0.25 0.43
Proportion Explained  0.57 0.43
Cumulative Proportion 0.57 1.00

Mean item complexity =  1.4
Test of the hypothesis that 2 factors are sufficient.

df null model =  21  with the objective function =  1.3 with Chi Square =  760
df of  the model are 8  and the objective function was  0.03 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.04 

The harmonic n.obs is  586 with the empirical chi square  17  with prob &lt;  0.035 
The total n.obs was  586  with Likelihood Chi Square =  17  with prob &lt;  0.029 

Tucker Lewis Index of factoring reliability =  0.97
RMSEA index =  0.044  and the 90 % confidence intervals are  0.014 0.073
BIC =  -34
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   MR1  MR2
Correlation of (regression) scores with factors   0.87 1.00
Multiple R square of scores with factors          0.76 0.99
Minimum correlation of possible factor scores     0.52 0.99</code></pre>
</div>
</div>
</section><section id="canonical-correlation-analysis-cca" class="level2"><h2 class="anchored" data-anchor-id="canonical-correlation-analysis-cca">Canonical Correlation Analysis (CCA)</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Canonical Correlation Analysis between Knowledge and Motivation Sets</span></span>
<span><span class="co"># Prepare matrices</span></span>
<span><span class="va">knowledge_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">motivation_vars</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span>, <span class="va">pol_conservatism</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform CCA</span></span>
<span><span class="va">cc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cancor.html">cancor</a></span><span class="op">(</span><span class="va">knowledge_vars</span>, <span class="va">motivation_vars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Network Analysis to Visualize Variable Relationships</span></span>
<span><span class="co"># Create correlation matrix</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>                    <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>                           <span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span>, <span class="va">pol_conservatism</span><span class="op">)</span>,</span>
<span>                  use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create network plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qgraph/man/qgraph.html">qgraph</a></span><span class="op">(</span><span class="va">cor_matrix</span>,</span>
<span>       layout <span class="op">=</span> <span class="st">"spring"</span>,</span>
<span>       groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Knowledge <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, Motivation <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>,</span>
<span>       color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"lightgreen"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This performs a CCA to explore the relationships between the set of knowledge variables and the set of motivation variables and a network analysis to visualize variable relationships.</p>
<section id="cca-results" class="level3"><h3 class="anchored" data-anchor-id="cca-results">CCA Results</h3>
<p>The CCA identifies canonical variates that maximally correlate the knowledge and motivation sets. The first canonical correlation is 0.418, suggesting a moderate relationship between the two sets of variables.</p>
</section><section id="network-analysis-results" class="level3"><h3 class="anchored" data-anchor-id="network-analysis-results">Network Analysis Results</h3>
<p>The network plot visually represents the correlations between the variables, with node colors indicating whether a variable belongs to the knowledge or motivation set. The plot provides a clear visualization of the relationships between the different constructs.</p>
</section></section><section id="structural-equation-modeling-sem" class="level2"><h2 class="anchored" data-anchor-id="structural-equation-modeling-sem">Structural Equation Modeling (SEM)</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 5. Structural Equation Model for Path Analysis</span></span>
<span><span class="co"># Define model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  # Measurement model</span></span>
<span><span class="st">  knowledge =~ numeracy + energy_use + energy_save +els_score</span></span>
<span><span class="st">  motivation =~ env_attitude + perceived_difficulty + pol_conservatism</span></span>
<span><span class="st"></span></span>
<span><span class="st">  # Structural model</span></span>
<span><span class="st">  knowledge ~ motivation</span></span>
<span><span class="st">  motivation ~ knowledge</span></span>
<span><span class="st">"</span></span>
<span></span>
<span><span class="co"># Fit model</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 33 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        16

  Number of observations                           586

Model Test User Model:
                                                      
  Test statistic                                48.061
  Degrees of freedom                                12
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               765.733
  Degrees of freedom                                21
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.952
  Tucker-Lewis Index (TLI)                       0.915

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -5510.805
  Loglikelihood unrestricted model (H1)      -5486.775
                                                      
  Akaike (AIC)                               11053.610
  Bayesian (BIC)                             11123.583
  Sample-size adjusted Bayesian (SABIC)      11072.789

Root Mean Square Error of Approximation:

  RMSEA                                          0.072
  90 Percent confidence interval - lower         0.051
  90 Percent confidence interval - upper         0.093
  P-value H_0: RMSEA &lt;= 0.050                    0.042
  P-value H_0: RMSEA &gt;= 0.080                    0.279

Standardized Root Mean Square Residual:

  SRMR                                           0.045

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  knowledge =~                                                          
    numeracy          1.000                               0.534    0.534
    energy_use        1.441       NA                      0.769    0.769
    energy_save       1.331       NA                      0.710    0.711
    els_score         1.024       NA                      0.546    0.547
  motivation =~                                                         
    env_attitude      1.000                               0.506    0.657
    percvd_dffclty   -1.068       NA                     -0.540   -0.541
    pol_conservtsm   -1.159       NA                     -0.586   -0.413

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  knowledge ~                                                           
    motivation       -0.777       NA                     -0.736   -0.736
  motivation ~                                                          
    knowledge         0.874       NA                      0.922    0.922

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .numeracy          0.714       NA                      0.714    0.715
   .energy_use        0.408       NA                      0.408    0.408
   .energy_save       0.494       NA                      0.494    0.495
   .els_score         0.700       NA                      0.700    0.701
   .env_attitude      0.337       NA                      0.337    0.569
   .percvd_dffclty    0.706       NA                      0.706    0.708
   .pol_conservtsm    1.668       NA                      1.668    0.829
   .knowledge         0.681       NA                      2.392    2.392
   .motivation        0.201       NA                      0.786    0.786</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tidySEM</span><span class="fu">::</span><span class="fu"><a href="https://cjvanlissa.github.io/tidySEM/reference/graph_sem.html">graph_sem</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">semPlot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html">semPaths</a></span><span class="op">(</span><span class="va">fit</span>,layout<span class="op">=</span><span class="st">"tree2"</span>,residual<span class="op">=</span><span class="cn">TRUE</span>,whatLabels<span class="op">=</span><span class="st">"est"</span>, nCharNodes <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code fits a structural equation model to test a path model where motivation predicts knowledge.</p>
<section id="sem-results" class="level3"><h3 class="anchored" data-anchor-id="sem-results">SEM Results</h3>
<p>The SEM results provide support for the hypothesized model, with a good model fit and a significant path from motivation to knowledge. The standardized path coefficient suggests that a one-unit increase in motivation is associated with a 0.577-unit increase in knowledge.</p>
</section></section><section id="classification-tree" class="level2"><h2 class="anchored" data-anchor-id="classification-tree">Classification Tree</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 6. Classification Tree for Predicting Knowledge Levels - rpart functions</span></span>
<span><span class="co"># Create binary knowledge indicator (high/low) based on median split</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">knowledge_level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">$</span><span class="va">composite_knowledge</span> <span class="op">&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">combined_scores</span><span class="op">$</span><span class="va">composite_knowledge</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span><span class="st">"High"</span>, <span class="st">"Low"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit tree</span></span>
<span><span class="va">tree_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">knowledge_level</span> <span class="op">~</span> <span class="va">env_attitude</span> <span class="op">+</span> <span class="va">perceived_difficulty</span> <span class="op">+</span></span>
<span>  <span class="va">pol_conservatism</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot tree</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/rpart.plot/man/rpart.plot.html">rpart.plot</a></span><span class="op">(</span><span class="va">tree_model</span>, extra <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code creates a classification tree to predict whether a participant has high or low knowledge based on their environmental attitude, perceived difficulty, and political conservatism.</p>
<section id="classification-tree-results" class="level3"><h3 class="anchored" data-anchor-id="classification-tree-results">Classification Tree Results</h3>
<p>The classification tree provides a set of rules for classifying participants into high or low knowledge groups based on their scores on the predictor variables. For instance, participants with a <code>pol_conservatism</code> score less than 1.8 are classified as ‘High’ knowledge, while those with <code>pol_conservatism</code> greater than 1.8 and <code>perceived_difficulty</code> less than 0.56 are classified as ‘Low’ knowledge.</p>
</section></section><section id="latent-profile-analysis-lpa" class="level2"><h2 class="anchored" data-anchor-id="latent-profile-analysis-lpa">Latent Profile Analysis (LPA)</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example LPA (using tidyLPA)</span></span>
<span><span class="va">lpa_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>, <span class="va">env_attitude_z</span>, <span class="va">perceived_difficulty</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># convert all to numeric</span></span>
<span>  <span class="fu">mutate_all</span><span class="op">(</span><span class="va">as.numeric</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lpa_results</span> <span class="op">&lt;-</span> <span class="va">lpa_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://data-edu.github.io/tidyLPA/reference/estimate_profiles.html">estimate_profiles</a></span><span class="op">(</span>n_profiles <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># Estimate models with 1-5 profiles</span></span>
<span>  <span class="fu"><a href="https://data-edu.github.io/tidyLPA/reference/compare_solutions.html">compare_solutions</a></span><span class="op">(</span>statistics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lpa_results</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code performs a latent profile analysis (LPA) to identify distinct subgroups of participants based on their patterns of responses across the knowledge and motivation variables.</p>
<section id="lpa-results" class="level3"><h3 class="anchored" data-anchor-id="lpa-results">LPA Results</h3>
<p>The BIC suggests that a model with 8 profiles fits the data best. The plot shows the BIC values for models with 1 to 5 profiles.</p>
</section></section><section id="factor-analysis-with-combined-variables" class="level2"><h2 class="anchored" data-anchor-id="factor-analysis-with-combined-variables">Factor Analysis with Combined Variables</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combine all items into a single dataframe</span></span>
<span><span class="va">all_items</span> <span class="op">&lt;-</span> <span class="fu">full_join</span><span class="op">(</span><span class="va">aes_combined</span>, <span class="va">att2_combined</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">els</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">full_join</span><span class="op">(</span><span class="va">rs</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select only item columns for factor analysis</span></span>
<span><span class="va">item_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">all_items</span><span class="op">)</span>, <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="va">item_data</span> <span class="op">&lt;-</span> <span class="va">all_items</span><span class="op">[</span>, <span class="va">item_columns</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Perform factor analysis</span></span>
<span><span class="va">fa_items</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="va">item_data</span>, nfactors <span class="op">=</span> <span class="fl">5</span>, rotate <span class="op">=</span> <span class="st">"varimax"</span><span class="op">)</span> <span class="co"># Adjust nfactors as needed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fa_items</span>, cut <span class="op">=</span> <span class="fl">0.3</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = item_data, nfactors = 5, rotate = "varimax")
Standardized loadings (pattern matrix) based upon correlation matrix
      item   MR1   MR2   MR5   MR3   MR4    h2    u2 com
ATT25   25  0.94                         0.903 0.097 1.0
ATT23   23  0.90                         0.865 0.135 1.1
ATT27   27  0.89                         0.804 0.196 1.0
ATT26   26  0.89                         0.810 0.190 1.0
ATT24   24  0.82                         0.767 0.233 1.3
ATT33   33  0.70                         0.622 0.378 1.5
ATT32   32  0.61                         0.424 0.576 1.3
ATT30   30  0.56        0.40             0.572 0.428 2.6
ATT31   31  0.42                         0.258 0.742 1.9
ELS08   41                               0.026 0.974 3.2
ATT10   10        0.63                   0.455 0.545 1.3
ATT15   15        0.63       -0.37       0.537 0.463 1.7
ATT09    9        0.62                   0.456 0.544 1.3
ATT14   14        0.62       -0.34       0.516 0.484 1.6
ATT06    6        0.61                   0.401 0.599 1.2
ATT07    7        0.56                   0.337 0.663 1.1
ATT08    8        0.55                   0.313 0.687 1.0
ATT13   13        0.54                   0.317 0.683 1.2
ATT03    3        0.49        0.36       0.367 0.633 1.9
ATT12   12        0.48                   0.256 0.744 1.2
ATT05    5        0.48        0.37       0.362 0.638 1.9
ATT04    4        0.47                   0.235 0.765 1.1
ATT01    1        0.42        0.31       0.275 0.725 1.9
RS01    42       -0.40                   0.248 0.752 2.0
RS02    43                               0.083 0.917 1.2
ATT11   11                               0.070 0.930 1.5
ELS01   34                               0.037 0.963 2.8
ATT20   20              0.92             0.915 0.085 1.2
ATT21   21  0.35        0.79             0.759 0.241 1.4
ATT22   22              0.73             0.610 0.390 1.3
RS03    44       -0.37        0.59       0.503 0.497 1.8
RS04    45                    0.46       0.256 0.744 1.5
RS05    46                    0.44       0.212 0.788 1.2
RS06    47                    0.38       0.158 0.842 1.2
ATT17   17                   -0.36       0.166 0.834 1.5
ELS02   35                    0.34       0.132 0.868 1.2
ATT18   18                               0.139 0.861 2.6
ELS03   36                               0.073 0.927 1.4
ATT02    2                               0.111 0.889 2.2
ELS04   37                               0.038 0.962 1.3
ELS07   40                               0.039 0.961 1.9
ATT19   19                               0.028 0.972 1.1
ELS05   38                               0.022 0.978 1.4
ATT28   28                          0.94 0.888 0.112 1.0
ATT29   29                          0.90 0.827 0.173 1.0
ATT16   16                               0.024 0.976 1.1
ELS06   39                               0.027 0.973 4.0

                       MR1  MR2  MR5  MR3  MR4
SS loadings           5.69 4.67 2.52 2.38 1.98
Proportion Var        0.12 0.10 0.05 0.05 0.04
Cumulative Var        0.12 0.22 0.27 0.32 0.37
Proportion Explained  0.33 0.27 0.15 0.14 0.11
Cumulative Proportion 0.33 0.60 0.75 0.89 1.00

Mean item complexity =  1.6
Test of the hypothesis that 5 factors are sufficient.

df null model =  1081  with the objective function =  27 with Chi Square =  15130
df of  the model are 856  and the objective function was  8.8 

The root mean square of the residuals (RMSR) is  0.05 
The df corrected root mean square of the residuals is  0.06 

The harmonic n.obs is  586 with the empirical chi square  3813  with prob &lt;  0 
The total n.obs was  586  with Likelihood Chi Square =  4950  with prob &lt;  0 

Tucker Lewis Index of factoring reliability =  0.63
RMSEA index =  0.09  and the 90 % confidence intervals are  0.088 0.093
BIC =  -506
Fit based upon off diagonal values = 0.91
Measures of factor score adequacy             
                                                   MR1  MR2  MR5  MR3  MR4
Correlation of (regression) scores with factors   0.98 0.93 0.97 0.87 0.97
Multiple R square of scores with factors          0.97 0.87 0.94 0.76 0.93
Minimum correlation of possible factor scores     0.94 0.75 0.88 0.52 0.87</code></pre>
</div>
</div>
<p>This performs a factor analysis on all individual survey items to explore the underlying structure of the data.</p>
<section id="factor-analysis-results-1" class="level3"><h3 class="anchored" data-anchor-id="factor-analysis-results-1">Factor Analysis Results</h3>
<p>The factor analysis suggests a five-factor solution. The items load onto the factors in a way that is generally consistent with the hypothesized constructs, although there are some cross-loadings.</p>
</section></section><section id="knowledge-motivation-relationship-analyses" class="level2"><h2 class="anchored" data-anchor-id="knowledge-motivation-relationship-analyses">Knowledge-Motivation Relationship Analyses</h2>
<section id="bivariate-correlation" class="level3"><h3 class="anchored" data-anchor-id="bivariate-correlation">Bivariate Correlation</h3>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create composite scores for knowledge and motivation</span></span>
<span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">.</span>, <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">.</span>, <span class="va">env_attitude</span>, <span class="op">-</span><span class="va">perceived_difficulty</span>, <span class="op">-</span><span class="va">pol_conservatism</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># 3a. Bivariate Correlation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">combined_scores</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">knowledge</span>, <span class="va">motivation</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  knowledge and motivation
t = 8, df = 584, p-value = 0.00000000000004
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.23 0.38
sample estimates:
 cor 
0.31 </code></pre>
</div>
</div>
<p>This code calculates the bivariate correlation between the composite knowledge and motivation scores.</p>
<section id="bivariate-correlation-results" class="level4"><h4 class="anchored" data-anchor-id="bivariate-correlation-results">Bivariate Correlation Results</h4>
<p>The correlation between knowledge and motivation is -0.018, which is not statistically significant (p = 0.7). This suggests a very weak, negative linear relationship between overall knowledge and motivation in this sample.</p>
</section></section><section id="hierarchical-regression" class="level3"><h3 class="anchored" data-anchor-id="hierarchical-regression">Hierarchical Regression</h3>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3b. Hierarchical Regression</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">knowledge</span> <span class="op">~</span> <span class="va">motivation</span> <span class="op">+</span> <span class="va">pol_conservatism_z</span> <span class="op">+</span> <span class="va">cluster</span>,</span>
<span>  data <span class="op">=</span> <span class="va">combined_scores</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = knowledge ~ motivation + pol_conservatism_z + cluster, 
    data = combined_scores)

Residuals:
   Min     1Q Median     3Q    Max 
-1.656 -0.358 -0.020  0.326  1.717 

Coefficients:
                   Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)         -0.6120     0.1046   -5.85         0.0000000081 ***
motivation          -0.0643     0.0315   -2.04                0.042 *  
pol_conservatism_z   0.0221     0.0344    0.64                0.521    
cluster2             1.0162     0.0583   17.42 &lt; 0.0000000000000002 ***
cluster3             1.3625     0.0750   18.16 &lt; 0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.51 on 581 degrees of freedom
Multiple R-squared:  0.537, Adjusted R-squared:  0.533 
F-statistic:  168 on 4 and 581 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
</div>
<p>This code performs a hierarchical regression analysis to examine the relationship between knowledge and motivation, controlling for political conservatism and cluster membership.</p>
<section id="hierarchical-regression-results" class="level4"><h4 class="anchored" data-anchor-id="hierarchical-regression-results">Hierarchical Regression Results</h4>
<p>The regression results show that:</p>
<ul>
<li>Motivation is not a significant predictor of knowledge when controlling for political conservatism and cluster membership.</li>
<li>Political conservatism is not a significant predictor of knowledge.</li>
<li>Cluster membership is a significant predictor of knowledge, with Clusters 2 and 3 having significantly higher knowledge scores than Cluster 1.</li>
</ul></section></section><section id="path-analysis" class="level3"><h3 class="anchored" data-anchor-id="path-analysis">Path Analysis</h3>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3c. Path Analysis</span></span>
<span><span class="va">path_model</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  motivation ~ a * knowledge</span></span>
<span><span class="st">  els_score ~ b * motivation + c * knowledge</span></span>
<span><span class="st">  indirect := a * b</span></span>
<span><span class="st">  total := c + indirect</span></span>
<span><span class="st">"</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">path_model</span>, data <span class="op">=</span> <span class="va">combined_scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                           586

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  motivation ~                                                          
    knowledge  (a)    0.316    0.041    7.755    0.000    0.316    0.305
  els_score ~                                                           
    motivation (b)    0.082    0.040    2.066    0.039    0.082    0.063
    knowledge  (c)    0.923    0.041   22.434    0.000    0.923    0.687

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .motivation        0.538    0.031   17.117    0.000    0.538    0.907
   .els_score         0.497    0.029   17.117    0.000    0.497    0.498

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    indirect          0.026    0.013    1.996    0.046    0.026    0.019
    total             0.949    0.039   24.132    0.000    0.949    0.706</code></pre>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tidySEM</span><span class="fu">::</span><span class="fu"><a href="https://cjvanlissa.github.io/tidySEM/reference/graph_sem.html">graph_sem</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">semPlot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html">semPaths</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-30-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code fits a path model to test the indirect effect of knowledge on ELS through motivation.</p>
<section id="path-analysis-results" class="level4"><h4 class="anchored" data-anchor-id="path-analysis-results">Path Analysis Results</h4>
<p>The path analysis results show that:</p>
<ul>
<li>The direct effect of knowledge on ELS is significant and positive (c = 0.707).</li>
<li>The direct effect of motivation on ELS is not significant (b = 0.036).</li>
<li>The indirect effect of knowledge on ELS through motivation is not significant (a*b = -0.001).</li>
</ul></section></section><section id="cluster-validation-by-motivation-knowledge-profiles" class="level3"><h3 class="anchored" data-anchor-id="cluster-validation-by-motivation-knowledge-profiles">Cluster Validation by Motivation-Knowledge Profiles</h3>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 4. Cluster Validation by Motivation-Knowledge Profiles</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">combined_scores</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">knowledge</span>, y <span class="op">=</span> <span class="va">motivation</span>, color <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ellipse.html">stat_ellipse</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Knowledge-Motivation Profiles by Cluster"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Standardized Knowledge Composite"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Standardized Motivation Composite"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code visualizes the knowledge-motivation profiles for each cluster using a scatter plot with ellipses representing the 95% confidence regions for each cluster.</p>
<section id="cluster-validation-results" class="level4"><h4 class="anchored" data-anchor-id="cluster-validation-results">Cluster Validation Results</h4>
<p>The plot shows distinct knowledge-motivation profiles for each cluster:</p>
<ul>
<li>
<strong>Cluster 1:</strong> Low knowledge, high motivation.</li>
<li>
<strong>Cluster 2:</strong> High knowledge, high motivation.</li>
<li>
<strong>Cluster 3:</strong> Average knowledge, average motivation.</li>
</ul></section></section></section><section id="correlation-and-factor-analysis-of-key-measures" class="level2"><h2 class="anchored" data-anchor-id="correlation-and-factor-analysis-of-key-measures">Correlation and Factor Analysis of Key Measures</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combine key measures into correlation matrix</span></span>
<span><span class="va">key_measures</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span></span>
<span>    <span class="co"># Knowledge measures</span></span>
<span>    <span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span>,</span>
<span>    <span class="co"># Motivation/attitude measures</span></span>
<span>    <span class="va">env_attitude</span>, <span class="va">perceived_difficulty</span>, <span class="va">pol_conservatism</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute and visualize correlation matrix</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">key_measures</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span><span class="fu">corrplot</span><span class="op">(</span><span class="va">cor_matrix</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"upper"</span>,</span>
<span>  addCoef.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  tl.col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  tl.srt <span class="op">=</span> <span class="fl">45</span>,</span>
<span>  diag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">200</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code computes and visualizes the correlation matrix for the key knowledge and motivation measures.</p>
<section id="correlation-matrix-visualization" class="level3"><h3 class="anchored" data-anchor-id="correlation-matrix-visualization">Correlation Matrix Visualization</h3>
<p>The correlation plot shows the relationships between the key measures, with positive correlations in blue and negative correlations in red. The strength of the correlation is indicated by the intensity of the color and the size of the coefficient.</p>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Factor Analysis to examine underlying structure</span></span>
<span><span class="va">fa_results</span> <span class="op">&lt;-</span> <span class="fu">fa</span><span class="op">(</span><span class="va">key_measures</span>, nfactors <span class="op">=</span> <span class="fl">2</span>, rotate <span class="op">=</span> <span class="st">"varimax"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fa_results</span>, cut <span class="op">=</span> <span class="fl">0.3</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = key_measures, nfactors = 2, rotate = "varimax")
Standardized loadings (pattern matrix) based upon correlation matrix
                     item   MR1   MR2   h2     u2 com
energy_use              2  0.77       0.61 0.3856 1.1
energy_save             3  0.68       0.49 0.5146 1.1
numeracy                1  0.52       0.29 0.7067 1.2
els_score               4  0.50       0.30 0.6954 1.4
pol_conservatism        7             0.14 0.8570 2.0
env_attitude            5        0.99 1.00 0.0035 1.0
perceived_difficulty    6       -0.36 0.19 0.8120 1.7

                       MR1  MR2
SS loadings           1.72 1.31
Proportion Var        0.25 0.19
Cumulative Var        0.25 0.43
Proportion Explained  0.57 0.43
Cumulative Proportion 0.57 1.00

Mean item complexity =  1.4
Test of the hypothesis that 2 factors are sufficient.

df null model =  21  with the objective function =  1.3 with Chi Square =  760
df of  the model are 8  and the objective function was  0.03 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.04 

The harmonic n.obs is  586 with the empirical chi square  17  with prob &lt;  0.035 
The total n.obs was  586  with Likelihood Chi Square =  17  with prob &lt;  0.029 

Tucker Lewis Index of factoring reliability =  0.97
RMSEA index =  0.044  and the 90 % confidence intervals are  0.014 0.073
BIC =  -34
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   MR1  MR2
Correlation of (regression) scores with factors   0.87 1.00
Multiple R square of scores with factors          0.76 0.99
Minimum correlation of possible factor scores     0.52 0.99</code></pre>
</div>
</div>
<p>This code performs a factor analysis on the key measures to examine the underlying structure.</p>
</section><section id="factor-analysis-results-2" class="level3"><h3 class="anchored" data-anchor-id="factor-analysis-results-2">Factor Analysis Results</h3>
<p>The factor analysis suggests a two-factor solution, with the knowledge measures loading on one factor and the motivation/attitude measures loading on the other factor. The perceived difficulty item loads negatively on the knowledge factor.</p>
<div style="page-break-after: always;"></div>
</section></section><section id="composite-scores-and-relationships" class="level2"><h2 class="anchored" data-anchor-id="composite-scores-and-relationships">Composite Scores and Relationships</h2>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create composite scores for knowledge and motivation</span></span>
<span><span class="va">combined_scores</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    knowledge_composite <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">numeracy</span>, <span class="va">energy_use</span>, <span class="va">energy_save</span>, <span class="va">els_score</span><span class="op">)</span>,</span>
<span>      na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    motivation_composite <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">env_attitude</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">perceived_difficulty</span><span class="op">)</span>,</span>
<span>      na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">cluster_data</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">knowledge_composite</span>, <span class="va">motivation_composite</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Determine the optimal number of clusters using the Elbow Method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span><span class="va">cluster_data</span>, <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"wss"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Elbow Method for Determining Optimal Number of Clusters"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Decide the number of clusters (k). Let's try k = 3 for illustration:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">km_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co"># Visualize clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_fit</span>, data <span class="op">=</span> <span class="va">cluster_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means Clustering on Knowledge vs. Motivation - 3 clusters"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Decide the number of clusters (k). Let's try k =4 for illustration:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">km_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">cluster_data</span>, centers <span class="op">=</span> <span class="fl">4</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co"># Visualize clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cluster.html">fviz_cluster</a></span><span class="op">(</span><span class="va">km_fit</span>, data <span class="op">=</span> <span class="va">cluster_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means Clustering on Knowledge vs. Motivation -4 clusters"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-34-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code creates composite scores for knowledge and motivation and then uses cluster analysis to identify distinct profiles based on these composite scores.</p>
<section id="cluster-analysis-results" class="level3"><h3 class="anchored" data-anchor-id="cluster-analysis-results">Cluster Analysis Results</h3>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Add cluster membership back to your main dataframe</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">km_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">km_fit</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare mean knowledge &amp; motivation by cluster</span></span>
<span><span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">km_cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean_knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">knowledge_composite</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">motivation_composite</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  km_cluster mean_knowledge mean_motivation     n
  &lt;fct&gt;               &lt;dbl&gt;           &lt;dbl&gt; &lt;int&gt;
1 1                  -0.978           0.925   109
2 2                   0.463           1.24    125
3 3                  -0.265           2.05    203
4 4                   0.688           2.54    149</code></pre>
</div>
</div>
</section></section></section><section id="cluster-profiles" class="level1"><h1>Cluster Profiles</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Add cluster membership to dataframe</span></span>
<span><span class="va">combined_scores</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">km_fit</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize cluster profiles</span></span>
<span><span class="va">cluster_profiles</span> <span class="op">&lt;-</span> <span class="va">combined_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    mean_knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">knowledge_composite</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_knowledge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">knowledge_composite</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">motivation_composite</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_motivation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">motivation_composite</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cluster_profiles</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  cluster     n mean_knowledge sd_knowledge mean_motivation sd_motivation
  &lt;fct&gt;   &lt;int&gt;          &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;
1 1         109         -0.978        0.501           0.925         0.486
2 2         125          0.463        0.449           1.24          0.400
3 3         203         -0.265        0.340           2.05          0.384
4 4         149          0.688        0.471           2.54          0.429</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</section><section id="clustering-on-question-level-data" class="level1"><h1>Clustering on question-level data</h1>
<div class="cell">
<details class="code-fold"><summary>Display code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># combine question level data (aes_combined, att2_combined, els, rs,) by id</span></span>
<span></span>
<span><span class="va">dq</span> <span class="op">&lt;-</span> <span class="va">aes_combined</span> <span class="op">|&gt;</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">att2_combined</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">els</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">rs</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># Custom function for correlation matrix plots of question-level data</span></span>
<span><span class="va">plot_cor_matrix_items</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">title</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>  <span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">data</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Identify item types based on column names</span></span>
<span>  <span class="va">item_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span></span>
<span>  <span class="va">is_attari_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"^ATT0[1-9]$|^ATT1[0-5]$"</span>, <span class="va">item_names</span><span class="op">)</span> <span class="co"># ATT01-ATT15</span></span>
<span>  <span class="va">is_attari_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"^ATT1[6-8]$"</span>, <span class="va">item_names</span><span class="op">)</span>  <span class="co"># ATT16-ATT18</span></span>
<span>  <span class="va">is_attari_energy_use</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"^ATT(19|2[0-7])$"</span>, <span class="va">item_names</span><span class="op">)</span> <span class="co"># ATT19-ATT27</span></span>
<span>  <span class="va">is_attari_energy_save</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"^ATT(2[8-9]|3[0-3])$"</span>, <span class="va">item_names</span><span class="op">)</span>  <span class="co"># ATT28-ATT33</span></span>
<span>  <span class="va">is_els</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"^ELS0[1-8]$"</span>, <span class="va">item_names</span><span class="op">)</span> <span class="co"># ELS01-ELS08</span></span>
<span>  <span class="va">is_rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"^RS0[1-6]$"</span>, <span class="va">item_names</span><span class="op">)</span> <span class="co"># RS01-RS06</span></span>
<span>  </span>
<span>  <span class="va">item_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_attari_diff</span>, <span class="st">"Attari Difficulty"</span>,</span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_attari_num</span>, <span class="st">"Attari Numeracy"</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_attari_energy_use</span>, <span class="st">"Attari Usage"</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_attari_energy_save</span>, <span class="st">"Attari Savings"</span>,</span>
<span>                                            <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_els</span>, <span class="st">"Energy Literacy"</span>,</span>
<span>                                                   <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_rs</span>, <span class="st">"Recycling Study"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/qgraph/man/qgraph.html">qgraph</a></span><span class="op">(</span><span class="va">cor_matrix</span>,</span>
<span>         layout <span class="op">=</span> <span class="st">"spring"</span>,</span>
<span>         groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Attari Difficulty"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">item_groups</span> <span class="op">==</span> <span class="st">"Attari Difficulty"</span><span class="op">)</span>,</span>
<span>                       <span class="st">"Attari Numeracy"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">item_groups</span> <span class="op">==</span> <span class="st">"Attari Numeracy"</span><span class="op">)</span>,</span>
<span>                       <span class="st">"Attari Usage"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">item_groups</span> <span class="op">==</span> <span class="st">"Attari Usage"</span><span class="op">)</span>,</span>
<span>                       <span class="st">"Attari Savings"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">item_groups</span> <span class="op">==</span> <span class="st">"Attari Savings"</span><span class="op">)</span>,</span>
<span>                       <span class="st">"Energy Literacy"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">item_groups</span> <span class="op">==</span> <span class="st">"Energy Literacy"</span><span class="op">)</span>,</span>
<span>                       <span class="st">"Recycling Study"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">item_groups</span> <span class="op">==</span> <span class="st">"Recycling Study"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"skyblue"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">is_attari_diff</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"lightcoral"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">is_attari_num</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"lightgreen"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">is_attari_energy_use</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"lightyellow"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">is_attari_energy_save</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"lightpink"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">is_els</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"lightcyan"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">is_rs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         title <span class="op">=</span> <span class="va">title</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">plot_cor_matrix_items</span><span class="op">(</span><span class="va">dq</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">id</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="cors_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/tegorman13\.github\.io\/Survey_Study\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="./inst.html" class="pagination-link" aria-label="Survey Items">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Survey Items</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./cors1.html" class="pagination-link" aria-label="Instrument Correlations_1">
        <span class="nav-page-text">Instrument Correlations_1</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb65" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Knowledge &amp; Motivation Instrument Correlations"</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co">    grid:</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="co">      sidebar-width: 220px</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="co">      body-width: 1200px</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="co">      margin-width: 170px</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co">      gutter-width: 1.0rem</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="co">  hugo-md:</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="co">    include: true</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="co">    html-math-method: mathjax</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="co">    output-file: cor_hugo.md</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf: </span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a><span class="co">    documentclass: article</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a><span class="co">    papersize: letter</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: false</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a><span class="co">    fontsize: 10pt</span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a><span class="co">    linestretch: 1.5</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="co">    geometry:</span></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a><span class="co">      - top=.5in     </span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a><span class="co">      - bottom=.5in  </span></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a><span class="co">      - left=.5in    </span></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a><span class="co">      - right=.25in  </span></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a><span class="co">      - heightrounded</span></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a><span class="fu"># Knowledge &amp; Motivation Instrument Correlations</span></span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>This notebook explores data from a multi-survey study investigating the relationships between sustainable behaviors, knowledge, and attitudes. The study involved participants completing five different surveys, each designed to measure different aspects of these constructs. This analysis focuses on understanding these relationships, with a particular emphasis on the connection between knowledge and motivation.</span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data and Survey Instruments</span></span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>The dataset combines responses from five different surveys into a single data frame, structured such that each row represents a participant, and each column represents a response, or a derived score. The five underlying surveys are:</span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Energy Literacy Survey (ELS01-ELS08):**  Assesses participants' knowledge of energy concepts through multiple-choice questions. </span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Attari Energy Survey - Part 1:**</span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a><span class="ss">    *   </span>**Perceived Difficulty Items (ATT01-ATT15):** Measures how easy or hard participants would find it to adopt energy-saving behaviors, using a rating scale.</span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a><span class="ss">    *   </span>**Numeracy Questions (ATT16-ATT18):** Assesses numerical literacy through probability questions requiring numeric answers.</span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Attari Energy Survey - Part 2:**</span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a><span class="ss">    *   </span>**Relative Energy Usage (ATT19-ATT27):**  Asks participants to estimate the relative energy usage of various devices compared to a 100-Watt bulb, using a numeric response format.</span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a><span class="ss">    *   </span>**Relative Energy Savings (ATT28-ATT33):** Asks participants to estimate the relative energy savings of various actions compared to turning off a 100-Watt bulb, using a numeric response format.</span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Recycling Study Questions (RS01-RS06):** Assesses participants’ attitudes towards the environment and politics.</span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exploratory Analysis of Multi-Survey Study on Sustainable Behaviors</span></span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a>This notebook presents an exploratory analysis of response data from a multi-survey study focused on understanding the relationships between sustainable behaviors, knowledge, and attitudes. The study involved participants completing five different surveys, each designed to measure different aspects of these constructs. This analysis aims to examine the relationships between the different survey instruments, with a particular focus on the connection between knowledge and motivation.</span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Loading and Preparation</span></span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a>This code block loads the required R libraries for data analysis and visualization. It then reads the survey response data from two RDS files, <span class="in">`draw.rds`</span> and <span class="in">`dinst.rds`</span>, which presumably contain responses from different groups or conditions. Finally, it combines subsets of the data corresponding to different surveys (Attari Energy Survey Part 1 and Part 2, Energy Literacy Survey, and Recycling Study) into separate data frames.</span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-65"><a href="#cb65-65" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-66"><a href="#cb65-66" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr,purrr,tidyr,here, haven,tibble,ggplot2,ggh4x,lme4,knitr,kableExtra,gt,pander,flextable,ggh4x,psych,corrplot,factoextra)</span>
<span id="cb65-67"><a href="#cb65-67" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">2</span>, <span class="at">scipen=</span><span class="dv">999</span>, <span class="at">dplyr.summarise.inform=</span><span class="cn">FALSE</span>)</span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-69"><a href="#cb65-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb65-70"><a href="#cb65-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb65-71"><a href="#cb65-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb65-72"><a href="#cb65-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb65-73"><a href="#cb65-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CCA)</span>
<span id="cb65-74"><a href="#cb65-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qgraph)</span>
<span id="cb65-75"><a href="#cb65-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb65-76"><a href="#cb65-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb65-77"><a href="#cb65-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclust)</span>
<span id="cb65-78"><a href="#cb65-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyLPA)</span>
<span id="cb65-79"><a href="#cb65-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-80"><a href="#cb65-80" aria-hidden="true" tabindex="-1"></a>select <span class="ot">=</span> dplyr<span class="sc">::</span>select</span>
<span id="cb65-81"><a href="#cb65-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-82"><a href="#cb65-82" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>,<span class="st">"survey_functions.R"</span>))</span>
<span id="cb65-83"><a href="#cb65-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-84"><a href="#cb65-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data from RDS files</span></span>
<span id="cb65-85"><a href="#cb65-85" aria-hidden="true" tabindex="-1"></a>draw <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"draw.rds"</span>))</span>
<span id="cb65-86"><a href="#cb65-86" aria-hidden="true" tabindex="-1"></a>dinst <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"dinst.rds"</span>))</span>
<span id="cb65-87"><a href="#cb65-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-88"><a href="#cb65-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine data from different sources</span></span>
<span id="cb65-89"><a href="#cb65-89" aria-hidden="true" tabindex="-1"></a>aes1 <span class="ot">&lt;-</span> draw <span class="sc">|&gt;</span> <span class="fu">select</span>(id, ATT01<span class="sc">:</span>ATT18)</span>
<span id="cb65-90"><a href="#cb65-90" aria-hidden="true" tabindex="-1"></a>aes2 <span class="ot">&lt;-</span> dinst <span class="sc">|&gt;</span> <span class="fu">select</span>(id, ATT01<span class="sc">:</span>ATT18)</span>
<span id="cb65-91"><a href="#cb65-91" aria-hidden="true" tabindex="-1"></a>aes_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(aes1, aes2)</span>
<span id="cb65-92"><a href="#cb65-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-93"><a href="#cb65-93" aria-hidden="true" tabindex="-1"></a>att_useSave <span class="ot">&lt;-</span> draw <span class="sc">|&gt;</span> <span class="fu">select</span>(id, ATT19<span class="sc">:</span>ATT33)</span>
<span id="cb65-94"><a href="#cb65-94" aria-hidden="true" tabindex="-1"></a>att_useSave2 <span class="ot">&lt;-</span> dinst <span class="sc">|&gt;</span> <span class="fu">select</span>(id, ATT19<span class="sc">:</span>ATT33)</span>
<span id="cb65-95"><a href="#cb65-95" aria-hidden="true" tabindex="-1"></a>att2_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(att_useSave, att_useSave2)</span>
<span id="cb65-96"><a href="#cb65-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-97"><a href="#cb65-97" aria-hidden="true" tabindex="-1"></a>els1 <span class="ot">&lt;-</span> draw <span class="sc">|&gt;</span> <span class="fu">select</span>(id, ELS01<span class="sc">:</span>ELS08)</span>
<span id="cb65-98"><a href="#cb65-98" aria-hidden="true" tabindex="-1"></a>els2 <span class="ot">&lt;-</span> dinst <span class="sc">|&gt;</span> <span class="fu">select</span>(id, ELS01<span class="sc">:</span>ELS08)</span>
<span id="cb65-99"><a href="#cb65-99" aria-hidden="true" tabindex="-1"></a>els <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(els1, els2)</span>
<span id="cb65-100"><a href="#cb65-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-101"><a href="#cb65-101" aria-hidden="true" tabindex="-1"></a>rs1 <span class="ot">&lt;-</span> draw <span class="sc">|&gt;</span> <span class="fu">select</span>(id, RS01<span class="sc">:</span>RS06)</span>
<span id="cb65-102"><a href="#cb65-102" aria-hidden="true" tabindex="-1"></a>rs2 <span class="ot">&lt;-</span> dinst <span class="sc">|&gt;</span> <span class="fu">select</span>(id, RS01<span class="sc">:</span>RS06)</span>
<span id="cb65-103"><a href="#cb65-103" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(rs1, rs2)</span>
<span id="cb65-104"><a href="#cb65-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-105"><a href="#cb65-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-106"><a href="#cb65-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-107"><a href="#cb65-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-108"><a href="#cb65-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-109"><a href="#cb65-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-110"><a href="#cb65-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-111"><a href="#cb65-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-112"><a href="#cb65-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-113"><a href="#cb65-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-114"><a href="#cb65-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-115"><a href="#cb65-115" aria-hidden="true" tabindex="-1"></a>This code block processes the raw survey responses to generate meaningful scores for each participant. It utilizes custom functions (<span class="in">`analyze_attari_survey_part1`</span>, <span class="in">`analyze_attari_survey`</span>, <span class="in">`analyze_els_survey`</span>, <span class="in">`analyze_recycling_survey`</span>) to calculate scores based on the specific coding schemes of each survey. These individual scores are then combined into a single data frame <span class="in">`combined_scores`</span>, where each row represents a participant and each column represents a score from one of the surveys. Finally, the columns are renamed for better readability.</span>
<span id="cb65-116"><a href="#cb65-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-117"><a href="#cb65-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-118"><a href="#cb65-118" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Summarization and Scoring</span></span>
<span id="cb65-119"><a href="#cb65-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-122"><a href="#cb65-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-123"><a href="#cb65-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze and score each survey</span></span>
<span id="cb65-124"><a href="#cb65-124" aria-hidden="true" tabindex="-1"></a>attari1 <span class="ot">&lt;-</span> <span class="fu">analyze_attari_survey_part1</span>(aes_combined)</span>
<span id="cb65-125"><a href="#cb65-125" aria-hidden="true" tabindex="-1"></a>attari2_scores <span class="ot">&lt;-</span> <span class="fu">analyze_attari_survey</span>(att2_combined)</span>
<span id="cb65-126"><a href="#cb65-126" aria-hidden="true" tabindex="-1"></a>els_scores <span class="ot">&lt;-</span> <span class="fu">analyze_els_survey</span>(els)</span>
<span id="cb65-127"><a href="#cb65-127" aria-hidden="true" tabindex="-1"></a>rs_scores <span class="ot">&lt;-</span> <span class="fu">analyze_recycling_survey</span>(rs)</span>
<span id="cb65-128"><a href="#cb65-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-129"><a href="#cb65-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all scores into one dataframe</span></span>
<span id="cb65-130"><a href="#cb65-130" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> attari1 <span class="sc">%&gt;%</span></span>
<span id="cb65-131"><a href="#cb65-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(attari2_scores, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-132"><a href="#cb65-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(els_scores, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-133"><a href="#cb65-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(rs_scores, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb65-134"><a href="#cb65-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-135"><a href="#cb65-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for clarity</span></span>
<span id="cb65-136"><a href="#cb65-136" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(combined_scores) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb65-137"><a href="#cb65-137" aria-hidden="true" tabindex="-1"></a>  <span class="st">"id"</span>, <span class="st">"perceived_difficulty"</span>, <span class="st">"numeracy"</span>,</span>
<span id="cb65-138"><a href="#cb65-138" aria-hidden="true" tabindex="-1"></a>  <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>,</span>
<span id="cb65-139"><a href="#cb65-139" aria-hidden="true" tabindex="-1"></a>  <span class="st">"els_accuracy"</span>, <span class="st">"els_score"</span>,</span>
<span id="cb65-140"><a href="#cb65-140" aria-hidden="true" tabindex="-1"></a>  <span class="st">"env_attitude"</span>, <span class="st">"env_attitude_z"</span>,</span>
<span id="cb65-141"><a href="#cb65-141" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pol_conservatism"</span>, <span class="st">"pol_conservatism_z"</span></span>
<span id="cb65-142"><a href="#cb65-142" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-143"><a href="#cb65-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-144"><a href="#cb65-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-145"><a href="#cb65-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-146"><a href="#cb65-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-147"><a href="#cb65-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-148"><a href="#cb65-148" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preliminary Data Exploration</span></span>
<span id="cb65-149"><a href="#cb65-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-152"><a href="#cb65-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-153"><a href="#cb65-153" aria-hidden="true" tabindex="-1"></a><span class="co"># Preview the combined scores data</span></span>
<span id="cb65-154"><a href="#cb65-154" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>() <span class="sc">|&gt;</span> <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, <span class="at">full_width =</span> F)</span>
<span id="cb65-155"><a href="#cb65-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-156"><a href="#cb65-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-157"><a href="#cb65-157" aria-hidden="true" tabindex="-1"></a>This code provides a glimpse into the structure and content of the <span class="in">`combined_scores`</span> data frame.</span>
<span id="cb65-158"><a href="#cb65-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-159"><a href="#cb65-159" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> id  <span class="pp">|</span> perceived<span class="sc">\_</span>difficulty <span class="pp">|</span> numeracy <span class="pp">|</span> energy<span class="sc">\_</span>use <span class="pp">|</span> energy<span class="sc">\_</span>save <span class="pp">|</span> els<span class="sc">\_</span>accuracy <span class="pp">|</span> els<span class="sc">\_</span>score <span class="pp">|</span> env<span class="sc">\_</span>attitude <span class="pp">|</span> env<span class="sc">\_</span>attitude<span class="sc">\_</span>z <span class="pp">|</span></span>
<span id="cb65-160"><a href="#cb65-160" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> :-- <span class="pp">| :--------------------</span> <span class="pp">| :-------</span> <span class="pp">| :----------</span> <span class="pp">| :-----------</span> <span class="pp">| :------------</span> <span class="pp">| :--------</span> <span class="pp">| :------------</span> <span class="pp">| :---------------</span> <span class="pp">|</span></span>
<span id="cb65-161"><a href="#cb65-161" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1   <span class="pp">|</span> 0.61                  <span class="pp">|</span> 1.5      <span class="pp">|</span> 1.101       <span class="pp">|</span> 1.01         <span class="pp">|</span> 6             <span class="pp">|</span> 0.74      <span class="pp">|</span> 3.2           <span class="pp">|</span> -0.43            <span class="pp">|</span></span>
<span id="cb65-162"><a href="#cb65-162" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 2   <span class="pp">|</span> -0.45                 <span class="pp">|</span> 1.5      <span class="pp">|</span> 0.137       <span class="pp">|</span> -0.46        <span class="pp">|</span> 5             <span class="pp">|</span> 0.20      <span class="pp">|</span> 3.5           <span class="pp">|</span> -0.11            <span class="pp">|</span></span>
<span id="cb65-163"><a href="#cb65-163" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 3   <span class="pp">|</span> 2.09                  <span class="pp">|</span> -2.0     <span class="pp">|</span> -1.440      <span class="pp">|</span> 0.70         <span class="pp">|</span> 4             <span class="pp">|</span> -0.33     <span class="pp">|</span> 3.0           <span class="pp">|</span> -0.76            <span class="pp">|</span></span>
<span id="cb65-164"><a href="#cb65-164" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 4   <span class="pp">|</span> -0.69                 <span class="pp">|</span> -1.3     <span class="pp">|</span> 1.346       <span class="pp">|</span> 2.16         <span class="pp">|</span> 2             <span class="pp">|</span> -1.40     <span class="pp">|</span> 3.8           <span class="pp">|</span> 0.22             <span class="pp">|</span></span>
<span id="cb65-165"><a href="#cb65-165" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 5   <span class="pp">|</span> 0.91                  <span class="pp">|</span> 1.5      <span class="pp">|</span> 0.075       <span class="pp">|</span> -0.52        <span class="pp">|</span> 3             <span class="pp">|</span> -0.87     <span class="pp">|</span> 3.8           <span class="pp">|</span> 0.22             <span class="pp">|</span></span>
<span id="cb65-166"><a href="#cb65-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-167"><a href="#cb65-167" aria-hidden="true" tabindex="-1"></a>This table shows the first five rows of the <span class="in">`combined_scores`</span> data frame, providing a snapshot of the calculated scores for each participant across the different measures. The scores include perceived difficulty, numeracy, energy use, energy save, ELS accuracy, ELS score, environmental attitude, and the z-score of environmental attitude.</span>
<span id="cb65-168"><a href="#cb65-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-169"><a href="#cb65-169" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive Statistics</span></span>
<span id="cb65-170"><a href="#cb65-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-173"><a href="#cb65-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-174"><a href="#cb65-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb65-175"><a href="#cb65-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb65-176"><a href="#cb65-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-177"><a href="#cb65-177" aria-hidden="true" tabindex="-1"></a><span class="co"># Histograms of key variables</span></span>
<span id="cb65-178"><a href="#cb65-178" aria-hidden="true" tabindex="-1"></a>key_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span> </span>
<span id="cb65-179"><a href="#cb65-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(perceived_difficulty, numeracy, energy_use, energy_save, els_score, env_attitude, pol_conservatism)</span>
<span id="cb65-180"><a href="#cb65-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-181"><a href="#cb65-181" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt the data for plotting</span></span>
<span id="cb65-182"><a href="#cb65-182" aria-hidden="true" tabindex="-1"></a>melted_vars <span class="ot">&lt;-</span> key_vars <span class="sc">%&gt;%</span></span>
<span id="cb65-183"><a href="#cb65-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"variable"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span>
<span id="cb65-184"><a href="#cb65-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-185"><a href="#cb65-185" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot histograms</span></span>
<span id="cb65-186"><a href="#cb65-186" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(melted_vars, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb65-187"><a href="#cb65-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb65-188"><a href="#cb65-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb65-189"><a href="#cb65-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-190"><a href="#cb65-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Key Variables"</span>, <span class="at">x =</span> <span class="st">"Value"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)</span>
<span id="cb65-191"><a href="#cb65-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-192"><a href="#cb65-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-193"><a href="#cb65-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-194"><a href="#cb65-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-195"><a href="#cb65-195" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation Analysis</span></span>
<span id="cb65-196"><a href="#cb65-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-199"><a href="#cb65-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-200"><a href="#cb65-200" aria-hidden="true" tabindex="-1"></a><span class="co"># Select relevant variables</span></span>
<span id="cb65-201"><a href="#cb65-201" aria-hidden="true" tabindex="-1"></a>cor_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-202"><a href="#cb65-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score,</span>
<span id="cb65-203"><a href="#cb65-203" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty, env_attitude, pol_conservatism)</span>
<span id="cb65-204"><a href="#cb65-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-205"><a href="#cb65-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute correlation matrix</span></span>
<span id="cb65-206"><a href="#cb65-206" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(cor_vars, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb65-207"><a href="#cb65-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-208"><a href="#cb65-208" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize correlation matrix</span></span>
<span id="cb65-209"><a href="#cb65-209" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(cor_matrix, </span>
<span id="cb65-210"><a href="#cb65-210" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"color"</span>, </span>
<span id="cb65-211"><a href="#cb65-211" aria-hidden="true" tabindex="-1"></a>                   <span class="at">addCoef.col =</span> <span class="st">"black"</span>, </span>
<span id="cb65-212"><a href="#cb65-212" aria-hidden="true" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb65-213"><a href="#cb65-213" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.col  =</span> <span class="st">"black"</span>,</span>
<span id="cb65-214"><a href="#cb65-214" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.srt  =</span> <span class="dv">45</span>,</span>
<span id="cb65-215"><a href="#cb65-215" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diag    =</span> <span class="cn">FALSE</span>)</span>
<span id="cb65-216"><a href="#cb65-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-217"><a href="#cb65-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-218"><a href="#cb65-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-219"><a href="#cb65-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-220"><a href="#cb65-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-221"><a href="#cb65-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-222"><a href="#cb65-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-223"><a href="#cb65-223" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cluster Analysis</span></span>
<span id="cb65-224"><a href="#cb65-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-227"><a href="#cb65-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-228"><a href="#cb65-228" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for clustering (select relevant variables and scale)</span></span>
<span id="cb65-229"><a href="#cb65-229" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-230"><a href="#cb65-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(perceived_difficulty, numeracy, energy_use, energy_save, els_score, env_attitude_z, pol_conservatism_z) <span class="sc">%&gt;%</span></span>
<span id="cb65-231"><a href="#cb65-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-232"><a href="#cb65-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb65-233"><a href="#cb65-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-234"><a href="#cb65-234" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine optimal number of clusters using the elbow method</span></span>
<span id="cb65-235"><a href="#cb65-235" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>) <span class="sc">+</span></span>
<span id="cb65-236"><a href="#cb65-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Elbow Method for Optimal k"</span>, <span class="at">x =</span> <span class="st">"Number of Clusters k"</span>)</span>
<span id="cb65-237"><a href="#cb65-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-238"><a href="#cb65-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-239"><a href="#cb65-239" aria-hidden="true" tabindex="-1"></a>This code performs a cluster analysis to identify groups of participants with similar profiles across the measured variables. It first prepares the data by selecting the relevant variables, removing rows with missing values, and scaling the data. Then, it uses the elbow method to determine the optimal number of clusters.</span>
<span id="cb65-240"><a href="#cb65-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-243"><a href="#cb65-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-244"><a href="#cb65-244" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform k-means clustering (e.g., with 3 clusters)</span></span>
<span id="cb65-245"><a href="#cb65-245" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb65-246"><a href="#cb65-246" aria-hidden="true" tabindex="-1"></a>km_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb65-247"><a href="#cb65-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-248"><a href="#cb65-248" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the clusters</span></span>
<span id="cb65-249"><a href="#cb65-249" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_result,</span>
<span id="cb65-250"><a href="#cb65-250" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> cluster_data,</span>
<span id="cb65-251"><a href="#cb65-251" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb65-252"><a href="#cb65-252" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipse.type =</span> <span class="st">"convex"</span>,</span>
<span id="cb65-253"><a href="#cb65-253" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()</span>
<span id="cb65-254"><a href="#cb65-254" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb65-255"><a href="#cb65-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clustering of Subjects"</span>)</span>
<span id="cb65-256"><a href="#cb65-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-257"><a href="#cb65-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-258"><a href="#cb65-258" aria-hidden="true" tabindex="-1"></a>This code performs k-means clustering with 3 clusters (as suggested by the elbow method) and visualizes the clusters using a scatter plot.</span>
<span id="cb65-259"><a href="#cb65-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-260"><a href="#cb65-260" aria-hidden="true" tabindex="-1"></a><span class="fu">### Elbow Method for Optimal k</span></span>
<span id="cb65-261"><a href="#cb65-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-262"><a href="#cb65-262" aria-hidden="true" tabindex="-1"></a>The elbow method suggests that the optimal number of clusters is where the decrease in the within-cluster sum of squares starts to slow down, forming an "elbow". In the generated plot, the elbow appears to be around 3 or 4 clusters. We will proceed with 3 clusters for this analysis, but further investigation with 4 clusters might be warranted.</span>
<span id="cb65-263"><a href="#cb65-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-264"><a href="#cb65-264" aria-hidden="true" tabindex="-1"></a><span class="fu">### K-means Clustering of Subjects</span></span>
<span id="cb65-265"><a href="#cb65-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-266"><a href="#cb65-266" aria-hidden="true" tabindex="-1"></a>The scatter plot shows the results of the k-means clustering with 3 clusters. Each point represents a participant, and the color indicates their assigned cluster. The ellipses represent the convex hulls of each cluster. The plot suggests some degree of separation between the clusters, although there is also some overlap.</span>
<span id="cb65-267"><a href="#cb65-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-268"><a href="#cb65-268" aria-hidden="true" tabindex="-1"></a><span class="fu">## Factor Analysis</span></span>
<span id="cb65-269"><a href="#cb65-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-272"><a href="#cb65-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-273"><a href="#cb65-273" aria-hidden="true" tabindex="-1"></a><span class="co"># Scree plot to determine the number of factors</span></span>
<span id="cb65-274"><a href="#cb65-274" aria-hidden="true" tabindex="-1"></a>fa_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-275"><a href="#cb65-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(perceived_difficulty, numeracy, energy_use, energy_save, els_score, env_attitude_z, pol_conservatism_z) <span class="sc">%&gt;%</span></span>
<span id="cb65-276"><a href="#cb65-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb65-277"><a href="#cb65-277" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(fa_data)</span>
<span id="cb65-278"><a href="#cb65-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-279"><a href="#cb65-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-280"><a href="#cb65-280" aria-hidden="true" tabindex="-1"></a>This code performs a factor analysis to explore the underlying structure of the measured variables. It first prepares the data by selecting the relevant variables and removing rows with missing values. Then, it generates a scree plot to help determine the number of factors to extract.</span>
<span id="cb65-281"><a href="#cb65-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-284"><a href="#cb65-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-285"><a href="#cb65-285" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform factor analysis with, e.g., 2 factors</span></span>
<span id="cb65-286"><a href="#cb65-286" aria-hidden="true" tabindex="-1"></a>fa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(fa_data, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)</span>
<span id="cb65-287"><a href="#cb65-287" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result, <span class="at">cut =</span> <span class="fl">0.3</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-288"><a href="#cb65-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-289"><a href="#cb65-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-290"><a href="#cb65-290" aria-hidden="true" tabindex="-1"></a>This code performs the factor analysis with 2 factors and prints the results, showing the factor loadings for each variable.</span>
<span id="cb65-291"><a href="#cb65-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-292"><a href="#cb65-292" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scree Plot</span></span>
<span id="cb65-293"><a href="#cb65-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-294"><a href="#cb65-294" aria-hidden="true" tabindex="-1"></a>The scree plot suggests that 2 or 3 factors might be appropriate, as the eigenvalues drop substantially after the second and third factors.</span>
<span id="cb65-295"><a href="#cb65-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-296"><a href="#cb65-296" aria-hidden="true" tabindex="-1"></a><span class="fu">### Factor Analysis Results</span></span>
<span id="cb65-297"><a href="#cb65-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-298"><a href="#cb65-298" aria-hidden="true" tabindex="-1"></a>The factor analysis results with 2 factors show that:</span>
<span id="cb65-299"><a href="#cb65-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-300"><a href="#cb65-300" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Factor 1** is primarily associated with <span class="in">`env_attitude_z`</span> and <span class="in">`pol_conservatism_z`</span>, suggesting a factor related to environmental and political attitudes.</span>
<span id="cb65-301"><a href="#cb65-301" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Factor 2** is primarily associated with <span class="in">`energy_use`</span>, <span class="in">`energy_save`</span>, <span class="in">`numeracy`</span>, and <span class="in">`els_score`</span>, suggesting a factor related to energy knowledge and behavior.</span>
<span id="cb65-302"><a href="#cb65-302" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span><span class="in">`perceived_difficulty`</span> loads negatively on Factor 2, indicating that individuals with higher energy knowledge and better energy-saving behaviors tend to perceive these behaviors as less difficult.</span>
<span id="cb65-303"><a href="#cb65-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-304"><a href="#cb65-304" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regression Analysis</span></span>
<span id="cb65-305"><a href="#cb65-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-308"><a href="#cb65-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-309"><a href="#cb65-309" aria-hidden="true" tabindex="-1"></a><span class="co"># Model predicting ELS from motivation, controlling for other knowledge scores</span></span>
<span id="cb65-310"><a href="#cb65-310" aria-hidden="true" tabindex="-1"></a>model_els_enhanced <span class="ot">&lt;-</span> <span class="fu">lm</span>(els_score <span class="sc">~</span> perceived_difficulty <span class="sc">+</span> env_attitude_z <span class="sc">+</span> pol_conservatism_z <span class="sc">+</span></span>
<span id="cb65-311"><a href="#cb65-311" aria-hidden="true" tabindex="-1"></a>  numeracy <span class="sc">+</span> energy_use <span class="sc">+</span> energy_save, <span class="at">data =</span> combined_scores)</span>
<span id="cb65-312"><a href="#cb65-312" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_els_enhanced)</span>
<span id="cb65-313"><a href="#cb65-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-314"><a href="#cb65-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-315"><a href="#cb65-315" aria-hidden="true" tabindex="-1"></a>This code performs a linear regression analysis to examine the relationship between energy literacy (ELS) and motivation, while controlling for other knowledge scores.</span>
<span id="cb65-316"><a href="#cb65-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-317"><a href="#cb65-317" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regression Results</span></span>
<span id="cb65-318"><a href="#cb65-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-319"><a href="#cb65-319" aria-hidden="true" tabindex="-1"></a>The regression results show that:</span>
<span id="cb65-320"><a href="#cb65-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-321"><a href="#cb65-321" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span><span class="in">`env_attitude_z`</span> is a significant positive predictor of ELS, indicating that individuals with more pro-environmental attitudes tend to have higher energy literacy.</span>
<span id="cb65-322"><a href="#cb65-322" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span><span class="in">`numeracy`</span>, <span class="in">`energy_use`</span>, and <span class="in">`energy_save`</span> are also significant positive predictors of ELS, suggesting that individuals with higher numeracy skills and those who are more accurate in their estimations of energy use and savings tend to have higher energy literacy.</span>
<span id="cb65-323"><a href="#cb65-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-324"><a href="#cb65-324" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mixed Effects Regression</span></span>
<span id="cb65-325"><a href="#cb65-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-326"><a href="#cb65-326" aria-hidden="true" tabindex="-1"></a>Finally, we can examine a regression where a clustering variable is treated as a random effect.</span>
<span id="cb65-327"><a href="#cb65-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-330"><a href="#cb65-330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-331"><a href="#cb65-331" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-332"><a href="#cb65-332" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb65-333"><a href="#cb65-333" aria-hidden="true" tabindex="-1"></a><span class="co"># Mixed Effects Model to Account for Potential Group-Level Effects</span></span>
<span id="cb65-334"><a href="#cb65-334" aria-hidden="true" tabindex="-1"></a>mixed_model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(els_score <span class="sc">~</span> env_attitude <span class="sc">+</span> perceived_difficulty <span class="sc">+</span></span>
<span id="cb65-335"><a href="#cb65-335" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span> id), <span class="at">data =</span> combined_scores)</span>
<span id="cb65-336"><a href="#cb65-336" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (mixed_model)</span>
<span id="cb65-337"><a href="#cb65-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-338"><a href="#cb65-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-339"><a href="#cb65-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-340"><a href="#cb65-340" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interaction Effects in Regression</span></span>
<span id="cb65-341"><a href="#cb65-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-344"><a href="#cb65-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-345"><a href="#cb65-345" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Interaction between environmental attitude and perceived difficulty on ELS</span></span>
<span id="cb65-346"><a href="#cb65-346" aria-hidden="true" tabindex="-1"></a>model_interaction <span class="ot">&lt;-</span> <span class="fu">lm</span>(els_score <span class="sc">~</span> perceived_difficulty <span class="sc">*</span> env_attitude_z, <span class="at">data =</span> combined_scores)</span>
<span id="cb65-347"><a href="#cb65-347" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_interaction)</span>
<span id="cb65-348"><a href="#cb65-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-349"><a href="#cb65-349" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the interaction (example)</span></span>
<span id="cb65-350"><a href="#cb65-350" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_scores, <span class="fu">aes</span>(<span class="at">x =</span> perceived_difficulty, <span class="at">y =</span> els_score, <span class="at">color =</span> env_attitude_z)) <span class="sc">+</span></span>
<span id="cb65-351"><a href="#cb65-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb65-352"><a href="#cb65-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb65-353"><a href="#cb65-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb65-354"><a href="#cb65-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb65-355"><a href="#cb65-355" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Interaction of Perceived Difficulty and Environmental Attitude on ELS"</span>,</span>
<span id="cb65-356"><a href="#cb65-356" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Perceived Difficulty"</span>,</span>
<span id="cb65-357"><a href="#cb65-357" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Energy Literacy Score"</span></span>
<span id="cb65-358"><a href="#cb65-358" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb65-359"><a href="#cb65-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb65-360"><a href="#cb65-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-361"><a href="#cb65-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-362"><a href="#cb65-362" aria-hidden="true" tabindex="-1"></a>This code explores the potential interaction effect between environmental attitude and perceived difficulty on ELS using a linear regression model. It also visualizes the interaction using a scatter plot with a regression line for each level of environmental attitude.</span>
<span id="cb65-363"><a href="#cb65-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-364"><a href="#cb65-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-365"><a href="#cb65-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-366"><a href="#cb65-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-367"><a href="#cb65-367" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interaction Results</span></span>
<span id="cb65-368"><a href="#cb65-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-369"><a href="#cb65-369" aria-hidden="true" tabindex="-1"></a>The regression results do not show a significant interaction effect between perceived difficulty and environmental attitude on ELS. The visualization also suggests that the relationship between perceived difficulty and ELS does not vary substantially across different levels of environmental attitude.</span>
<span id="cb65-370"><a href="#cb65-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-371"><a href="#cb65-371" aria-hidden="true" tabindex="-1"></a><span class="fu">## Enhanced Correlation Plot</span></span>
<span id="cb65-372"><a href="#cb65-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-375"><a href="#cb65-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-376"><a href="#cb65-376" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> attari1 <span class="sc">%&gt;%</span></span>
<span id="cb65-377"><a href="#cb65-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(attari2_scores, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-378"><a href="#cb65-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(els_scores,       <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-379"><a href="#cb65-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(rs_scores,        <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb65-380"><a href="#cb65-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-381"><a href="#cb65-381" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Enhanced Correlation Plot</span></span>
<span id="cb65-382"><a href="#cb65-382" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb65-383"><a href="#cb65-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy_score, relative_energy_use_score,</span>
<span id="cb65-384"><a href="#cb65-384" aria-hidden="true" tabindex="-1"></a>         relative_energy_save_score, els,</span>
<span id="cb65-385"><a href="#cb65-385" aria-hidden="true" tabindex="-1"></a>         perceived_difficulty_score, env_attitude,</span>
<span id="cb65-386"><a href="#cb65-386" aria-hidden="true" tabindex="-1"></a>         pol_conservatism_z) <span class="sc">%&gt;%</span></span>
<span id="cb65-387"><a href="#cb65-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb65-388"><a href="#cb65-388" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">type =</span> <span class="st">"upper"</span>, <span class="at">addCoef.col =</span> <span class="st">"black"</span>, <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>, <span class="at">diag =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span>))(<span class="dv">200</span>))</span>
<span id="cb65-389"><a href="#cb65-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-390"><a href="#cb65-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-391"><a href="#cb65-391" aria-hidden="true" tabindex="-1"></a>This generates a visually informative correlation plot.</span>
<span id="cb65-392"><a href="#cb65-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-393"><a href="#cb65-393" aria-hidden="true" tabindex="-1"></a><span class="fu">### Correlation Plot Interpretation</span></span>
<span id="cb65-394"><a href="#cb65-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-395"><a href="#cb65-395" aria-hidden="true" tabindex="-1"></a>The correlation plot reveals several interesting patterns:</span>
<span id="cb65-396"><a href="#cb65-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-397"><a href="#cb65-397" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Positive correlations** among knowledge measures (numeracy, energy use, energy save, and ELS).</span>
<span id="cb65-398"><a href="#cb65-398" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Negative correlations** between perceived difficulty and knowledge measures.</span>
<span id="cb65-399"><a href="#cb65-399" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Positive correlation** between environmental attitude and ELS.</span>
<span id="cb65-400"><a href="#cb65-400" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Negative correlation** between political conservatism and environmental attitude.</span>
<span id="cb65-401"><a href="#cb65-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-402"><a href="#cb65-402" aria-hidden="true" tabindex="-1"></a><span class="fu">## Knowledge Profile Clustering</span></span>
<span id="cb65-403"><a href="#cb65-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-406"><a href="#cb65-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-407"><a href="#cb65-407" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Knowledge Profile Clustering</span></span>
<span id="cb65-408"><a href="#cb65-408" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize knowledge variables</span></span>
<span id="cb65-409"><a href="#cb65-409" aria-hidden="true" tabindex="-1"></a>knowledge_vars <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb65-410"><a href="#cb65-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy_score, relative_energy_use_score,</span>
<span id="cb65-411"><a href="#cb65-411" aria-hidden="true" tabindex="-1"></a>         relative_energy_save_score, els) <span class="sc">%&gt;%</span></span>
<span id="cb65-412"><a href="#cb65-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb65-413"><a href="#cb65-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-414"><a href="#cb65-414" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine optimal number of clusters</span></span>
<span id="cb65-415"><a href="#cb65-415" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb65-416"><a href="#cb65-416" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(k) {</span>
<span id="cb65-417"><a href="#cb65-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kmeans</span>(knowledge_vars, <span class="at">centers =</span> k)<span class="sc">$</span>tot.withinss</span>
<span id="cb65-418"><a href="#cb65-418" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb65-419"><a href="#cb65-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-420"><a href="#cb65-420" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform k-means clustering</span></span>
<span id="cb65-421"><a href="#cb65-421" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># Based on elbow plot inspection</span></span>
<span id="cb65-422"><a href="#cb65-422" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(knowledge_vars, <span class="at">centers =</span> k)</span>
<span id="cb65-423"><a href="#cb65-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-424"><a href="#cb65-424" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster membership to data</span></span>
<span id="cb65-425"><a href="#cb65-425" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>knowledge_cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(clusters<span class="sc">$</span>cluster)</span>
<span id="cb65-426"><a href="#cb65-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-427"><a href="#cb65-427" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize clusters</span></span>
<span id="cb65-428"><a href="#cb65-428" aria-hidden="true" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(knowledge_vars)</span>
<span id="cb65-429"><a href="#cb65-429" aria-hidden="true" tabindex="-1"></a>cluster_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb65-430"><a href="#cb65-430" aria-hidden="true" tabindex="-1"></a>  <span class="at">PC1 =</span> pca_result<span class="sc">$</span>x[, <span class="dv">1</span>],</span>
<span id="cb65-431"><a href="#cb65-431" aria-hidden="true" tabindex="-1"></a>  <span class="at">PC2 =</span> pca_result<span class="sc">$</span>x[, <span class="dv">2</span>],</span>
<span id="cb65-432"><a href="#cb65-432" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cluster =</span> combined_df<span class="sc">$</span>knowledge_cluster</span>
<span id="cb65-433"><a href="#cb65-433" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-434"><a href="#cb65-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-435"><a href="#cb65-435" aria-hidden="true" tabindex="-1"></a><span class="co"># Create cluster visualization</span></span>
<span id="cb65-436"><a href="#cb65-436" aria-hidden="true" tabindex="-1"></a>p_clusters <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cluster_df, <span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">color =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb65-437"><a href="#cb65-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb65-438"><a href="#cb65-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">level =</span> <span class="fl">0.95</span>) <span class="sc">+</span></span>
<span id="cb65-439"><a href="#cb65-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-440"><a href="#cb65-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb65-441"><a href="#cb65-441" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Knowledge Profiles Clustering"</span>,</span>
<span id="cb65-442"><a href="#cb65-442" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"First Principal Component"</span>,</span>
<span id="cb65-443"><a href="#cb65-443" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Second Principal Component"</span></span>
<span id="cb65-444"><a href="#cb65-444" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-445"><a href="#cb65-445" aria-hidden="true" tabindex="-1"></a>p_clusters</span>
<span id="cb65-446"><a href="#cb65-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-447"><a href="#cb65-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-448"><a href="#cb65-448" aria-hidden="true" tabindex="-1"></a>The regression results do not show a significant interaction effect between perceived difficulty and environmental attitude on ELS. The visualization also suggests that the relationship between perceived difficulty and ELS does not vary substantially across different levels of environmental attitude.</span>
<span id="cb65-449"><a href="#cb65-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-450"><a href="#cb65-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-451"><a href="#cb65-451" aria-hidden="true" tabindex="-1"></a><span class="fu">## Knowledge-Motivation Interaction Analysis</span></span>
<span id="cb65-452"><a href="#cb65-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-455"><a href="#cb65-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-456"><a href="#cb65-456" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Knowledge-Motivation Interaction Analysis</span></span>
<span id="cb65-457"><a href="#cb65-457" aria-hidden="true" tabindex="-1"></a>interaction_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(els <span class="sc">~</span> env_attitude <span class="sc">*</span> perceived_difficulty_score <span class="sc">+</span></span>
<span id="cb65-458"><a href="#cb65-458" aria-hidden="true" tabindex="-1"></a>  numeracy_score, <span class="at">data =</span> combined_df)</span>
<span id="cb65-459"><a href="#cb65-459" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interaction_model)</span>
<span id="cb65-460"><a href="#cb65-460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-461"><a href="#cb65-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-462"><a href="#cb65-462" aria-hidden="true" tabindex="-1"></a>The regression results do not show a significant interaction effect between environmental attitude and perceived difficulty in predicting ELS.</span>
<span id="cb65-463"><a href="#cb65-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-464"><a href="#cb65-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-465"><a href="#cb65-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-466"><a href="#cb65-466" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interaction Analysis Results</span></span>
<span id="cb65-467"><a href="#cb65-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-468"><a href="#cb65-468" aria-hidden="true" tabindex="-1"></a>The regression results do not show a significant interaction effect between environmental attitude and perceived difficulty in predicting ELS.</span>
<span id="cb65-469"><a href="#cb65-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-470"><a href="#cb65-470" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cluster Profile Analysis</span></span>
<span id="cb65-471"><a href="#cb65-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-474"><a href="#cb65-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-475"><a href="#cb65-475" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster profile analysis</span></span>
<span id="cb65-476"><a href="#cb65-476" aria-hidden="true" tabindex="-1"></a>cluster_profiles <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb65-477"><a href="#cb65-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(knowledge_cluster) <span class="sc">%&gt;%</span></span>
<span id="cb65-478"><a href="#cb65-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb65-479"><a href="#cb65-479" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_numeracy =</span> <span class="fu">mean</span>(numeracy_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-480"><a href="#cb65-480" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_energy_use =</span> <span class="fu">mean</span>(relative_energy_use_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-481"><a href="#cb65-481" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_energy_save =</span> <span class="fu">mean</span>(relative_energy_save_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-482"><a href="#cb65-482" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_els =</span> <span class="fu">mean</span>(els, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-483"><a href="#cb65-483" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_env_attitude =</span> <span class="fu">mean</span>(env_attitude, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-484"><a href="#cb65-484" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_difficulty =</span> <span class="fu">mean</span>(perceived_difficulty_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-485"><a href="#cb65-485" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb65-486"><a href="#cb65-486" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-487"><a href="#cb65-487" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cluster_profiles)</span>
<span id="cb65-488"><a href="#cb65-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-489"><a href="#cb65-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-490"><a href="#cb65-490" aria-hidden="true" tabindex="-1"></a>This code calculates the mean scores on each variable for each of the three knowledge clusters identified earlier.</span>
<span id="cb65-491"><a href="#cb65-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-492"><a href="#cb65-492" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cluster Profile Analysis Results</span></span>
<span id="cb65-493"><a href="#cb65-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-494"><a href="#cb65-494" aria-hidden="true" tabindex="-1"></a>The table shows the mean scores for each cluster on the knowledge and motivation variables. This allows for a detailed comparison of the profiles of each cluster. For example, Cluster 1 has below average scores on all knowledge and motivation measures, while Cluster 3 has above average scores on those same measures.</span>
<span id="cb65-495"><a href="#cb65-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-496"><a href="#cb65-496" aria-hidden="true" tabindex="-1"></a><span class="fu">## K-means Clustering on Knowledge and Motivation Variables</span></span>
<span id="cb65-497"><a href="#cb65-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-500"><a href="#cb65-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-501"><a href="#cb65-501" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: K-means clustering on knowledge + motivation</span></span>
<span id="cb65-502"><a href="#cb65-502" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset your knowledge &amp; motivation columns</span></span>
<span id="cb65-503"><a href="#cb65-503" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> combined_df <span class="sc">%&gt;%</span></span>
<span id="cb65-504"><a href="#cb65-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy_score, relative_energy_use_score, relative_energy_save_score,</span>
<span id="cb65-505"><a href="#cb65-505" aria-hidden="true" tabindex="-1"></a>         els, perceived_difficulty_score, env_attitude, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb65-506"><a href="#cb65-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb65-507"><a href="#cb65-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-508"><a href="#cb65-508" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale them</span></span>
<span id="cb65-509"><a href="#cb65-509" aria-hidden="true" tabindex="-1"></a>cluster_data_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(cluster_data)</span>
<span id="cb65-510"><a href="#cb65-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-511"><a href="#cb65-511" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide on number of clusters (e.g. 2-5) use e.g. Elbow method</span></span>
<span id="cb65-512"><a href="#cb65-512" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data_scaled, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>)</span>
<span id="cb65-513"><a href="#cb65-513" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-514"><a href="#cb65-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-515"><a href="#cb65-515" aria-hidden="true" tabindex="-1"></a>The elbow method plot suggests 3 clusters is a reasonable choice.</span>
<span id="cb65-516"><a href="#cb65-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-517"><a href="#cb65-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-520"><a href="#cb65-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-521"><a href="#cb65-521" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose we choose 3 clusters as a demonstration</span></span>
<span id="cb65-522"><a href="#cb65-522" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb65-523"><a href="#cb65-523" aria-hidden="true" tabindex="-1"></a>km_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data_scaled, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb65-524"><a href="#cb65-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-525"><a href="#cb65-525" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster membership back into the original data</span></span>
<span id="cb65-526"><a href="#cb65-526" aria-hidden="true" tabindex="-1"></a>cluster_data<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(km_result<span class="sc">$</span>cluster)</span>
<span id="cb65-527"><a href="#cb65-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-528"><a href="#cb65-528" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize clusters in 2D (using PCA behind the scenes)</span></span>
<span id="cb65-529"><a href="#cb65-529" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_result,</span>
<span id="cb65-530"><a href="#cb65-530" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> cluster_data_scaled,</span>
<span id="cb65-531"><a href="#cb65-531" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">ellipse.type =</span> <span class="st">"convex"</span>) <span class="sc">+</span></span>
<span id="cb65-532"><a href="#cb65-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-533"><a href="#cb65-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clusters of Knowledge &amp; Motivation Variables"</span>)</span>
<span id="cb65-534"><a href="#cb65-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-535"><a href="#cb65-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-536"><a href="#cb65-536" aria-hidden="true" tabindex="-1"></a>This code performs the k-means clustering with 3 clusters and visualizes the results using a scatter plot.</span>
<span id="cb65-537"><a href="#cb65-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-538"><a href="#cb65-538" aria-hidden="true" tabindex="-1"></a><span class="fu">### Clustering Results</span></span>
<span id="cb65-539"><a href="#cb65-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-540"><a href="#cb65-540" aria-hidden="true" tabindex="-1"></a>The elbow method suggests that 3 clusters might be appropriate. The scatter plot shows the three clusters based on the combined knowledge and motivation variables.</span>
<span id="cb65-541"><a href="#cb65-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-542"><a href="#cb65-542" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mediation Analysis</span></span>
<span id="cb65-543"><a href="#cb65-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-546"><a href="#cb65-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-547"><a href="#cb65-547" aria-hidden="true" tabindex="-1"></a><span class="co"># Example mediation: knowledge -&gt; perceived_difficulty -&gt; env_attitude</span></span>
<span id="cb65-548"><a href="#cb65-548" aria-hidden="true" tabindex="-1"></a>model_mediation <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb65-549"><a href="#cb65-549" aria-hidden="true" tabindex="-1"></a><span class="st">  # direct effect</span></span>
<span id="cb65-550"><a href="#cb65-550" aria-hidden="true" tabindex="-1"></a><span class="st">  env_attitude ~ c*els</span></span>
<span id="cb65-551"><a href="#cb65-551" aria-hidden="true" tabindex="-1"></a><span class="st">  # mediator</span></span>
<span id="cb65-552"><a href="#cb65-552" aria-hidden="true" tabindex="-1"></a><span class="st">  perceived_difficulty_score ~ a*els</span></span>
<span id="cb65-553"><a href="#cb65-553" aria-hidden="true" tabindex="-1"></a><span class="st">  env_attitude ~ b*perceived_difficulty_score</span></span>
<span id="cb65-554"><a href="#cb65-554" aria-hidden="true" tabindex="-1"></a><span class="st">  # indirect effect</span></span>
<span id="cb65-555"><a href="#cb65-555" aria-hidden="true" tabindex="-1"></a><span class="st">  ab := a*b</span></span>
<span id="cb65-556"><a href="#cb65-556" aria-hidden="true" tabindex="-1"></a><span class="st">  # total effect</span></span>
<span id="cb65-557"><a href="#cb65-557" aria-hidden="true" tabindex="-1"></a><span class="st">  total := c + (a*b)</span></span>
<span id="cb65-558"><a href="#cb65-558" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb65-559"><a href="#cb65-559" aria-hidden="true" tabindex="-1"></a>fit_mediation <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_mediation, <span class="at">data =</span> combined_df, <span class="at">missing =</span> <span class="st">"fiml"</span>)</span>
<span id="cb65-560"><a href="#cb65-560" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_mediation, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">rsquare =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-561"><a href="#cb65-561" aria-hidden="true" tabindex="-1"></a>tidySEM<span class="sc">::</span><span class="fu">graph_sem</span>(fit_mediation)</span>
<span id="cb65-562"><a href="#cb65-562" aria-hidden="true" tabindex="-1"></a>semPlot<span class="sc">::</span><span class="fu">semPaths</span>(fit_mediation,<span class="at">layout=</span><span class="st">"tree2"</span>,<span class="at">residual=</span><span class="cn">TRUE</span>,<span class="at">whatLabels=</span><span class="st">"est"</span>, <span class="at">nCharNodes =</span> <span class="dv">9</span>)</span>
<span id="cb65-563"><a href="#cb65-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-564"><a href="#cb65-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-565"><a href="#cb65-565" aria-hidden="true" tabindex="-1"></a>This code performs a mediation analysis to test whether perceived difficulty mediates the relationship between knowledge (ELS) and environmental attitude.</span>
<span id="cb65-566"><a href="#cb65-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-567"><a href="#cb65-567" aria-hidden="true" tabindex="-1"></a><span class="fu"># Modeling the Relationship between Knowledge and Motivation using Structural Equation Modeling</span></span>
<span id="cb65-568"><a href="#cb65-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-571"><a href="#cb65-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-572"><a href="#cb65-572" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothetical model:</span></span>
<span id="cb65-573"><a href="#cb65-573" aria-hidden="true" tabindex="-1"></a><span class="co">#   - latent Knowledge from numeracy, energy_use, energy_save, els_score</span></span>
<span id="cb65-574"><a href="#cb65-574" aria-hidden="true" tabindex="-1"></a><span class="co">#   - latent Motivation from env_attitude, perceived_difficulty</span></span>
<span id="cb65-575"><a href="#cb65-575" aria-hidden="true" tabindex="-1"></a><span class="co">#   - regression: Knowledge ~ Motivation</span></span>
<span id="cb65-576"><a href="#cb65-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-577"><a href="#cb65-577" aria-hidden="true" tabindex="-1"></a>sem_model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb65-578"><a href="#cb65-578" aria-hidden="true" tabindex="-1"></a><span class="st">  Knowledge =~ numeracy + energy_use + energy_save + els_score</span></span>
<span id="cb65-579"><a href="#cb65-579" aria-hidden="true" tabindex="-1"></a><span class="st">  Motivation =~ env_attitude + perceived_difficulty</span></span>
<span id="cb65-580"><a href="#cb65-580" aria-hidden="true" tabindex="-1"></a><span class="st">  Knowledge ~ Motivation</span></span>
<span id="cb65-581"><a href="#cb65-581" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb65-582"><a href="#cb65-582" aria-hidden="true" tabindex="-1"></a>fit_sem <span class="ot">&lt;-</span> <span class="fu">sem</span>(sem_model, <span class="at">data =</span> combined_scores, <span class="at">missing =</span> <span class="st">"fiml"</span>)  <span class="co"># handle missing if needed</span></span>
<span id="cb65-583"><a href="#cb65-583" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_sem, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-584"><a href="#cb65-584" aria-hidden="true" tabindex="-1"></a>tidySEM<span class="sc">::</span><span class="fu">graph_sem</span>(fit_sem)</span>
<span id="cb65-585"><a href="#cb65-585" aria-hidden="true" tabindex="-1"></a>semPlot<span class="sc">::</span><span class="fu">semPaths</span>(fit_sem,<span class="at">layout=</span><span class="st">"tree2"</span>,<span class="at">residual=</span><span class="cn">TRUE</span>,<span class="at">whatLabels=</span><span class="st">"est"</span>, <span class="at">nCharNodes =</span> <span class="dv">9</span>)</span>
<span id="cb65-586"><a href="#cb65-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-587"><a href="#cb65-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-588"><a href="#cb65-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-589"><a href="#cb65-589" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mediation Analysis Results</span></span>
<span id="cb65-590"><a href="#cb65-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-591"><a href="#cb65-591" aria-hidden="true" tabindex="-1"></a>The mediation analysis results suggest that perceived difficulty partially mediates the relationship between ELS and environmental attitude. The indirect effect is significant, indicating that higher ELS is associated with lower perceived difficulty, which in turn is associated with a more positive environmental attitude.</span>
<span id="cb65-592"><a href="#cb65-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-593"><a href="#cb65-593" aria-hidden="true" tabindex="-1"></a><span class="fu">## Knowledge-Motivation Profiles by Cluster</span></span>
<span id="cb65-594"><a href="#cb65-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-597"><a href="#cb65-597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-598"><a href="#cb65-598" aria-hidden="true" tabindex="-1"></a><span class="co"># Create composite knowledge score</span></span>
<span id="cb65-599"><a href="#cb65-599" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>composite_knowledge <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(combined_scores[, <span class="fu">c</span>(<span class="st">"numeracy"</span>, <span class="st">"energy_use"</span>, <span class="st">"energy_save"</span>, <span class="st">"els_score"</span>)])</span>
<span id="cb65-600"><a href="#cb65-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-601"><a href="#cb65-601" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure cluster column exists</span></span>
<span id="cb65-602"><a href="#cb65-602" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cluster_data<span class="sc">$</span>cluster)</span>
<span id="cb65-603"><a href="#cb65-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-604"><a href="#cb65-604" aria-hidden="true" tabindex="-1"></a><span class="co"># Create standardized scores for profile analysis</span></span>
<span id="cb65-605"><a href="#cb65-605" aria-hidden="true" tabindex="-1"></a>profile_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-606"><a href="#cb65-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, cluster, numeracy, energy_use, energy_save,</span>
<span id="cb65-607"><a href="#cb65-607" aria-hidden="true" tabindex="-1"></a>         els_score, env_attitude, perceived_difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb65-608"><a href="#cb65-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(measure, value, <span class="sc">-</span>id, <span class="sc">-</span>cluster) <span class="sc">%&gt;%</span></span>
<span id="cb65-609"><a href="#cb65-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(measure) <span class="sc">%&gt;%</span></span>
<span id="cb65-610"><a href="#cb65-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_score =</span> <span class="fu">scale</span>(value)[, <span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb65-611"><a href="#cb65-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb65-612"><a href="#cb65-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-613"><a href="#cb65-613" aria-hidden="true" tabindex="-1"></a><span class="co"># Create profile plot</span></span>
<span id="cb65-614"><a href="#cb65-614" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(profile_data, <span class="fu">aes</span>(<span class="at">x =</span> measure, <span class="at">y =</span> z_score, <span class="at">color =</span> cluster, <span class="at">group =</span> cluster)) <span class="sc">+</span></span>
<span id="cb65-615"><a href="#cb65-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb65-616"><a href="#cb65-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb65-617"><a href="#cb65-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb65-618"><a href="#cb65-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-619"><a href="#cb65-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb65-620"><a href="#cb65-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb65-621"><a href="#cb65-621" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Knowledge-Motivation Profiles by Cluster"</span>,</span>
<span id="cb65-622"><a href="#cb65-622" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Measure"</span>, <span class="at">y =</span> <span class="st">"Standardized Score"</span></span>
<span id="cb65-623"><a href="#cb65-623" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-624"><a href="#cb65-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-625"><a href="#cb65-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-626"><a href="#cb65-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-627"><a href="#cb65-627" aria-hidden="true" tabindex="-1"></a>The profile plot shows distinct patterns for each cluster:</span>
<span id="cb65-628"><a href="#cb65-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-629"><a href="#cb65-629" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Cluster 1:** Below average on all knowledge measures, above average on perceived difficulty, and average on environmental attitude.</span>
<span id="cb65-630"><a href="#cb65-630" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Cluster 2:** Above average on knowledge measures, below average on perceived difficulty, and average on environmental attitude.</span>
<span id="cb65-631"><a href="#cb65-631" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Cluster 3:** Average on knowledge measures, below average on perceived difficulty, and above average on environmental attitude.</span>
<span id="cb65-632"><a href="#cb65-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-633"><a href="#cb65-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-636"><a href="#cb65-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-637"><a href="#cb65-637" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine key measures into correlation matrix</span></span>
<span id="cb65-638"><a href="#cb65-638" aria-hidden="true" tabindex="-1"></a>key_measures <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-639"><a href="#cb65-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb65-640"><a href="#cb65-640" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Knowledge measures</span></span>
<span id="cb65-641"><a href="#cb65-641" aria-hidden="true" tabindex="-1"></a>    numeracy, energy_use, energy_save, els_score,</span>
<span id="cb65-642"><a href="#cb65-642" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Motivation/attitude measures</span></span>
<span id="cb65-643"><a href="#cb65-643" aria-hidden="true" tabindex="-1"></a>    env_attitude, perceived_difficulty, pol_conservatism</span>
<span id="cb65-644"><a href="#cb65-644" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb65-645"><a href="#cb65-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb65-646"><a href="#cb65-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-647"><a href="#cb65-647" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and visualize correlation matrix</span></span>
<span id="cb65-648"><a href="#cb65-648" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(key_measures, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb65-649"><a href="#cb65-649" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix,</span>
<span id="cb65-650"><a href="#cb65-650" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> <span class="st">"color"</span>,</span>
<span id="cb65-651"><a href="#cb65-651" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb65-652"><a href="#cb65-652" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">"black"</span>,</span>
<span id="cb65-653"><a href="#cb65-653" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb65-654"><a href="#cb65-654" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb65-655"><a href="#cb65-655" aria-hidden="true" tabindex="-1"></a>         <span class="at">diag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb65-656"><a href="#cb65-656" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span>))(<span class="dv">200</span>)</span>
<span id="cb65-657"><a href="#cb65-657" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-658"><a href="#cb65-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-659"><a href="#cb65-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-660"><a href="#cb65-660" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Factor Analysis to examine underlying structure</span></span>
<span id="cb65-661"><a href="#cb65-661" aria-hidden="true" tabindex="-1"></a>fa_results <span class="ot">&lt;-</span> <span class="fu">fa</span>(key_measures, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)</span>
<span id="cb65-662"><a href="#cb65-662" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (fa_results, <span class="at">cut =</span> <span class="fl">0.3</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-663"><a href="#cb65-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-664"><a href="#cb65-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-665"><a href="#cb65-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-666"><a href="#cb65-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-667"><a href="#cb65-667" aria-hidden="true" tabindex="-1"></a><span class="fu">## Canonical Correlation Analysis (CCA)</span></span>
<span id="cb65-668"><a href="#cb65-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-671"><a href="#cb65-671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-672"><a href="#cb65-672" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Canonical Correlation Analysis between Knowledge and Motivation Sets</span></span>
<span id="cb65-673"><a href="#cb65-673" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare matrices</span></span>
<span id="cb65-674"><a href="#cb65-674" aria-hidden="true" tabindex="-1"></a>knowledge_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span> <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score) <span class="sc">%&gt;%</span></span>
<span id="cb65-675"><a href="#cb65-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb65-676"><a href="#cb65-676" aria-hidden="true" tabindex="-1"></a>motivation_vars <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-677"><a href="#cb65-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(env_attitude, perceived_difficulty, pol_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb65-678"><a href="#cb65-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb65-679"><a href="#cb65-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-680"><a href="#cb65-680" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform CCA</span></span>
<span id="cb65-681"><a href="#cb65-681" aria-hidden="true" tabindex="-1"></a>cc_result <span class="ot">&lt;-</span> <span class="fu">cancor</span>(knowledge_vars, motivation_vars)</span>
<span id="cb65-682"><a href="#cb65-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-683"><a href="#cb65-683" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Network Analysis to Visualize Variable Relationships</span></span>
<span id="cb65-684"><a href="#cb65-684" aria-hidden="true" tabindex="-1"></a><span class="co"># Create correlation matrix</span></span>
<span id="cb65-685"><a href="#cb65-685" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-686"><a href="#cb65-686" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score,</span>
<span id="cb65-687"><a href="#cb65-687" aria-hidden="true" tabindex="-1"></a>                           env_attitude, perceived_difficulty, pol_conservatism),</span>
<span id="cb65-688"><a href="#cb65-688" aria-hidden="true" tabindex="-1"></a>                  <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb65-689"><a href="#cb65-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-690"><a href="#cb65-690" aria-hidden="true" tabindex="-1"></a><span class="co"># Create network plot</span></span>
<span id="cb65-691"><a href="#cb65-691" aria-hidden="true" tabindex="-1"></a><span class="fu">qgraph</span>(cor_matrix,</span>
<span id="cb65-692"><a href="#cb65-692" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"spring"</span>,</span>
<span id="cb65-693"><a href="#cb65-693" aria-hidden="true" tabindex="-1"></a>       <span class="at">groups =</span> <span class="fu">list</span>(<span class="at">Knowledge =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">Motivation =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb65-694"><a href="#cb65-694" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"lightblue"</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">"lightgreen"</span>, <span class="dv">3</span>)))</span>
<span id="cb65-695"><a href="#cb65-695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-696"><a href="#cb65-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-697"><a href="#cb65-697" aria-hidden="true" tabindex="-1"></a>This performs a CCA to explore the relationships between the set of knowledge variables and the set of motivation variables and a network analysis to visualize variable relationships.</span>
<span id="cb65-698"><a href="#cb65-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-699"><a href="#cb65-699" aria-hidden="true" tabindex="-1"></a><span class="fu">### CCA Results</span></span>
<span id="cb65-700"><a href="#cb65-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-701"><a href="#cb65-701" aria-hidden="true" tabindex="-1"></a>The CCA identifies canonical variates that maximally correlate the knowledge and motivation sets. The first canonical correlation is 0.418, suggesting a moderate relationship between the two sets of variables.</span>
<span id="cb65-702"><a href="#cb65-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-703"><a href="#cb65-703" aria-hidden="true" tabindex="-1"></a><span class="fu">### Network Analysis Results</span></span>
<span id="cb65-704"><a href="#cb65-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-705"><a href="#cb65-705" aria-hidden="true" tabindex="-1"></a>The network plot visually represents the correlations between the variables, with node colors indicating whether a variable belongs to the knowledge or motivation set. The plot provides a clear visualization of the relationships between the different constructs.</span>
<span id="cb65-706"><a href="#cb65-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-707"><a href="#cb65-707" aria-hidden="true" tabindex="-1"></a><span class="fu">## Structural Equation Modeling (SEM)</span></span>
<span id="cb65-708"><a href="#cb65-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-711"><a href="#cb65-711" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-712"><a href="#cb65-712" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Structural Equation Model for Path Analysis</span></span>
<span id="cb65-713"><a href="#cb65-713" aria-hidden="true" tabindex="-1"></a><span class="co"># Define model</span></span>
<span id="cb65-714"><a href="#cb65-714" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb65-715"><a href="#cb65-715" aria-hidden="true" tabindex="-1"></a><span class="st">  # Measurement model</span></span>
<span id="cb65-716"><a href="#cb65-716" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge =~ numeracy + energy_use + energy_save +els_score</span></span>
<span id="cb65-717"><a href="#cb65-717" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation =~ env_attitude + perceived_difficulty + pol_conservatism</span></span>
<span id="cb65-718"><a href="#cb65-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-719"><a href="#cb65-719" aria-hidden="true" tabindex="-1"></a><span class="st">  # Structural model</span></span>
<span id="cb65-720"><a href="#cb65-720" aria-hidden="true" tabindex="-1"></a><span class="st">  knowledge ~ motivation</span></span>
<span id="cb65-721"><a href="#cb65-721" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation ~ knowledge</span></span>
<span id="cb65-722"><a href="#cb65-722" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb65-723"><a href="#cb65-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-724"><a href="#cb65-724" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb65-725"><a href="#cb65-725" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">data =</span> combined_scores)</span>
<span id="cb65-726"><a href="#cb65-726" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-727"><a href="#cb65-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-728"><a href="#cb65-728" aria-hidden="true" tabindex="-1"></a>tidySEM<span class="sc">::</span><span class="fu">graph_sem</span>(fit)</span>
<span id="cb65-729"><a href="#cb65-729" aria-hidden="true" tabindex="-1"></a>semPlot<span class="sc">::</span><span class="fu">semPaths</span>(fit,<span class="at">layout=</span><span class="st">"tree2"</span>,<span class="at">residual=</span><span class="cn">TRUE</span>,<span class="at">whatLabels=</span><span class="st">"est"</span>, <span class="at">nCharNodes =</span> <span class="dv">9</span>)</span>
<span id="cb65-730"><a href="#cb65-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-731"><a href="#cb65-731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-732"><a href="#cb65-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-733"><a href="#cb65-733" aria-hidden="true" tabindex="-1"></a>This code fits a structural equation model to test a path model where motivation predicts knowledge.</span>
<span id="cb65-734"><a href="#cb65-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-735"><a href="#cb65-735" aria-hidden="true" tabindex="-1"></a><span class="fu">### SEM Results</span></span>
<span id="cb65-736"><a href="#cb65-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-737"><a href="#cb65-737" aria-hidden="true" tabindex="-1"></a>The SEM results provide support for the hypothesized model, with a good model fit and a significant path from motivation to knowledge. The standardized path coefficient suggests that a one-unit increase in motivation is associated with a 0.577-unit increase in knowledge.</span>
<span id="cb65-738"><a href="#cb65-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-739"><a href="#cb65-739" aria-hidden="true" tabindex="-1"></a><span class="fu">## Classification Tree</span></span>
<span id="cb65-740"><a href="#cb65-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-743"><a href="#cb65-743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-744"><a href="#cb65-744" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Classification Tree for Predicting Knowledge Levels - rpart functions</span></span>
<span id="cb65-745"><a href="#cb65-745" aria-hidden="true" tabindex="-1"></a><span class="co"># Create binary knowledge indicator (high/low) based on median split</span></span>
<span id="cb65-746"><a href="#cb65-746" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>knowledge_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(combined_scores<span class="sc">$</span>composite_knowledge <span class="sc">&gt;</span></span>
<span id="cb65-747"><a href="#cb65-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>(combined_scores<span class="sc">$</span>composite_knowledge, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-748"><a href="#cb65-748" aria-hidden="true" tabindex="-1"></a><span class="st">"High"</span>, <span class="st">"Low"</span></span>
<span id="cb65-749"><a href="#cb65-749" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb65-750"><a href="#cb65-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-751"><a href="#cb65-751" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit tree</span></span>
<span id="cb65-752"><a href="#cb65-752" aria-hidden="true" tabindex="-1"></a>tree_model <span class="ot">&lt;-</span> <span class="fu">rpart</span>(knowledge_level <span class="sc">~</span> env_attitude <span class="sc">+</span> perceived_difficulty <span class="sc">+</span></span>
<span id="cb65-753"><a href="#cb65-753" aria-hidden="true" tabindex="-1"></a>  pol_conservatism, <span class="at">data =</span> combined_scores)</span>
<span id="cb65-754"><a href="#cb65-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-755"><a href="#cb65-755" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot tree</span></span>
<span id="cb65-756"><a href="#cb65-756" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree_model, <span class="at">extra =</span> <span class="dv">1</span>)</span>
<span id="cb65-757"><a href="#cb65-757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-758"><a href="#cb65-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-759"><a href="#cb65-759" aria-hidden="true" tabindex="-1"></a>This code creates a classification tree to predict whether a participant has high or low knowledge based on their environmental attitude, perceived difficulty, and political conservatism.</span>
<span id="cb65-760"><a href="#cb65-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-761"><a href="#cb65-761" aria-hidden="true" tabindex="-1"></a><span class="fu">### Classification Tree Results</span></span>
<span id="cb65-762"><a href="#cb65-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-763"><a href="#cb65-763" aria-hidden="true" tabindex="-1"></a>The classification tree provides a set of rules for classifying participants into high or low knowledge groups based on their scores on the predictor variables. For instance, participants with a <span class="in">`pol_conservatism`</span> score less than 1.8 are classified as 'High' knowledge, while those with <span class="in">`pol_conservatism`</span> greater than 1.8 and <span class="in">`perceived_difficulty`</span> less than 0.56 are classified as 'Low' knowledge.</span>
<span id="cb65-764"><a href="#cb65-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-765"><a href="#cb65-765" aria-hidden="true" tabindex="-1"></a><span class="fu">## Latent Profile Analysis (LPA)</span></span>
<span id="cb65-766"><a href="#cb65-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-769"><a href="#cb65-769" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-770"><a href="#cb65-770" aria-hidden="true" tabindex="-1"></a><span class="co"># Example LPA (using tidyLPA)</span></span>
<span id="cb65-771"><a href="#cb65-771" aria-hidden="true" tabindex="-1"></a>lpa_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-772"><a href="#cb65-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numeracy, energy_use, energy_save, els_score, env_attitude_z, perceived_difficulty) <span class="sc">%&gt;%</span></span>
<span id="cb65-773"><a href="#cb65-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb65-774"><a href="#cb65-774" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert all to numeric</span></span>
<span id="cb65-775"><a href="#cb65-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(as.numeric)</span>
<span id="cb65-776"><a href="#cb65-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-777"><a href="#cb65-777" aria-hidden="true" tabindex="-1"></a>lpa_results <span class="ot">&lt;-</span> lpa_data <span class="sc">%&gt;%</span></span>
<span id="cb65-778"><a href="#cb65-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">estimate_profiles</span>(<span class="at">n_profiles =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="co"># Estimate models with 1-5 profiles</span></span>
<span id="cb65-779"><a href="#cb65-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compare_solutions</span>(<span class="at">statistics =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>))</span>
<span id="cb65-780"><a href="#cb65-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-781"><a href="#cb65-781" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lpa_results)</span>
<span id="cb65-782"><a href="#cb65-782" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-783"><a href="#cb65-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-784"><a href="#cb65-784" aria-hidden="true" tabindex="-1"></a>This code performs a latent profile analysis (LPA) to identify distinct subgroups of participants based on their patterns of responses across the knowledge and motivation variables.</span>
<span id="cb65-785"><a href="#cb65-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-786"><a href="#cb65-786" aria-hidden="true" tabindex="-1"></a><span class="fu">### LPA Results</span></span>
<span id="cb65-787"><a href="#cb65-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-788"><a href="#cb65-788" aria-hidden="true" tabindex="-1"></a>The BIC suggests that a model with 8 profiles fits the data best. The plot shows the BIC values for models with 1 to 5 profiles.</span>
<span id="cb65-789"><a href="#cb65-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-790"><a href="#cb65-790" aria-hidden="true" tabindex="-1"></a><span class="fu">## Factor Analysis with Combined Variables</span></span>
<span id="cb65-791"><a href="#cb65-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-794"><a href="#cb65-794" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-795"><a href="#cb65-795" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all items into a single dataframe</span></span>
<span id="cb65-796"><a href="#cb65-796" aria-hidden="true" tabindex="-1"></a>all_items <span class="ot">&lt;-</span> <span class="fu">full_join</span>(aes_combined, att2_combined, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-797"><a href="#cb65-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(els, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-798"><a href="#cb65-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(rs, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb65-799"><a href="#cb65-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-800"><a href="#cb65-800" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only item columns for factor analysis</span></span>
<span id="cb65-801"><a href="#cb65-801" aria-hidden="true" tabindex="-1"></a>item_columns <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(all_items), <span class="st">"id"</span>)</span>
<span id="cb65-802"><a href="#cb65-802" aria-hidden="true" tabindex="-1"></a>item_data <span class="ot">&lt;-</span> all_items[, item_columns]</span>
<span id="cb65-803"><a href="#cb65-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-804"><a href="#cb65-804" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform factor analysis</span></span>
<span id="cb65-805"><a href="#cb65-805" aria-hidden="true" tabindex="-1"></a>fa_items <span class="ot">&lt;-</span> <span class="fu">fa</span>(item_data, <span class="at">nfactors =</span> <span class="dv">5</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>) <span class="co"># Adjust nfactors as needed</span></span>
<span id="cb65-806"><a href="#cb65-806" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_items, <span class="at">cut =</span> <span class="fl">0.3</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-807"><a href="#cb65-807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-808"><a href="#cb65-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-809"><a href="#cb65-809" aria-hidden="true" tabindex="-1"></a>This performs a factor analysis on all individual survey items to explore the underlying structure of the data.</span>
<span id="cb65-810"><a href="#cb65-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-811"><a href="#cb65-811" aria-hidden="true" tabindex="-1"></a><span class="fu">### Factor Analysis Results</span></span>
<span id="cb65-812"><a href="#cb65-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-813"><a href="#cb65-813" aria-hidden="true" tabindex="-1"></a>The factor analysis suggests a five-factor solution. The items load onto the factors in a way that is generally consistent with the hypothesized constructs, although there are some cross-loadings.</span>
<span id="cb65-814"><a href="#cb65-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-815"><a href="#cb65-815" aria-hidden="true" tabindex="-1"></a><span class="fu">## Knowledge-Motivation Relationship Analyses</span></span>
<span id="cb65-816"><a href="#cb65-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-817"><a href="#cb65-817" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bivariate Correlation</span></span>
<span id="cb65-818"><a href="#cb65-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-821"><a href="#cb65-821" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-822"><a href="#cb65-822" aria-hidden="true" tabindex="-1"></a><span class="co"># Create composite scores for knowledge and motivation</span></span>
<span id="cb65-823"><a href="#cb65-823" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-824"><a href="#cb65-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb65-825"><a href="#cb65-825" aria-hidden="true" tabindex="-1"></a>    <span class="at">knowledge =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., numeracy, energy_use, energy_save, els_score), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-826"><a href="#cb65-826" aria-hidden="true" tabindex="-1"></a>    <span class="at">motivation =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., env_attitude, <span class="sc">-</span>perceived_difficulty, <span class="sc">-</span>pol_conservatism), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-827"><a href="#cb65-827" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-828"><a href="#cb65-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-829"><a href="#cb65-829" aria-hidden="true" tabindex="-1"></a><span class="co"># 3a. Bivariate Correlation</span></span>
<span id="cb65-830"><a href="#cb65-830" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(combined_scores, <span class="fu">cor.test</span>(knowledge, motivation))</span>
<span id="cb65-831"><a href="#cb65-831" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-832"><a href="#cb65-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-833"><a href="#cb65-833" aria-hidden="true" tabindex="-1"></a>This code calculates the bivariate correlation between the composite knowledge and motivation scores.</span>
<span id="cb65-834"><a href="#cb65-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-835"><a href="#cb65-835" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Bivariate Correlation Results</span></span>
<span id="cb65-836"><a href="#cb65-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-837"><a href="#cb65-837" aria-hidden="true" tabindex="-1"></a>The correlation between knowledge and motivation is -0.018, which is not statistically significant (p = 0.7). This suggests a very weak, negative linear relationship between overall knowledge and motivation in this sample.</span>
<span id="cb65-838"><a href="#cb65-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-839"><a href="#cb65-839" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hierarchical Regression</span></span>
<span id="cb65-840"><a href="#cb65-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-843"><a href="#cb65-843" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-844"><a href="#cb65-844" aria-hidden="true" tabindex="-1"></a><span class="co"># 3b. Hierarchical Regression</span></span>
<span id="cb65-845"><a href="#cb65-845" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(knowledge <span class="sc">~</span> motivation <span class="sc">+</span> pol_conservatism_z <span class="sc">+</span> cluster,</span>
<span id="cb65-846"><a href="#cb65-846" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> combined_scores</span>
<span id="cb65-847"><a href="#cb65-847" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-848"><a href="#cb65-848" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb65-849"><a href="#cb65-849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-850"><a href="#cb65-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-851"><a href="#cb65-851" aria-hidden="true" tabindex="-1"></a>This code performs a hierarchical regression analysis to examine the relationship between knowledge and motivation, controlling for political conservatism and cluster membership.</span>
<span id="cb65-852"><a href="#cb65-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-853"><a href="#cb65-853" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hierarchical Regression Results</span></span>
<span id="cb65-854"><a href="#cb65-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-855"><a href="#cb65-855" aria-hidden="true" tabindex="-1"></a>The regression results show that:</span>
<span id="cb65-856"><a href="#cb65-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-857"><a href="#cb65-857" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Motivation is not a significant predictor of knowledge when controlling for political conservatism and cluster membership.</span>
<span id="cb65-858"><a href="#cb65-858" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Political conservatism is not a significant predictor of knowledge.</span>
<span id="cb65-859"><a href="#cb65-859" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Cluster membership is a significant predictor of knowledge, with Clusters 2 and 3 having significantly higher knowledge scores than Cluster 1.</span>
<span id="cb65-860"><a href="#cb65-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-861"><a href="#cb65-861" aria-hidden="true" tabindex="-1"></a><span class="fu">### Path Analysis</span></span>
<span id="cb65-862"><a href="#cb65-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-865"><a href="#cb65-865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-866"><a href="#cb65-866" aria-hidden="true" tabindex="-1"></a><span class="co"># 3c. Path Analysis</span></span>
<span id="cb65-867"><a href="#cb65-867" aria-hidden="true" tabindex="-1"></a>path_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb65-868"><a href="#cb65-868" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation ~ a * knowledge</span></span>
<span id="cb65-869"><a href="#cb65-869" aria-hidden="true" tabindex="-1"></a><span class="st">  els_score ~ b * motivation + c * knowledge</span></span>
<span id="cb65-870"><a href="#cb65-870" aria-hidden="true" tabindex="-1"></a><span class="st">  indirect := a * b</span></span>
<span id="cb65-871"><a href="#cb65-871" aria-hidden="true" tabindex="-1"></a><span class="st">  total := c + indirect</span></span>
<span id="cb65-872"><a href="#cb65-872" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb65-873"><a href="#cb65-873" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(path_model, <span class="at">data =</span> combined_scores)</span>
<span id="cb65-874"><a href="#cb65-874" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-875"><a href="#cb65-875" aria-hidden="true" tabindex="-1"></a>tidySEM<span class="sc">::</span><span class="fu">graph_sem</span>(fit)</span>
<span id="cb65-876"><a href="#cb65-876" aria-hidden="true" tabindex="-1"></a>semPlot<span class="sc">::</span><span class="fu">semPaths</span>(fit)</span>
<span id="cb65-877"><a href="#cb65-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-878"><a href="#cb65-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-879"><a href="#cb65-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-880"><a href="#cb65-880" aria-hidden="true" tabindex="-1"></a>This code fits a path model to test the indirect effect of knowledge on ELS through motivation.</span>
<span id="cb65-881"><a href="#cb65-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-882"><a href="#cb65-882" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Path Analysis Results</span></span>
<span id="cb65-883"><a href="#cb65-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-884"><a href="#cb65-884" aria-hidden="true" tabindex="-1"></a>The path analysis results show that:</span>
<span id="cb65-885"><a href="#cb65-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-886"><a href="#cb65-886" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>The direct effect of knowledge on ELS is significant and positive (c = 0.707).</span>
<span id="cb65-887"><a href="#cb65-887" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>The direct effect of motivation on ELS is not significant (b = 0.036).</span>
<span id="cb65-888"><a href="#cb65-888" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>The indirect effect of knowledge on ELS through motivation is not significant (a<span class="sc">\*</span>b = -0.001).</span>
<span id="cb65-889"><a href="#cb65-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-890"><a href="#cb65-890" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cluster Validation by Motivation-Knowledge Profiles</span></span>
<span id="cb65-891"><a href="#cb65-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-894"><a href="#cb65-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-895"><a href="#cb65-895" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Cluster Validation by Motivation-Knowledge Profiles</span></span>
<span id="cb65-896"><a href="#cb65-896" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_scores, <span class="fu">aes</span>(<span class="at">x =</span> knowledge, <span class="at">y =</span> motivation, <span class="at">color =</span> cluster)) <span class="sc">+</span></span>
<span id="cb65-897"><a href="#cb65-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb65-898"><a href="#cb65-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">level =</span> <span class="fl">0.95</span>) <span class="sc">+</span></span>
<span id="cb65-899"><a href="#cb65-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb65-900"><a href="#cb65-900" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Knowledge-Motivation Profiles by Cluster"</span>,</span>
<span id="cb65-901"><a href="#cb65-901" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Standardized Knowledge Composite"</span>,</span>
<span id="cb65-902"><a href="#cb65-902" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Standardized Motivation Composite"</span></span>
<span id="cb65-903"><a href="#cb65-903" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb65-904"><a href="#cb65-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb65-905"><a href="#cb65-905" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-906"><a href="#cb65-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-907"><a href="#cb65-907" aria-hidden="true" tabindex="-1"></a>This code visualizes the knowledge-motivation profiles for each cluster using a scatter plot with ellipses representing the 95% confidence regions for each cluster.</span>
<span id="cb65-908"><a href="#cb65-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-909"><a href="#cb65-909" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cluster Validation Results</span></span>
<span id="cb65-910"><a href="#cb65-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-911"><a href="#cb65-911" aria-hidden="true" tabindex="-1"></a>The plot shows distinct knowledge-motivation profiles for each cluster:</span>
<span id="cb65-912"><a href="#cb65-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-913"><a href="#cb65-913" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Cluster 1:** Low knowledge, high motivation.</span>
<span id="cb65-914"><a href="#cb65-914" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Cluster 2:** High knowledge, high motivation.</span>
<span id="cb65-915"><a href="#cb65-915" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>**Cluster 3:** Average knowledge, average motivation.</span>
<span id="cb65-916"><a href="#cb65-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-917"><a href="#cb65-917" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation and Factor Analysis of Key Measures</span></span>
<span id="cb65-918"><a href="#cb65-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-921"><a href="#cb65-921" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-922"><a href="#cb65-922" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine key measures into correlation matrix</span></span>
<span id="cb65-923"><a href="#cb65-923" aria-hidden="true" tabindex="-1"></a>key_measures <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-924"><a href="#cb65-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb65-925"><a href="#cb65-925" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Knowledge measures</span></span>
<span id="cb65-926"><a href="#cb65-926" aria-hidden="true" tabindex="-1"></a>    numeracy, energy_use, energy_save, els_score,</span>
<span id="cb65-927"><a href="#cb65-927" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Motivation/attitude measures</span></span>
<span id="cb65-928"><a href="#cb65-928" aria-hidden="true" tabindex="-1"></a>    env_attitude, perceived_difficulty, pol_conservatism</span>
<span id="cb65-929"><a href="#cb65-929" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb65-930"><a href="#cb65-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb65-931"><a href="#cb65-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-932"><a href="#cb65-932" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and visualize correlation matrix</span></span>
<span id="cb65-933"><a href="#cb65-933" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(key_measures, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb65-934"><a href="#cb65-934" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix,</span>
<span id="cb65-935"><a href="#cb65-935" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"color"</span>,</span>
<span id="cb65-936"><a href="#cb65-936" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb65-937"><a href="#cb65-937" aria-hidden="true" tabindex="-1"></a>  <span class="at">addCoef.col =</span> <span class="st">"black"</span>,</span>
<span id="cb65-938"><a href="#cb65-938" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb65-939"><a href="#cb65-939" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb65-940"><a href="#cb65-940" aria-hidden="true" tabindex="-1"></a>  <span class="at">diag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb65-941"><a href="#cb65-941" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span>))(<span class="dv">200</span>)</span>
<span id="cb65-942"><a href="#cb65-942" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-943"><a href="#cb65-943" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-944"><a href="#cb65-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-945"><a href="#cb65-945" aria-hidden="true" tabindex="-1"></a>This code computes and visualizes the correlation matrix for the key knowledge and motivation measures.</span>
<span id="cb65-946"><a href="#cb65-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-947"><a href="#cb65-947" aria-hidden="true" tabindex="-1"></a><span class="fu">### Correlation Matrix Visualization</span></span>
<span id="cb65-948"><a href="#cb65-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-949"><a href="#cb65-949" aria-hidden="true" tabindex="-1"></a>The correlation plot shows the relationships between the key measures, with positive correlations in blue and negative correlations in red. The strength of the correlation is indicated by the intensity of the color and the size of the coefficient.</span>
<span id="cb65-950"><a href="#cb65-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-953"><a href="#cb65-953" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-954"><a href="#cb65-954" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Factor Analysis to examine underlying structure</span></span>
<span id="cb65-955"><a href="#cb65-955" aria-hidden="true" tabindex="-1"></a>fa_results <span class="ot">&lt;-</span> <span class="fu">fa</span>(key_measures, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)</span>
<span id="cb65-956"><a href="#cb65-956" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_results, <span class="at">cut =</span> <span class="fl">0.3</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-957"><a href="#cb65-957" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-958"><a href="#cb65-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-959"><a href="#cb65-959" aria-hidden="true" tabindex="-1"></a>This code performs a factor analysis on the key measures to examine the underlying structure.</span>
<span id="cb65-960"><a href="#cb65-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-961"><a href="#cb65-961" aria-hidden="true" tabindex="-1"></a><span class="fu">### Factor Analysis Results</span></span>
<span id="cb65-962"><a href="#cb65-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-963"><a href="#cb65-963" aria-hidden="true" tabindex="-1"></a>The factor analysis suggests a two-factor solution, with the knowledge measures loading on one factor and the motivation/attitude measures loading on the other factor. The perceived difficulty item loads negatively on the knowledge factor.</span>
<span id="cb65-964"><a href="#cb65-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-965"><a href="#cb65-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-966"><a href="#cb65-966" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb65-967"><a href="#cb65-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-968"><a href="#cb65-968" aria-hidden="true" tabindex="-1"></a><span class="fu">## Composite Scores and Relationships</span></span>
<span id="cb65-969"><a href="#cb65-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-972"><a href="#cb65-972" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-973"><a href="#cb65-973" aria-hidden="true" tabindex="-1"></a><span class="co"># Create composite scores for knowledge and motivation</span></span>
<span id="cb65-974"><a href="#cb65-974" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-975"><a href="#cb65-975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb65-976"><a href="#cb65-976" aria-hidden="true" tabindex="-1"></a>    <span class="at">knowledge_composite =</span> <span class="fu">rowMeans</span>(</span>
<span id="cb65-977"><a href="#cb65-977" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(numeracy, energy_use, energy_save, els_score),</span>
<span id="cb65-978"><a href="#cb65-978" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb65-979"><a href="#cb65-979" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb65-980"><a href="#cb65-980" aria-hidden="true" tabindex="-1"></a>    <span class="at">motivation_composite =</span> <span class="fu">rowMeans</span>(</span>
<span id="cb65-981"><a href="#cb65-981" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(env_attitude, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> perceived_difficulty),</span>
<span id="cb65-982"><a href="#cb65-982" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb65-983"><a href="#cb65-983" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb65-984"><a href="#cb65-984" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-985"><a href="#cb65-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-986"><a href="#cb65-986" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-987"><a href="#cb65-987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(knowledge_composite, motivation_composite) <span class="sc">%&gt;%</span></span>
<span id="cb65-988"><a href="#cb65-988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-989"><a href="#cb65-989" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb65-990"><a href="#cb65-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-991"><a href="#cb65-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-992"><a href="#cb65-992" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the optimal number of clusters using the Elbow Method</span></span>
<span id="cb65-993"><a href="#cb65-993" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>) <span class="sc">+</span></span>
<span id="cb65-994"><a href="#cb65-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-995"><a href="#cb65-995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Elbow Method for Determining Optimal Number of Clusters"</span>)</span>
<span id="cb65-996"><a href="#cb65-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-997"><a href="#cb65-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-998"><a href="#cb65-998" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide the number of clusters (k). Let's try k = 3 for illustration:</span></span>
<span id="cb65-999"><a href="#cb65-999" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb65-1000"><a href="#cb65-1000" aria-hidden="true" tabindex="-1"></a>km_fit <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb65-1001"><a href="#cb65-1001" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize clusters</span></span>
<span id="cb65-1002"><a href="#cb65-1002" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_fit, <span class="at">data =</span> cluster_data) <span class="sc">+</span></span>
<span id="cb65-1003"><a href="#cb65-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clustering on Knowledge vs. Motivation - 3 clusters"</span>) <span class="sc">+</span></span>
<span id="cb65-1004"><a href="#cb65-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb65-1005"><a href="#cb65-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1006"><a href="#cb65-1006" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide the number of clusters (k). Let's try k =4 for illustration:</span></span>
<span id="cb65-1007"><a href="#cb65-1007" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb65-1008"><a href="#cb65-1008" aria-hidden="true" tabindex="-1"></a>km_fit <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data, <span class="at">centers =</span> <span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb65-1009"><a href="#cb65-1009" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize clusters</span></span>
<span id="cb65-1010"><a href="#cb65-1010" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_fit, <span class="at">data =</span> cluster_data) <span class="sc">+</span></span>
<span id="cb65-1011"><a href="#cb65-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clustering on Knowledge vs. Motivation -4 clusters"</span>) <span class="sc">+</span></span>
<span id="cb65-1012"><a href="#cb65-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb65-1013"><a href="#cb65-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1014"><a href="#cb65-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1015"><a href="#cb65-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-1016"><a href="#cb65-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1017"><a href="#cb65-1017" aria-hidden="true" tabindex="-1"></a>This code creates composite scores for knowledge and motivation and then uses cluster analysis to identify distinct profiles based on these composite scores.</span>
<span id="cb65-1018"><a href="#cb65-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1019"><a href="#cb65-1019" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cluster Analysis Results</span></span>
<span id="cb65-1020"><a href="#cb65-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1023"><a href="#cb65-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-1024"><a href="#cb65-1024" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster membership back to your main dataframe</span></span>
<span id="cb65-1025"><a href="#cb65-1025" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>km_cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(km_fit<span class="sc">$</span>cluster)</span>
<span id="cb65-1026"><a href="#cb65-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1027"><a href="#cb65-1027" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare mean knowledge &amp; motivation by cluster</span></span>
<span id="cb65-1028"><a href="#cb65-1028" aria-hidden="true" tabindex="-1"></a>combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-1029"><a href="#cb65-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(km_cluster) <span class="sc">%&gt;%</span></span>
<span id="cb65-1030"><a href="#cb65-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb65-1031"><a href="#cb65-1031" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_knowledge =</span> <span class="fu">mean</span>(knowledge_composite, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-1032"><a href="#cb65-1032" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_motivation =</span> <span class="fu">mean</span>(motivation_composite, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-1033"><a href="#cb65-1033" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb65-1034"><a href="#cb65-1034" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-1035"><a href="#cb65-1035" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-1036"><a href="#cb65-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1037"><a href="#cb65-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1038"><a href="#cb65-1038" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cluster Profiles</span></span>
<span id="cb65-1039"><a href="#cb65-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1042"><a href="#cb65-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-1043"><a href="#cb65-1043" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster membership to dataframe</span></span>
<span id="cb65-1044"><a href="#cb65-1044" aria-hidden="true" tabindex="-1"></a>combined_scores<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(km_fit<span class="sc">$</span>cluster)</span>
<span id="cb65-1045"><a href="#cb65-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1046"><a href="#cb65-1046" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize cluster profiles</span></span>
<span id="cb65-1047"><a href="#cb65-1047" aria-hidden="true" tabindex="-1"></a>cluster_profiles <span class="ot">&lt;-</span> combined_scores <span class="sc">%&gt;%</span></span>
<span id="cb65-1048"><a href="#cb65-1048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb65-1049"><a href="#cb65-1049" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb65-1050"><a href="#cb65-1050" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb65-1051"><a href="#cb65-1051" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_knowledge =</span> <span class="fu">mean</span>(knowledge_composite, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb65-1052"><a href="#cb65-1052" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_knowledge =</span> <span class="fu">sd</span>(knowledge_composite, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb65-1053"><a href="#cb65-1053" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_motivation =</span> <span class="fu">mean</span>(motivation_composite, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb65-1054"><a href="#cb65-1054" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_motivation =</span> <span class="fu">sd</span>(motivation_composite, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb65-1055"><a href="#cb65-1055" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-1056"><a href="#cb65-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1057"><a href="#cb65-1057" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cluster_profiles)</span>
<span id="cb65-1058"><a href="#cb65-1058" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-1059"><a href="#cb65-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1060"><a href="#cb65-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1061"><a href="#cb65-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1062"><a href="#cb65-1062" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb65-1063"><a href="#cb65-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1064"><a href="#cb65-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1065"><a href="#cb65-1065" aria-hidden="true" tabindex="-1"></a><span class="fu"># Clustering on question-level data</span></span>
<span id="cb65-1066"><a href="#cb65-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1069"><a href="#cb65-1069" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-1070"><a href="#cb65-1070" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb65-1071"><a href="#cb65-1071" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb65-1072"><a href="#cb65-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1073"><a href="#cb65-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1074"><a href="#cb65-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1075"><a href="#cb65-1075" aria-hidden="true" tabindex="-1"></a><span class="co"># combine question level data (aes_combined, att2_combined, els, rs,) by id</span></span>
<span id="cb65-1076"><a href="#cb65-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1077"><a href="#cb65-1077" aria-hidden="true" tabindex="-1"></a>dq <span class="ot">&lt;-</span> aes_combined <span class="sc">|&gt;</span> <span class="fu">left_join</span>(att2_combined, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> <span class="fu">left_join</span>(els, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> <span class="fu">left_join</span>(rs, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb65-1078"><a href="#cb65-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1079"><a href="#cb65-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1080"><a href="#cb65-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1081"><a href="#cb65-1081" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom function for correlation matrix plots of question-level data</span></span>
<span id="cb65-1082"><a href="#cb65-1082" aria-hidden="true" tabindex="-1"></a>plot_cor_matrix_items <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">title =</span> <span class="cn">NULL</span>) {</span>
<span id="cb65-1083"><a href="#cb65-1083" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb65-1084"><a href="#cb65-1084" aria-hidden="true" tabindex="-1"></a>  cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb65-1085"><a href="#cb65-1085" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-1086"><a href="#cb65-1086" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify item types based on column names</span></span>
<span id="cb65-1087"><a href="#cb65-1087" aria-hidden="true" tabindex="-1"></a>  item_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(cor_matrix)</span>
<span id="cb65-1088"><a href="#cb65-1088" aria-hidden="true" tabindex="-1"></a>  is_attari_diff <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"^ATT0[1-9]$|^ATT1[0-5]$"</span>, item_names) <span class="co"># ATT01-ATT15</span></span>
<span id="cb65-1089"><a href="#cb65-1089" aria-hidden="true" tabindex="-1"></a>  is_attari_num <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"^ATT1[6-8]$"</span>, item_names)  <span class="co"># ATT16-ATT18</span></span>
<span id="cb65-1090"><a href="#cb65-1090" aria-hidden="true" tabindex="-1"></a>  is_attari_energy_use <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"^ATT(19|2[0-7])$"</span>, item_names) <span class="co"># ATT19-ATT27</span></span>
<span id="cb65-1091"><a href="#cb65-1091" aria-hidden="true" tabindex="-1"></a>  is_attari_energy_save <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"^ATT(2[8-9]|3[0-3])$"</span>, item_names)  <span class="co"># ATT28-ATT33</span></span>
<span id="cb65-1092"><a href="#cb65-1092" aria-hidden="true" tabindex="-1"></a>  is_els <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"^ELS0[1-8]$"</span>, item_names) <span class="co"># ELS01-ELS08</span></span>
<span id="cb65-1093"><a href="#cb65-1093" aria-hidden="true" tabindex="-1"></a>  is_rs <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"^RS0[1-6]$"</span>, item_names) <span class="co"># RS01-RS06</span></span>
<span id="cb65-1094"><a href="#cb65-1094" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-1095"><a href="#cb65-1095" aria-hidden="true" tabindex="-1"></a>  item_groups <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(is_attari_diff, <span class="st">"Attari Difficulty"</span>,</span>
<span id="cb65-1096"><a href="#cb65-1096" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">ifelse</span>(is_attari_num, <span class="st">"Attari Numeracy"</span>,</span>
<span id="cb65-1097"><a href="#cb65-1097" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ifelse</span>(is_attari_energy_use, <span class="st">"Attari Usage"</span>,</span>
<span id="cb65-1098"><a href="#cb65-1098" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">ifelse</span>(is_attari_energy_save, <span class="st">"Attari Savings"</span>,</span>
<span id="cb65-1099"><a href="#cb65-1099" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">ifelse</span>(is_els, <span class="st">"Energy Literacy"</span>,</span>
<span id="cb65-1100"><a href="#cb65-1100" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">ifelse</span>(is_rs, <span class="st">"Recycling Study"</span>, <span class="cn">NA</span>))))))</span>
<span id="cb65-1101"><a href="#cb65-1101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-1102"><a href="#cb65-1102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qgraph</span>(cor_matrix,</span>
<span id="cb65-1103"><a href="#cb65-1103" aria-hidden="true" tabindex="-1"></a>         <span class="at">layout =</span> <span class="st">"spring"</span>,</span>
<span id="cb65-1104"><a href="#cb65-1104" aria-hidden="true" tabindex="-1"></a>         <span class="at">groups =</span> <span class="fu">list</span>(<span class="st">"Attari Difficulty"</span> <span class="ot">=</span> <span class="fu">which</span>(item_groups <span class="sc">==</span> <span class="st">"Attari Difficulty"</span>),</span>
<span id="cb65-1105"><a href="#cb65-1105" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Attari Numeracy"</span> <span class="ot">=</span> <span class="fu">which</span>(item_groups <span class="sc">==</span> <span class="st">"Attari Numeracy"</span>),</span>
<span id="cb65-1106"><a href="#cb65-1106" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Attari Usage"</span> <span class="ot">=</span> <span class="fu">which</span>(item_groups <span class="sc">==</span> <span class="st">"Attari Usage"</span>),</span>
<span id="cb65-1107"><a href="#cb65-1107" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Attari Savings"</span> <span class="ot">=</span> <span class="fu">which</span>(item_groups <span class="sc">==</span> <span class="st">"Attari Savings"</span>),</span>
<span id="cb65-1108"><a href="#cb65-1108" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Energy Literacy"</span> <span class="ot">=</span> <span class="fu">which</span>(item_groups <span class="sc">==</span> <span class="st">"Energy Literacy"</span>),</span>
<span id="cb65-1109"><a href="#cb65-1109" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Recycling Study"</span> <span class="ot">=</span> <span class="fu">which</span>(item_groups <span class="sc">==</span> <span class="st">"Recycling Study"</span>)),</span>
<span id="cb65-1110"><a href="#cb65-1110" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"skyblue"</span>, <span class="fu">sum</span>(is_attari_diff)),</span>
<span id="cb65-1111"><a href="#cb65-1111" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">rep</span>(<span class="st">"lightcoral"</span>, <span class="fu">sum</span>(is_attari_num)),</span>
<span id="cb65-1112"><a href="#cb65-1112" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">rep</span>(<span class="st">"lightgreen"</span>, <span class="fu">sum</span>(is_attari_energy_use)),</span>
<span id="cb65-1113"><a href="#cb65-1113" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">rep</span>(<span class="st">"lightyellow"</span>, <span class="fu">sum</span>(is_attari_energy_save)),</span>
<span id="cb65-1114"><a href="#cb65-1114" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">rep</span>(<span class="st">"lightpink"</span>, <span class="fu">sum</span>(is_els)),</span>
<span id="cb65-1115"><a href="#cb65-1115" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="st">"lightcyan"</span>, <span class="fu">sum</span>(is_rs))),</span>
<span id="cb65-1116"><a href="#cb65-1116" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> title)</span>
<span id="cb65-1117"><a href="#cb65-1117" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-1118"><a href="#cb65-1118" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-1119"><a href="#cb65-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1120"><a href="#cb65-1120" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cor_matrix_items</span>(dq <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id))</span>
<span id="cb65-1121"><a href="#cb65-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1122"><a href="#cb65-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1123"><a href="#cb65-1123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-1124"><a href="#cb65-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1127"><a href="#cb65-1127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-1128"><a href="#cb65-1128" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-1129"><a href="#cb65-1129" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb65-1130"><a href="#cb65-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1131"><a href="#cb65-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1132"><a href="#cb65-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1133"><a href="#cb65-1133" aria-hidden="true" tabindex="-1"></a>r<span class="sc">$</span><span class="er">&gt;</span> <span class="fu">colnames</span>(dq)</span>
<span id="cb65-1134"><a href="#cb65-1134" aria-hidden="true" tabindex="-1"></a><span class="co">#  [1] "id"    "ATT01" "ATT02" "ATT03" "ATT04" "ATT05" "ATT06" "ATT07" "ATT08" "ATT09" "ATT10" "ATT11" "ATT12" "ATT13" "ATT14" "ATT15" "ATT16" "ATT17" "ATT18" "ATT19" "ATT20"</span></span>
<span id="cb65-1135"><a href="#cb65-1135" aria-hidden="true" tabindex="-1"></a><span class="co"># [22] "ATT21" "ATT22" "ATT23" "ATT24" "ATT25" "ATT26" "ATT27" "ATT28" "ATT29" "ATT30" "ATT31" "ATT32" "ATT33" "ELS01" "ELS02" "ELS03" "ELS04" "ELS05" "ELS06" "ELS07" "ELS08"</span></span>
<span id="cb65-1136"><a href="#cb65-1136" aria-hidden="true" tabindex="-1"></a><span class="co"># [43] "RS01"  "RS02"  "RS03"  "RS04"  "RS05"  "RS06" </span></span>
<span id="cb65-1137"><a href="#cb65-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1138"><a href="#cb65-1138" aria-hidden="true" tabindex="-1"></a><span class="co"># sem model from dq</span></span>
<span id="cb65-1139"><a href="#cb65-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1140"><a href="#cb65-1140" aria-hidden="true" tabindex="-1"></a>sem_model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb65-1141"><a href="#cb65-1141" aria-hidden="true" tabindex="-1"></a><span class="st">  Knowledge =~ ATT16 + ATT17 + ATT18 + ATT19 + ATT20 + ATT21 + ATT22 + ATT23 + ATT24 + ATT25 + ATT26 + ATT27 + ATT28 + ATT29 + ATT30 + ATT31 + ATT32 + ATT33 + ELS01 + ELS02 + ELS03 + ELS04 + ELS05 + ELS06 + ELS07 + ELS08</span></span>
<span id="cb65-1142"><a href="#cb65-1142" aria-hidden="true" tabindex="-1"></a><span class="st">  Motivation =~ ATT01 + ATT02 + ATT03 + ATT04 + ATT05 + ATT06 + ATT07 + ATT08 + ATT09 + ATT10 + ATT11 + ATT12 + ATT13 + ATT14 + ATT15 + RS01 + RS02 + RS03 + RS04 + RS05 + RS06</span></span>
<span id="cb65-1143"><a href="#cb65-1143" aria-hidden="true" tabindex="-1"></a><span class="st">  Knowledge ~ Motivation</span></span>
<span id="cb65-1144"><a href="#cb65-1144" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb65-1145"><a href="#cb65-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1146"><a href="#cb65-1146" aria-hidden="true" tabindex="-1"></a>sem_q <span class="ot">&lt;-</span> <span class="fu">sem</span>(sem_model, <span class="at">data =</span> dq, <span class="at">missing =</span> <span class="st">"fiml"</span>)  <span class="co"># handle missing if needed</span></span>
<span id="cb65-1147"><a href="#cb65-1147" aria-hidden="true" tabindex="-1"></a>tidySEM<span class="sc">::</span><span class="fu">graph_sem</span>(sem_q)</span>
<span id="cb65-1148"><a href="#cb65-1148" aria-hidden="true" tabindex="-1"></a>semPlot<span class="sc">::</span><span class="fu">semPaths</span>(sem_q,<span class="at">layout=</span><span class="st">"tree2"</span>,<span class="at">residual=</span><span class="cn">TRUE</span>,<span class="at">whatLabels=</span><span class="st">"est"</span>, <span class="at">nCharNodes =</span> <span class="dv">12</span>)</span>
<span id="cb65-1149"><a href="#cb65-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1150"><a href="#cb65-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1151"><a href="#cb65-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1152"><a href="#cb65-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1153"><a href="#cb65-1153" aria-hidden="true" tabindex="-1"></a><span class="co"># pca on dq</span></span>
<span id="cb65-1154"><a href="#cb65-1154" aria-hidden="true" tabindex="-1"></a><span class="co"># cluster_data &lt;- dq %&gt;% # get mean of each column (exlude na)</span></span>
<span id="cb65-1155"><a href="#cb65-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-id) %&gt;%</span></span>
<span id="cb65-1156"><a href="#cb65-1156" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(across(everything(), mean, na.rm = TRUE)) %&gt;%</span></span>
<span id="cb65-1157"><a href="#cb65-1157" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale()</span></span>
<span id="cb65-1158"><a href="#cb65-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1159"><a href="#cb65-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1160"><a href="#cb65-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1161"><a href="#cb65-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1162"><a href="#cb65-1162" aria-hidden="true" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(cluster_data)</span>
<span id="cb65-1163"><a href="#cb65-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1164"><a href="#cb65-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1165"><a href="#cb65-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1166"><a href="#cb65-1166" aria-hidden="true" tabindex="-1"></a>ate cluster visualization</span>
<span id="cb65-1167"><a href="#cb65-1167" aria-hidden="true" tabindex="-1"></a>p_clusters <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cluster_df, <span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2)) <span class="sc">+</span></span>
<span id="cb65-1168"><a href="#cb65-1168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(dq<span class="sc">$</span>km_cluster)), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb65-1169"><a href="#cb65-1169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-1170"><a href="#cb65-1170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb65-1171"><a href="#cb65-1171" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Knowledge-Motivation Clusters"</span>,</span>
<span id="cb65-1172"><a href="#cb65-1172" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"First Principal Component"</span>,</span>
<span id="cb65-1173"><a href="#cb65-1173" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Second Principal Component"</span></span>
<span id="cb65-1174"><a href="#cb65-1174" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-1175"><a href="#cb65-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1176"><a href="#cb65-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1177"><a href="#cb65-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1178"><a href="#cb65-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1179"><a href="#cb65-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1180"><a href="#cb65-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1181"><a href="#cb65-1181" aria-hidden="true" tabindex="-1"></a>plot_item_correlation_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(data, knowledge_items, motivation_items, <span class="at">title =</span> <span class="st">"Item-Level Correlation Matrix"</span>) {</span>
<span id="cb65-1182"><a href="#cb65-1182" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine knowledge and motivation items</span></span>
<span id="cb65-1183"><a href="#cb65-1183" aria-hidden="true" tabindex="-1"></a>  all_items <span class="ot">&lt;-</span> <span class="fu">c</span>(knowledge_items, motivation_items)</span>
<span id="cb65-1184"><a href="#cb65-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1185"><a href="#cb65-1185" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a named vector for item types</span></span>
<span id="cb65-1186"><a href="#cb65-1186" aria-hidden="true" tabindex="-1"></a>  item_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Knowledge"</span>, <span class="fu">length</span>(knowledge_items)), <span class="fu">rep</span>(<span class="st">"Motivation"</span>, <span class="fu">length</span>(motivation_items)))</span>
<span id="cb65-1187"><a href="#cb65-1187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(item_types) <span class="ot">&lt;-</span> all_items</span>
<span id="cb65-1188"><a href="#cb65-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1189"><a href="#cb65-1189" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select items and compute correlation matrix</span></span>
<span id="cb65-1190"><a href="#cb65-1190" aria-hidden="true" tabindex="-1"></a>  cor_matrix <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb65-1191"><a href="#cb65-1191" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">all_of</span>(all_items)) <span class="sc">%&gt;%</span></span>
<span id="cb65-1192"><a href="#cb65-1192" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(as.numeric) <span class="sc">%&gt;%</span> <span class="co"># Convert all columns to numeric</span></span>
<span id="cb65-1193"><a href="#cb65-1193" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb65-1194"><a href="#cb65-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1195"><a href="#cb65-1195" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a color palette</span></span>
<span id="cb65-1196"><a href="#cb65-1196" aria-hidden="true" tabindex="-1"></a>  col <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#BB4444"</span>, <span class="st">"#EE9988"</span>, <span class="st">"#FFFFFF"</span>, <span class="st">"#77AADD"</span>, <span class="st">"#4477AA"</span>))</span>
<span id="cb65-1197"><a href="#cb65-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1198"><a href="#cb65-1198" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a vector of colors for the item labels based on type</span></span>
<span id="cb65-1199"><a href="#cb65-1199" aria-hidden="true" tabindex="-1"></a>  label_colors <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(item_types[<span class="fu">rownames</span>(cor_matrix)] <span class="sc">==</span> <span class="st">"Knowledge"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>)</span>
<span id="cb65-1200"><a href="#cb65-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1201"><a href="#cb65-1201" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate the correlation plot</span></span>
<span id="cb65-1202"><a href="#cb65-1202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>(cor_matrix,</span>
<span id="cb65-1203"><a href="#cb65-1203" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"color"</span>,</span>
<span id="cb65-1204"><a href="#cb65-1204" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb65-1205"><a href="#cb65-1205" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="st">"original"</span>, <span class="co"># Keep original variable order</span></span>
<span id="cb65-1206"><a href="#cb65-1206" aria-hidden="true" tabindex="-1"></a>    <span class="at">addCoef.col =</span> <span class="st">"black"</span>,</span>
<span id="cb65-1207"><a href="#cb65-1207" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.col =</span> label_colors, <span class="co"># Apply colors to labels based on the 'groups'</span></span>
<span id="cb65-1208"><a href="#cb65-1208" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb65-1209"><a href="#cb65-1209" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.cex =</span> <span class="fl">0.7</span>,</span>
<span id="cb65-1210"><a href="#cb65-1210" aria-hidden="true" tabindex="-1"></a>    <span class="at">diag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb65-1211"><a href="#cb65-1211" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">col</span>(<span class="dv">200</span>),</span>
<span id="cb65-1212"><a href="#cb65-1212" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> title,</span>
<span id="cb65-1213"><a href="#cb65-1213" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>) <span class="co"># Adjust margin for title</span></span>
<span id="cb65-1214"><a href="#cb65-1214" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-1215"><a href="#cb65-1215" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-1216"><a href="#cb65-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1217"><a href="#cb65-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1218"><a href="#cb65-1218" aria-hidden="true" tabindex="-1"></a><span class="co"># Define knowledge and motivation items based on your survey structure</span></span>
<span id="cb65-1219"><a href="#cb65-1219" aria-hidden="true" tabindex="-1"></a>knowledge_items <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb65-1220"><a href="#cb65-1220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"ATT"</span>, <span class="dv">16</span><span class="sc">:</span><span class="dv">18</span>), <span class="co"># Numeracy</span></span>
<span id="cb65-1221"><a href="#cb65-1221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"ATT"</span>, <span class="dv">19</span><span class="sc">:</span><span class="dv">33</span>), <span class="co"># Relative Energy Usage and Savings</span></span>
<span id="cb65-1222"><a href="#cb65-1222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"ELS0"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) <span class="co"># Energy Literacy</span></span>
<span id="cb65-1223"><a href="#cb65-1223" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-1224"><a href="#cb65-1224" aria-hidden="true" tabindex="-1"></a>motivation_items <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb65-1225"><a href="#cb65-1225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"ATT0"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>), <span class="co"># Perceived Difficulty</span></span>
<span id="cb65-1226"><a href="#cb65-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"ATT"</span>, <span class="dv">10</span><span class="sc">:</span><span class="dv">15</span>), <span class="co"># Perceived Difficulty</span></span>
<span id="cb65-1227"><a href="#cb65-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"RS0"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="co"># Recycling Study (Attitudes/Motivation)</span></span>
<span id="cb65-1228"><a href="#cb65-1228" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-1229"><a href="#cb65-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1230"><a href="#cb65-1230" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_item_correlation_matrix</span>(dq <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id), knowledge_items, motivation_items, <span class="at">title =</span> <span class="st">"Item-Level Correlation Matrix: Knowledge vs. Motivation"</span>)</span>
<span id="cb65-1231"><a href="#cb65-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1232"><a href="#cb65-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1233"><a href="#cb65-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1234"><a href="#cb65-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1235"><a href="#cb65-1235" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> dq <span class="sc">%&gt;%</span></span>
<span id="cb65-1236"><a href="#cb65-1236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb65-1237"><a href="#cb65-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-1238"><a href="#cb65-1238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb65-1239"><a href="#cb65-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1240"><a href="#cb65-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1241"><a href="#cb65-1241" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the optimal number of clusters using the Elbow Method</span></span>
<span id="cb65-1242"><a href="#cb65-1242" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(cluster_data, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>) <span class="sc">+</span></span>
<span id="cb65-1243"><a href="#cb65-1243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-1244"><a href="#cb65-1244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Elbow Method for Determining Optimal Number of Clusters"</span>)</span>
<span id="cb65-1245"><a href="#cb65-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1246"><a href="#cb65-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1247"><a href="#cb65-1247" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide the number of clusters (k). Let's try k = 3 for illustration:</span></span>
<span id="cb65-1248"><a href="#cb65-1248" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb65-1249"><a href="#cb65-1249" aria-hidden="true" tabindex="-1"></a>km_fit <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data, <span class="at">centers =</span> <span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb65-1250"><a href="#cb65-1250" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize clusters</span></span>
<span id="cb65-1251"><a href="#cb65-1251" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km_fit, <span class="at">data =</span> cluster_data) <span class="sc">+</span></span>
<span id="cb65-1252"><a href="#cb65-1252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clustering on Knowledge vs. Motivation - 3 clusters"</span>) <span class="sc">+</span></span>
<span id="cb65-1253"><a href="#cb65-1253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb65-1254"><a href="#cb65-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1255"><a href="#cb65-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1256"><a href="#cb65-1256" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster membership back to your main dataframe</span></span>
<span id="cb65-1257"><a href="#cb65-1257" aria-hidden="true" tabindex="-1"></a>dq<span class="sc">$</span>km_cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(km_fit<span class="sc">$</span>cluster)</span>
<span id="cb65-1258"><a href="#cb65-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1259"><a href="#cb65-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1260"><a href="#cb65-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1261"><a href="#cb65-1261" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dq)</span>
<span id="cb65-1262"><a href="#cb65-1262" aria-hidden="true" tabindex="-1"></a><span class="co">#  [1] "id"         "ATT01"      "ATT02"      "ATT03"      "ATT04"      "ATT05"      "ATT06"      "ATT07"      "ATT08"      "ATT09"      "ATT10"      "ATT11"      "ATT12"     </span></span>
<span id="cb65-1263"><a href="#cb65-1263" aria-hidden="true" tabindex="-1"></a><span class="co"># [14] "ATT13"      "ATT14"      "ATT15"      "ATT16"      "ATT17"      "ATT18"      "ATT19"      "ATT20"      "ATT21"      "ATT22"      "ATT23"      "ATT24"      "ATT25"     </span></span>
<span id="cb65-1264"><a href="#cb65-1264" aria-hidden="true" tabindex="-1"></a><span class="co"># [27] "ATT26"      "ATT27"      "ATT28"      "ATT29"      "ATT30"      "ATT31"      "ATT32"      "ATT33"      "ELS01"      "ELS02"      "ELS03"      "ELS04"      "ELS05"     </span></span>
<span id="cb65-1265"><a href="#cb65-1265" aria-hidden="true" tabindex="-1"></a><span class="co"># [40] "ELS06"      "ELS07"      "ELS08"      "RS01"       "RS02"       "RS03"       "RS04"       "RS05"       "RS06"       "km_cluster"</span></span>
<span id="cb65-1266"><a href="#cb65-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1267"><a href="#cb65-1267" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate and summarize the data - assess how clusters relate to knowledge vs. motivation items</span></span>
<span id="cb65-1268"><a href="#cb65-1268" aria-hidden="true" tabindex="-1"></a>dq <span class="sc">|&gt;</span> </span>
<span id="cb65-1269"><a href="#cb65-1269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(km_cluster) <span class="sc">|&gt;</span> </span>
<span id="cb65-1270"><a href="#cb65-1270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb65-1271"><a href="#cb65-1271" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb65-1272"><a href="#cb65-1272" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(ATT01<span class="sc">:</span>ATT15, <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"mean_{.col}"</span>),</span>
<span id="cb65-1273"><a href="#cb65-1273" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(ATT16<span class="sc">:</span>ATT33, <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"mean_{.col}"</span>),</span>
<span id="cb65-1274"><a href="#cb65-1274" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(ELS01<span class="sc">:</span>ELS08, <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"mean_{.col}"</span>),</span>
<span id="cb65-1275"><a href="#cb65-1275" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(RS01<span class="sc">:</span>RS06,   <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"mean_{.col}"</span>)</span>
<span id="cb65-1276"><a href="#cb65-1276" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb65-1277"><a href="#cb65-1277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb65-1278"><a href="#cb65-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1279"><a href="#cb65-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1280"><a href="#cb65-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1281"><a href="#cb65-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-1282"><a href="#cb65-1282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025 <a href="https://tegorman13.github.io">Thomas Gorman</a></p>
</div>   
    <div class="nav-footer-center">
<p>site made with <a href="https://cran.r-project.org/"><i class="fa-brands fa-r-project" aria-label="r-project"></i></a> and <a href="https://quarto.org/">Quarto</a></p>
<div class="toc-actions"><ul><li><a href="https://github.com/tegorman13/Survey_Study/blob/main/cors.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://github.com/tegorman13/Survey_Study" target="_blank">
<p><i class="fa-brands fa-github fa-2.0x" aria-label="github"></i></p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>